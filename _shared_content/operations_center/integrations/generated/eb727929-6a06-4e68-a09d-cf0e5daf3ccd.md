
## Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Email gateway` | Postfix logs many details on every handled message |
| `Mail server` | Postfix logs many details on every handled message |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `` |
| Category | `email` |
| Type | `info` |




## Event Samples

Find below few samples of events and how they are normalized by Sekoia.io.


=== "anvil.json"

    ```json
	
    {
        "message": "statistics: max connection count 10 for (smtp:1.2.3.4) at Sep 11 10:47:30",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "log": {
            "syslog": {
                "appname": "postfix/anvil"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        }
    }
    	
	```


=== "appname_postfix_error.json"

    ```json
	
    {
        "message": "2298F5F619: to=<admin@corp.com>, relay=none, delay=89758, delays=89758/0.02/0/0, dsn=4.4.1, status=deferred (delivery temporarily suspended: connect to mail.corp.com[1.1.1.1]:25: Connection timed out) 215",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "deferred",
            "outcome": "success",
            "target": "network-traffic"
        },
        "destination": {
            "address": "corp.com",
            "domain": "corp.com",
            "registered_domain": "corp.com",
            "top_level_domain": "com"
        },
        "email": {
            "to": {
                "address": [
                    "admin@corp.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postfix/error"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "corp.com"
            ]
        }
    }
    	
	```


=== "appname_postfix_local.json"

    ```json
	
    {
        "message": "11FDF5F62A: to=<USER@sub.corp.com>, relay=local, delay=80181, delays=80181/0.02/0/0, dsn=4.0.0, status=deferred (user lookup error)",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "deferred",
            "outcome": "success",
            "target": "network-traffic"
        },
        "destination": {
            "address": "sub.corp.com",
            "domain": "sub.corp.com",
            "registered_domain": "corp.com",
            "subdomain": "sub",
            "top_level_domain": "com"
        },
        "email": {
            "to": {
                "address": [
                    "USER@sub.corp.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postfix/local"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "sub.corp.com"
            ]
        }
    }
    	
	```


=== "bounced.json"

    ```json
	
    {
        "message": "3D770111AF50: to=<username@corp.com>, relay=none, delay=1.2, delays=1.1/0/0.03/0, dsn=5.4.4, status=bounced (Host or domain name not found. Name service error for name=corp.com type=AAAA: Host not found)",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "bounced",
            "outcome": "success",
            "target": "network-traffic"
        },
        "destination": {
            "address": "corp.com",
            "domain": "corp.com",
            "registered_domain": "corp.com",
            "top_level_domain": "com"
        },
        "email": {
            "to": {
                "address": [
                    "username@corp.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtp"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "corp.com"
            ]
        }
    }
    	
	```


=== "cleanup.json"

    ```json
	
    {
        "message": "77EFFC0015: warning: header Content-Disposition: inline; filename=\"image003.jpg\"; size=26055;??creation-date=\"Thu, 12 Sep 2019 12:39:01 GMT\";??modification-date=\"Thu, 12 Sep 2019 12:40:01 GMT\" from mail.outbound.protection.outlook.com[1.1.1.1]; from=<> to=<john.doe@exemple.com> proto=ESMTP helo=<NAM03.outbound.protection.outlook.com>",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "destination": {
            "address": "exemple.com",
            "domain": "exemple.com",
            "registered_domain": "exemple.com",
            "top_level_domain": "com"
        },
        "email": {
            "to": {
                "address": [
                    "john.doe@exemple.com"
                ]
            }
        },
        "file": {
            "created": "2019-09-12T12:39:01Z",
            "ctime": "2019-09-12T12:40:01Z",
            "name": "image003.jpg",
            "size": 26055
        },
        "log": {
            "syslog": {
                "appname": "postfix/cleanup"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "exemple.com",
                "mail.outbound.protection.outlook.com"
            ],
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "mail.outbound.protection.outlook.com",
            "domain": "mail.outbound.protection.outlook.com",
            "ip": "1.1.1.1",
            "registered_domain": "outlook.com",
            "subdomain": "mail.outbound.protection",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "cleanup2.json"

    ```json
	
    {
        "message": "3D770111AF50: warning: header Subject: Manquants LASTNAME GB Nouvelle version from unknown[10.1.1.1]; from=<foo@corp.com> to=<first.last@corp.com> proto=ESMTP helo=<SUBDOMAIN.CORP.COM>",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "destination": {
            "address": "corp.com",
            "domain": "corp.com",
            "registered_domain": "corp.com",
            "top_level_domain": "com"
        },
        "email": {
            "from": {
                "address": [
                    "foo@corp.com"
                ]
            },
            "to": {
                "address": [
                    "first.last@corp.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postfix/cleanup"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "corp.com"
            ],
            "ip": [
                "10.1.1.1"
            ]
        },
        "source": {
            "address": "corp.com",
            "domain": "corp.com",
            "ip": "10.1.1.1",
            "registered_domain": "corp.com",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "cleanup3.json"

    ```json
	
    {
        "message": "2CE6C111AF50: warning: header Subject: =?ISO-8859-1?Q?Pb_FTP_=3A_999_Aucune_action_effectu=E9e?= from unknown[10.1.1.1]; from=<email@corp.com> to=<email@corp.com> proto=ESMTP helo=<SUBDOMAIN.CORP.COM> 279",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "destination": {
            "address": "corp.com",
            "domain": "corp.com",
            "registered_domain": "corp.com",
            "top_level_domain": "com"
        },
        "email": {
            "from": {
                "address": [
                    "email@corp.com"
                ]
            },
            "to": {
                "address": [
                    "email@corp.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postfix/cleanup"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "corp.com"
            ],
            "ip": [
                "10.1.1.1"
            ]
        },
        "source": {
            "address": "corp.com",
            "domain": "corp.com",
            "ip": "10.1.1.1",
            "registered_domain": "corp.com",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "cleanup4.json"

    ```json
	
    {
        "message": "B4B613F8B7: warning: header Content-Disposition: inline; filename=\"image001.png\"; size=8879;??creation-date=\"Thu, 14 Mar 2024 10:19:00 GMT\";??modification-date=\"Thu, 14 Mar 2024 10:19:00 GMT\" from subdomain.key.corp.com[1.1.1.1]; from=<ndr.journaling@corp.com> to=<corp@office365.eu.vadesecure.com> proto=ESMTP helo=<subdomain.key.corp.com>",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "destination": {
            "address": "office365.eu.vadesecure.com",
            "domain": "office365.eu.vadesecure.com",
            "registered_domain": "vadesecure.com",
            "subdomain": "office365.eu",
            "top_level_domain": "com"
        },
        "email": {
            "from": {
                "address": [
                    "ndr.journaling@corp.com"
                ]
            },
            "to": {
                "address": [
                    "corp@office365.eu.vadesecure.com"
                ]
            }
        },
        "file": {
            "created": "2024-03-14T10:19:00Z",
            "ctime": "2024-03-14T10:19:00Z",
            "name": "image001.png",
            "size": 8879
        },
        "log": {
            "syslog": {
                "appname": "postfix/cleanup"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "office365.eu.vadesecure.com",
                "subdomain.key.corp.com"
            ],
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "subdomain.key.corp.com",
            "domain": "subdomain.key.corp.com",
            "ip": "1.1.1.1",
            "registered_domain": "corp.com",
            "subdomain": "subdomain.key",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "cleanup5.json"

    ```json
	
    {
        "message": "707A12000A: warning: header Content-Disposition: attachment;??filename=\"?iso-8859-2?q?representative_on_migration.pdf?=\"; size=259210;?? from local; from=<photo@mordor.com> to=<Pipin.touque@lacomte.net>",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "destination": {
            "address": "lacomte.net",
            "domain": "lacomte.net",
            "registered_domain": "lacomte.net",
            "top_level_domain": "net"
        },
        "email": {
            "from": {
                "address": [
                    "photo@mordor.com"
                ]
            },
            "to": {
                "address": [
                    "Pipin.touque@lacomte.net"
                ]
            }
        },
        "file": {
            "name": "?iso-8859-2?q?representative_on_migration.pdf?=",
            "size": 259210
        },
        "log": {
            "syslog": {
                "appname": "postfix/cleanup"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "lacomte.net",
                "mordor.com"
            ]
        },
        "source": {
            "address": "mordor.com",
            "domain": "mordor.com",
            "registered_domain": "mordor.com",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "client.json"

    ```json
	
    {
        "message": "486D13F8B7: client=COMPUTER.sub.corp.com[1.1.1.1]",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtpd"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "COMPUTER.sub.corp.com"
            ],
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "COMPUTER.sub.corp.com",
            "domain": "COMPUTER.sub.corp.com",
            "ip": "1.1.1.1",
            "registered_domain": "corp.com",
            "subdomain": "COMPUTER.sub",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "client_address_field_with_mask.json"

    ```json
	
    {
        "message": "8116C5F683: action=pass, reason=client whitelist, client_name=mail-corp123.outbound.protection.outlook.com, client_address=1.1.1.1/32, sender=firstname.lastname@corp.fr, recipient=firstname.lastname@corp2.fr",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "reason": "client whitelist",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "pass",
            "outcome": "success",
            "outcome_reason": "client whitelist",
            "target": "network-traffic"
        },
        "destination": {
            "address": "corp2.fr",
            "domain": "corp2.fr",
            "registered_domain": "corp2.fr",
            "top_level_domain": "fr"
        },
        "email": {
            "from": {
                "address": [
                    "firstname.lastname@corp.fr"
                ]
            },
            "to": {
                "address": [
                    "firstname.lastname@corp2.fr"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postgrey"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "corp2.fr",
                "mail-corp123.outbound.protection.outlook.com"
            ],
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "mail-corp123.outbound.protection.outlook.com",
            "domain": "mail-corp123.outbound.protection.outlook.com",
            "ip": "1.1.1.1",
            "registered_domain": "outlook.com",
            "subdomain": "mail-corp123.outbound.protection",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "connect.json"

    ```json
	
    {
        "message": "disconnect from unknown[1.1.1.1] ehlo=1 mail=1 rcpt=0/1 quit=1 commands=3/4",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "disconnect",
            "outcome": "success",
            "target": "network-traffic"
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtpd"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        }
    }
    	
	```


=== "connection_limited.json"

    ```json
	
    {
        "message": "53C2C140E40: host smtp.office365.com[1.1.1.1] said: 432 4.3.2 Concurrent connections limit exceeded. Visit https://aka.ms/concurrent_sending for more information. [Hostname=P212321.PROD.OUTLOOK.COM] (in reply to end of DATA command)",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "reason": "Concurrent connections limit exceeded. Visit https://aka.ms/concurrent_sending for more information.",
            "type": [
                "info"
            ]
        },
        "action": {
            "outcome": "success",
            "outcome_reason": "The recipient`s Exchange Server incoming mail queue has been stopped",
            "target": "network-traffic",
            "type": "end of DATA"
        },
        "destination": {
            "address": "1.1.1.1",
            "domain": "smtp.office365.com",
            "ip": "1.1.1.1"
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtp"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "P212321.PROD.OUTLOOK.COM",
                "smtp.office365.com"
            ],
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "P212321.PROD.OUTLOOK.COM",
            "domain": "P212321.PROD.OUTLOOK.COM",
            "registered_domain": "OUTLOOK.COM",
            "subdomain": "P212321.PROD",
            "top_level_domain": "COM"
        }
    }
    	
	```


=== "counter.json"

    ```json
	
    {
        "message": "disconnect from localhost[127.0.0.1] ehlo=2 starttls=1 mail=1 rcpt=1 data=1 quit=1 commands=7",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "disconnect",
            "outcome": "success",
            "target": "network-traffic"
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtpd"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "localhost"
            ],
            "ip": [
                "127.0.0.1"
            ]
        },
        "source": {
            "address": "localhost",
            "domain": "localhost",
            "ip": "127.0.0.1"
        }
    }
    	
	```


=== "counter2.json"

    ```json
	
    {
        "message": "disconnect from localhost[127.0.0.1] ehlo=2 starttls=1 mail=1 rcpt=1 data=1 quit=1 commands=7 93",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "disconnect",
            "outcome": "success",
            "target": "network-traffic"
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtpd"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "localhost"
            ],
            "ip": [
                "127.0.0.1"
            ]
        },
        "source": {
            "address": "localhost",
            "domain": "localhost",
            "ip": "127.0.0.1"
        }
    }
    	
	```


=== "counter3.json"

    ```json
	
    {
        "message": "disconnect from unknown[1.1.1.1] ehlo=1 mail=1 rcpt=2 data=1 quit=1 commands=6 137",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "disconnect",
            "outcome": "success",
            "target": "network-traffic"
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtpd"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        }
    }
    	
	```


=== "delivered_via_spamfilter.json"

    ```json
	
    {
        "message": "EF0B15F675: to=<firstname.lastname@corp.com>, relay=spamfilter, delay=4.2, delays=1.6/0/0/2.6, dsn=2.0.0, status=sent (delivered via spamfilter service) 148",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "sent",
            "outcome": "success",
            "target": "network-traffic"
        },
        "destination": {
            "address": "corp.com",
            "domain": "corp.com",
            "registered_domain": "corp.com",
            "top_level_domain": "com"
        },
        "email": {
            "to": {
                "address": [
                    "firstname.lastname@corp.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postfix/pipe"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "corp.com"
            ]
        }
    }
    	
	```


=== "dns.json"

    ```json
	
    {
        "message": "dns: new_dns_packet: domain is utf8 flagged: ns1.example.org",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "destination": {
            "address": "ns1.example.org",
            "domain": "ns1.example.org",
            "registered_domain": "example.org",
            "subdomain": "ns1",
            "top_level_domain": "org"
        },
        "log": {
            "syslog": {
                "appname": "spamd"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "ns1.example.org"
            ]
        }
    }
    	
	```


=== "message_id.json"

    ```json
	
    {
        "message": "476295F5AD: message-id=<aaaaaaaaaa=@pm.me>",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "email": {
            "message_id": "aaaaaaaaaa=@pm.me"
        },
        "log": {
            "syslog": {
                "appname": "postfix/cleanup"
            }
        },
        "network": {
            "protocol": "smtp"
        }
    }
    	
	```


=== "message_id2.json"

    ```json
	
    {
        "message": "123456789: message-id=<foo@corp.com>",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "email": {
            "message_id": "foo@corp.com"
        },
        "log": {
            "syslog": {
                "appname": "postfix/cleanup"
            }
        },
        "network": {
            "protocol": "smtp"
        }
    }
    	
	```


=== "noqueue.json"

    ```json
	
    {
        "message": "NOQUEUE: filter: RCPT from foo.key.corp.com[192.168.1.1]: <foo.key.corp.com[192.168.1.1]>: Client host triggers FILTER smtp:[127.0.0.1]:10025; from=<foo.bar@subdomain.corp.com> to=<firstname.lastname@othercorp.com> proto=ESMTP helo=<foo.key.corp.com> 294",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "filter",
            "outcome": "success",
            "target": "network-traffic",
            "type": "RCPT"
        },
        "destination": {
            "address": "othercorp.com",
            "domain": "othercorp.com",
            "registered_domain": "othercorp.com",
            "top_level_domain": "com"
        },
        "email": {
            "from": {
                "address": [
                    "foo.bar@subdomain.corp.com"
                ]
            },
            "to": {
                "address": [
                    "firstname.lastname@othercorp.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtpd"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "foo.key.corp.com",
                "othercorp.com"
            ],
            "ip": [
                "192.168.1.1"
            ]
        },
        "source": {
            "address": "foo.key.corp.com",
            "domain": "foo.key.corp.com",
            "ip": "192.168.1.1",
            "registered_domain": "corp.com",
            "subdomain": "foo.key",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "noqueue2.json"

    ```json
	
    {
        "message": "NOQUEUE: filter: RCPT from HOSTNAME.key.corp.com[192.168.1.1]: <HOSTNAME.key.corp.com[192.168.1.1]>: Client host triggers FILTER smtp:[127.0.0.1]:10025; from=<firstname.firstname@subdomain.corp.com> to=<firstname.lastname@corp2.com> proto=ESMTP helo=<HOSTNAME.key.corp.com> 299",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "filter",
            "outcome": "success",
            "target": "network-traffic",
            "type": "RCPT"
        },
        "destination": {
            "address": "corp2.com",
            "domain": "corp2.com",
            "registered_domain": "corp2.com",
            "top_level_domain": "com"
        },
        "email": {
            "from": {
                "address": [
                    "firstname.firstname@subdomain.corp.com"
                ]
            },
            "to": {
                "address": [
                    "firstname.lastname@corp2.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtpd"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "HOSTNAME.key.corp.com",
                "corp2.com"
            ],
            "ip": [
                "192.168.1.1"
            ]
        },
        "source": {
            "address": "HOSTNAME.key.corp.com",
            "domain": "HOSTNAME.key.corp.com",
            "ip": "192.168.1.1",
            "registered_domain": "corp.com",
            "subdomain": "HOSTNAME.key",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "nospam.json"

    ```json
	
    {
        "message": "Anonymous TLS connection established to example.org[1.2.3.4]:25: TLSv1.2 with cipher ADH-AES256-GCM-SHA384 (256/256 bits)",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "destination": {
            "address": "1.2.3.4",
            "domain": "example.org",
            "ip": "1.2.3.4",
            "port": 25
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtpd"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "example.org"
            ],
            "ip": [
                "1.2.3.4"
            ]
        }
    }
    	
	```


=== "pass.json"

    ```json
	
    {
        "message": "action=pass, reason=triplet found, delay=2400, client_name=mordor.com, client_address=1.1.1.1, sender=mechant@mordor.com, recipient=Pipin.touque@lacomte.net",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "reason": "triplet found",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "pass",
            "outcome": "success",
            "outcome_reason": "triplet found",
            "target": "network-traffic"
        },
        "destination": {
            "address": "lacomte.net",
            "domain": "lacomte.net",
            "registered_domain": "lacomte.net",
            "top_level_domain": "net"
        },
        "email": {
            "from": {
                "address": [
                    "mechant@mordor.com"
                ]
            },
            "to": {
                "address": [
                    "Pipin.touque@lacomte.net"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postgrey"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "lacomte.net",
                "mordor.com"
            ],
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "mordor.com",
            "domain": "mordor.com",
            "ip": "1.1.1.1",
            "registered_domain": "mordor.com",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "pass2.json"

    ```json
	
    {
        "message": "action=pass, reason=client AAA, client_name=example.com, client_address=1.2.3.4, sender=Coyotte@acme.com, recipient=BIPBIP.NEWMAN@acme.com",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "reason": "client AAA",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "pass",
            "outcome": "success",
            "outcome_reason": "client AAA",
            "target": "network-traffic"
        },
        "destination": {
            "address": "acme.com",
            "domain": "acme.com",
            "registered_domain": "acme.com",
            "top_level_domain": "com"
        },
        "email": {
            "from": {
                "address": [
                    "Coyotte@acme.com"
                ]
            },
            "to": {
                "address": [
                    "BIPBIP.NEWMAN@acme.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postgrey"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "acme.com",
                "example.com"
            ],
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "example.com",
            "domain": "example.com",
            "ip": "1.2.3.4",
            "registered_domain": "example.com",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "policydspf1.json"

    ```json
	
    {
        "message": "Action: prepend: Text: Received-SPF: Permerror (mailfrom) identity=mailfrom; client-ip=1.1.1.1; helo=corp.com; envelope-from=ops@corp.com; receiver=<UNKNOWN>  Reject action: 550 5.7.23 210",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "reject",
            "outcome": "success",
            "target": "network-traffic"
        },
        "email": {
            "from": {
                "address": [
                    "ops@corp.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "policyd-spf"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "corp.com"
            ],
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "corp.com",
            "domain": "corp.com",
            "ip": "1.1.1.1",
            "registered_domain": "corp.com",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "policydspf2.json"

    ```json
	
    {
        "message": "Action: prepend: Text: Received-SPF: Pass (mailfrom) identity=mailfrom; client-ip=1.2.3.4; helo=mx.example.com; envelope-from=prvs=30447fe13=no-reply@example.com; receiver=<UNKNOWN>  Reject action: 550 5.7.23",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "reject",
            "outcome": "success",
            "outcome_reason": "SPF validation failed",
            "target": "network-traffic"
        },
        "email": {
            "from": {
                "address": [
                    "prvs=30447fe13=no-reply@example.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "policyd-spf"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "mx.example.com"
            ],
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "mx.example.com",
            "domain": "mx.example.com",
            "ip": "1.2.3.4",
            "registered_domain": "example.com",
            "subdomain": "mx",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "policydspf3.json"

    ```json
	
    {
        "message": "Action: prepend Received-SPF: Pass (mailfrom) identity=mailfrom; client-ip=11.22.33.44; helo=mta-11-22-33-44.example.or; envelope-from=doe@newsletter.example.org; receiver=<UNKNOWN>",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "email": {
            "from": {
                "address": [
                    "doe@newsletter.example.org"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "policyd-spf"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "mta-11-22-33-44.example.or"
            ],
            "ip": [
                "11.22.33.44"
            ]
        },
        "source": {
            "address": "mta-11-22-33-44.example.or",
            "domain": "mta-11-22-33-44.example.or",
            "ip": "11.22.33.44",
            "subdomain": "mta-11-22-33-44.example"
        }
    }
    	
	```


=== "policydspf4.json"

    ```json
	
    {
        "message": "Pass; identity=mailfrom; client-ip=1.1.1.1; helo=mail.corp.com; envelope-from=username@corp.com; receiver=<UNKNOWN> 131",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "Pass",
            "outcome": "success",
            "target": "network-traffic"
        },
        "email": {
            "from": {
                "address": [
                    "username@corp.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "policyd-spf"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "mail.corp.com"
            ],
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "mail.corp.com",
            "domain": "mail.corp.com",
            "ip": "1.1.1.1",
            "registered_domain": "corp.com",
            "subdomain": "mail",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "policydspf5.json"

    ```json
	
    {
        "message": "None; identity=helo; client-ip=1.1.1.1; helo=sub.corp.com; envelope-from=noreply@corp.com; receiver=<UNKNOWN> 128",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "email": {
            "from": {
                "address": [
                    "noreply@corp.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "policyd-spf"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "sub.corp.com"
            ],
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "sub.corp.com",
            "domain": "sub.corp.com",
            "ip": "1.1.1.1",
            "registered_domain": "corp.com",
            "subdomain": "sub",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "policydspf6.json"

    ```json
	
    {
        "message": "Softfail; identity=mailfrom; client-ip=1.1.1.1; helo=corp.com; envelope-from=username@corp.com; receiver=<UNKNOWN> 120",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "Softfail",
            "outcome": "success",
            "target": "network-traffic"
        },
        "email": {
            "from": {
                "address": [
                    "username@corp.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "policyd-spf"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "corp.com"
            ],
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "corp.com",
            "domain": "corp.com",
            "ip": "1.1.1.1",
            "registered_domain": "corp.com",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "qmgr.json"

    ```json
	
    {
        "message": "89BE920002: from=<test1@acme.com>, size=152518, nrcpt=1 (queue active)",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "email": {
            "from": {
                "address": [
                    "test1@acme.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postfix/qmgr"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "acme.com"
            ]
        },
        "source": {
            "address": "acme.com",
            "domain": "acme.com",
            "registered_domain": "acme.com",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "qmgr2.json"

    ```json
	
    {
        "message": "074955F67C: from=<bounce+41deb4.277afa-Heather.STEWART=corp.com@hrd.corp.com>, size=4303, nrcpt=1 (queue active)",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "email": {
            "from": {
                "address": [
                    "bounce+41deb4.277afa-Heather.STEWART=corp.com@hrd.corp.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postfix/qmgr"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "hrd.corp.com"
            ]
        },
        "source": {
            "address": "hrd.corp.com",
            "domain": "hrd.corp.com",
            "registered_domain": "corp.com",
            "subdomain": "hrd",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "queued.json"

    ```json
	
    {
        "message": "CA9311112C08: to=<f.lastname@corp.com>, relay=srv.corp.com[1.1.1.1]:25, delay=8.4, delays=7.6/0/0.31/0.47, dsn=2.0.0, status=sent (250 2.0.0 Ok: queued as 4TwNdH5zwCz7fxV) 257",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "sent",
            "outcome": "success",
            "outcome_reason": "success",
            "target": "network-traffic"
        },
        "destination": {
            "address": "1.1.1.1",
            "domain": "srv.corp.com",
            "ip": "1.1.1.1",
            "port": 25
        },
        "email": {
            "to": {
                "address": [
                    "f.lastname@corp.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtp"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "srv.corp.com"
            ],
            "ip": [
                "1.1.1.1"
            ]
        }
    }
    	
	```


=== "relay.json"

    ```json
	
    {
        "message": "56E28C0007: to=<rob@exemple.com>, relay=1.1.1.1[1.1.1.1]:10025, delay=0.63, delays=0.57/0/0.05/0.01, dsn=2.0.0, status=sent (250 2.0.0 Ok: queued as DF82A21108)",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "sent",
            "outcome": "success",
            "outcome_reason": "success",
            "target": "network-traffic"
        },
        "destination": {
            "address": "1.1.1.1",
            "domain": "1.1.1.1",
            "ip": "1.1.1.1",
            "port": 10025
        },
        "email": {
            "to": {
                "address": [
                    "rob@exemple.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtp"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "1.1.1.1"
            ],
            "ip": [
                "1.1.1.1"
            ]
        }
    }
    	
	```


=== "replace_header.json"

    ```json
	
    {
        "message": "95BCC140E40: replace: header From: EXAMPLE <[hola@example.org](mailto:hola@example.org)>: From: [noreply@example.org](mailto:noreply@example.org)",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "email": {
            "from": {
                "address": [
                    "hola@example.org"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postfix/cleanup"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "example.org"
            ]
        },
        "source": {
            "address": "example.org",
            "domain": "example.org",
            "registered_domain": "example.org",
            "top_level_domain": "org"
        }
    }
    	
	```


=== "sasl_login.json"

    ```json
	
    {
        "message": "warning: unknown[11.22.33.44]: SASL LOGIN authentication failed: authentication failure",
        "event": {
            "category": [
                "email"
            ],
            "reason": "SASL LOGIN authentication failed: authentication failure",
            "type": [
                "info"
            ]
        },
        "log": {
            "syslog": {
                "appname": "postfix/cleanup"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "ip": [
                "11.22.33.44"
            ]
        },
        "source": {
            "address": "11.22.33.44",
            "ip": "11.22.33.44"
        }
    }
    	
	```


=== "smtp_connection3_timed_out.json"

    ```json
	
    {
        "message": "connect to mail.corp.com[1.1.1.1]:25: Connection timed out 125",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "destination": {
            "address": "1.1.1.1",
            "domain": "mail.corp.com",
            "ip": "1.1.1.1",
            "port": 25
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtp"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "mail.corp.com"
            ],
            "ip": [
                "1.1.1.1"
            ]
        }
    }
    	
	```


=== "smtp_relay.json"

    ```json
	
    {
        "message": "96887C0006: to=<rob@exemple.com>, relay=exemple.com[1.1.1.1]:25, delay=354776, delays=354775/0/0.9/0.16, dsn=4.3.1, status=deferred (host exemple.com[1.1.1.1] said: 452 4.3.1 Insufficient system storage (in reply to MAIL FROM command))",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "deferred",
            "outcome": "success",
            "outcome_reason": "The recipient`s mail server is experiencing a Disk Full condition",
            "target": "network-traffic"
        },
        "destination": {
            "address": "1.1.1.1",
            "domain": "exemple.com",
            "ip": "1.1.1.1",
            "port": 25
        },
        "email": {
            "to": {
                "address": [
                    "rob@exemple.com"
                ]
            }
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtp"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "exemple.com"
            ],
            "ip": [
                "1.1.1.1"
            ]
        }
    }
    	
	```


=== "smtpd_connection.json"

    ```json
	
    {
        "message": "lost connection after AUTH from unknown[1.1.1.1]",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "lost connection",
            "outcome": "success",
            "target": "network-traffic",
            "type": "AUTH"
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtpd"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        }
    }
    	
	```


=== "smtpd_connection2.json"

    ```json
	
    {
        "message": "connect from unknown[10.1.1.1] 88",
        "event": {
            "category": [
                "email"
            ],
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "action": {
            "name": "connect",
            "outcome": "success",
            "target": "network-traffic"
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtpd"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "ip": [
                "10.1.1.1"
            ]
        },
        "source": {
            "address": "10.1.1.1",
            "ip": "10.1.1.1"
        }
    }
    	
	```


=== "smtpd_tls.json"

    ```json
	
    {
        "message": "Trusted TLS connection established from mail.outbound.protection.outlook.com[1.1.1.1]: TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits)",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtpd"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "mail.outbound.protection.outlook.com"
            ],
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "mail.outbound.protection.outlook.com",
            "domain": "mail.outbound.protection.outlook.com",
            "ip": "1.1.1.1",
            "registered_domain": "outlook.com",
            "subdomain": "mail.outbound.protection",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "smtpd_tls2.json"

    ```json
	
    {
        "message": "Trusted TLS connection established to mx.corp.com[1.1.1.1]:25: TLSv1.3 with cipher TLS_AES_128_GCM_SHA256 (128/128 bits) key-exchange X25519 server-signature RSA-PSS (2048 bits) server-digest SHA256",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "destination": {
            "address": "1.1.1.1",
            "domain": "mx.corp.com",
            "ip": "1.1.1.1",
            "port": 25
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtpd"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "mx.corp.com"
            ],
            "ip": [
                "1.1.1.1"
            ]
        }
    }
    	
	```


=== "smtpd_tls3.json"

    ```json
	
    {
        "message": "Trusted TLS connection established to 127.0.0.1[127.0.0.1]:10025: TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits) key-exchange X25519 server-signature RSA-PSS (2048 bits) server-digest SHA256 201",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "destination": {
            "address": "127.0.0.1",
            "domain": "127.0.0.1",
            "ip": "127.0.0.1",
            "port": 10025
        },
        "log": {
            "syslog": {
                "appname": "postfix/smtpd"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "127.0.0.1"
            ],
            "ip": [
                "127.0.0.1"
            ]
        }
    }
    	
	```


=== "spamd.json"

    ```json
	
    {
        "message": "spamd: result: . -1 - DKIM_SIGNED,DKIM_VALID,DKIM_VALID_AU,HEADER_FROM_DIFFERENT_DOMAINS,HTML_MESSAGE,SPF_HELO_NONE,SPF_PASS,T_KAM_HTML_FONT_INVALID scantime=3.4,size=120289,user=debian-spamd,uid=119,required_score=5.0,rhost=127.0.0.1,raddr=127.0.0.1,rport=44944,mid=<11111111111111@uexample.org>,autolearn=disabled",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "email": {
            "message_id": "<11111111111111@uexample.org>"
        },
        "log": {
            "syslog": {
                "appname": "spamd"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "127.0.0.1"
            ],
            "ip": [
                "127.0.0.1"
            ],
            "user": [
                "debian-spamd"
            ]
        },
        "source": {
            "address": "127.0.0.1",
            "domain": "127.0.0.1",
            "ip": "127.0.0.1",
            "port": 44944
        },
        "user": {
            "name": "debian-spamd"
        }
    }
    	
	```


=== "spamd_2.json"

    ```json
	
    {
        "message": "spamd: connection from example.org [127.0.0.1]:53684 to port 783, fd 5",
        "event": {
            "category": [
                "email"
            ],
            "type": [
                "info"
            ]
        },
        "destination": {
            "port": 783
        },
        "log": {
            "syslog": {
                "appname": "spamd"
            }
        },
        "network": {
            "protocol": "smtp"
        },
        "related": {
            "hosts": [
                "example.org"
            ],
            "ip": [
                "127.0.0.1"
            ]
        },
        "source": {
            "address": "example.org",
            "domain": "example.org",
            "ip": "127.0.0.1",
            "port": 53684,
            "registered_domain": "example.org",
            "top_level_domain": "org"
        }
    }
    	
	```





## Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`action.target` | `keyword` |  |
|`destination.address` | `keyword` | Destination network address. |
|`destination.domain` | `keyword` | The domain name of the destination. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.port` | `long` | Port of the destination. |
|`email.from.address` | `keyword` | The sender's email address. |
|`email.message_id` | `wildcard` | Value from the Message-ID header. |
|`email.to.address` | `keyword` | Email address of recipient |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.reason` | `keyword` | Reason why this event happened, according to the source |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`file.created` | `date` | File creation time. |
|`file.ctime` | `date` | Last time the file attributes or metadata changed. |
|`file.name` | `keyword` | Name of the file including the extension, without the directory. |
|`file.size` | `long` | File size in bytes. |
|`network.protocol` | `keyword` | Application protocol name. |
|`source.address` | `keyword` | Source network address. |
|`source.domain` | `keyword` | The domain name of the source. |
|`source.ip` | `ip` | IP address of the source. |
|`source.port` | `long` | Port of the source. |
|`user.name` | `keyword` | Short name or login of the user. |

