
## Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Binary file metadata` | to be defined |
| `Disk forensics` | to be defined |
| `File monitoring` | to be defined |
| `Host network interface` | to be defined |
| `Kernel drivers` | to be defined |
| `Loaded DLLs` | to be defined |
| `Named Pipes` | to be defined |
| `PowerShell logs` | to be defined |
| `Process command-line parameters` | to be defined |
| `Process monitoring` | to be defined |
| `Process use of network` | to be defined |
| `Services` | to be defined |
| `Windows event logs` | to be defined |
| `Windows Registry` | registry auditing events are examined in detail |
| `WMI Objects` | Windows WMI Activity events are analyzed, and events related to WMI process too |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `alert`, `event` |
| Category | `authentication`, `network`, `process`, `web` |
| Type | `access`, `connection`, `info`, `start` |




## Event Samples

Find below few samples of events and how they are normalized by Sekoia.io.


=== "alert.json"

    ```json
	
    {
        "message": "{\"aggregation_key\":\"40fd5973a79d4e0f21e689938e5f269d20a3be780949eb6f408d5cb65c6974d1\",\"type\":\"rtlogs\",\"agent\":{\"osversion\":\"10.0.19041\",\"domainname\":\"WORKGROUP\",\"agentid\":\"8cb8fb07-ecb4-4537-8a44-451ef855a874\",\"osproducttype\":\"Windows 10 Pro\",\"hostname\":\"REDACTED\",\"domain\":null},\"level\":\"high\",\"msg\":\"Binary was found malicious by 2 rule(s) with a score of 120\",\"tags\":[],\"rule_name\":\"YARA binary check\",\"process\":{\"signature_info\":{\"root_info\":{\"display_name\":\"\",\"thumbprint\":\"\",\"serial_number\":\"\",\"issuer_name\":\"\"},\"signed_catalog\":false,\"signer_info\":{\"display_name\":\"\",\"thumbprint\":\"\",\"serial_number\":\"\",\"issuer_name\":\"\"},\"signed_authenticode\":false},\"commandline\":\"\\\"C:\\\\Users\\\\valves\\\\Desktop\\\\mimikatz.exe\\\"\",\"matched_rules_count\":2,\"fake_parent_commandline\":null,\"dont_create_process\":true,\"session\":2,\"pid\":5736,\"process_name\":\"mimikatz.exe\",\"score\":120,\"pe_info\":{\"product_version\":\"2.2.0.0\",\"file_description\":\"mimikatz for Windows\",\"original_filename\":\"mimikatz.exe\",\"internal_name\":\"mimikatz\",\"file_version\":\"2.2.0.0\",\"company_name\":\"Braveheart\",\"legal_copyright\":\"Copyright (c) 2007 - 2020 Braveheart\",\"product_name\":\"mimikatz\"},\"fake_parent_image\":null,\"username\":\"REDACTED\\\\valves\",\"pe_timestamp_int\":1619768223,\"image_name\":\"C:\\\\Users\\\\valves\\\\Desktop\\\\mimikatz.exe\",\"parent_integrity_level\":\"High\",\"fake_parent_unique_id\":null,\"status_msg\":\"Binary was found potentially malicious on the endpoint by Yara with a score of 120 , but it is running in alert only mode\",\"log_type\":\"process\",\"logonid\":1121594,\"process_unique_id\":\"ab376ee3-ecb4-4537-1668-00993e12c556\",\"usersid\":\"S-1-5-21-794873159-2603523847-3490392889-500\",\"error_msg\":\"\",\"parent_image\":\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\",\"fake_ppid\":null,\"integrity_level\":\"High\",\"current_directory\":\"C:\\\\Users\\\\valves\\\\Desktop\",\"pe_timestamp\":\"2021-04-30T07:37:03.000Z\",\"parent_unique_id\":\"ab376ee3-ecb4-4537-06a4-0031a7bc3d13\",\"pe_imphash\":\"B6BC868F5046CE7764D0627266AF0200\",\"hashes\":{\"md5\":\"46f3fa15de36a0825df4dbfd94614566\",\"sha256\":\"79dd65171cdbc3a1505d11921babf62ffcab4d725ab4a28813c02a6f3a2760ff\",\"sha1\":\"41453d9b0ae75f687c7720373d7586bc0a9d1607\"},\"size\":1430016,\"matched_rules\":[{\"namespace\":\"mimikatz.yar\",\"rulename\":\"mimikatz_clear_string_markers\",\"source\":\"default\"},{\"namespace\":\"mimikatz.yar\",\"rulename\":\"mimikatz_patches_x64\",\"source\":\"default\"}],\"create_time\":\"2021/04/30 13:20:54.315189\",\"parent_commandline\":\"\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\" \",\"rule_revision\":81,\"signed\":false,\"ppid\":1700,\"status\":0},\"alert_time\":\"2021-04-30T13:21:20.704+00:00\",\"alert_subtype\":\"process\",\"execution\":0,\"alert_type\":\"yara\",\"rule_id\":\"YARA binary check\",\"@version\":\"1\",\"@timestamp\":\"2021-04-30T13:21:20.717Z\",\"@event_create_date\":\"2021-04-30T13:21:20.704Z\",\"log_type\":\"alert\",\"status\":\"new\",\"alert_unique_id\":\"bd13fef8-a8fd-4d28-ad97-928a83b96085\"}",
        "event": {
            "dataset": "alert",
            "category": [
                "process"
            ],
            "type": [
                "start"
            ],
            "kind": "alert"
        },
        "@timestamp": "2021-04-30T13:21:20.704000Z",
        "agent": {
            "id": "8cb8fb07-ecb4-4537-8a44-451ef855a874",
            "name": "harfanglab"
        },
        "log": {
            "hostname": "REDACTED"
        },
        "host": {
            "hostname": "REDACTED",
            "domain": "WORKGROUP",
            "os": {
                "version": "10.0.19041",
                "full": "Windows 10 Pro"
            },
            "name": "REDACTED"
        },
        "harfanglab": {
            "level": "high",
            "alert_time": "2021-04-30T13:21:20.704+00:00",
            "alert_unique_id": "bd13fef8-a8fd-4d28-ad97-928a83b96085",
            "alert_subtype": "process",
            "execution": 0,
            "status": "new",
            "aggregation_key": "40fd5973a79d4e0f21e689938e5f269d20a3be780949eb6f408d5cb65c6974d1"
        },
        "rule": {
            "description": "Binary was found malicious by 2 rule(s) with a score of 120",
            "name": "YARA binary check",
            "category": "yara",
            "id": "YARA binary check"
        },
        "process": {
            "command_line": "\"C:\\Users\\valves\\Desktop\\mimikatz.exe\"",
            "pid": 5736,
            "name": "mimikatz.exe",
            "pe": {
                "description": "mimikatz for Windows",
                "original_file_name": "mimikatz.exe",
                "file_version": "2.2.0.0",
                "company": "Braveheart",
                "product": "mimikatz",
                "imphash": "B6BC868F5046CE7764D0627266AF0200"
            },
            "executable": "C:\\Users\\valves\\Desktop\\mimikatz.exe",
            "parent": {
                "executable": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
                "command_line": "\"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" "
            },
            "working_directory": "C:\\Users\\valves\\Desktop"
        },
        "user": {
            "name": "REDACTED\\valves"
        },
        "file": {
            "hash": {
                "md5": "46f3fa15de36a0825df4dbfd94614566",
                "sha256": "79dd65171cdbc3a1505d11921babf62ffcab4d725ab4a28813c02a6f3a2760ff",
                "sha1": "41453d9b0ae75f687c7720373d7586bc0a9d1607"
            }
        },
        "related": {
            "hash": [
                "41453d9b0ae75f687c7720373d7586bc0a9d1607",
                "46f3fa15de36a0825df4dbfd94614566",
                "79dd65171cdbc3a1505d11921babf62ffcab4d725ab4a28813c02a6f3a2760ff"
            ],
            "hosts": [
                "REDACTED"
            ],
            "user": [
                "REDACTED\\valves"
            ]
        }
    }
    	
	```


=== "alert_false_positive.json"

    ```json
	
    {
        "message": "{\n  \"@version\": \"1\",\n  \"agent\": {\n    \"agentid\": \"00000000-0000-0000-0000-000000000000\",\n    \"distroid\": null,\n    \"domainname\": \"domain123\",\n    \"ostype\": \"windows\",\n    \"hostname\": \"pc123\",\n    \"osversion\": \"10.0.19041\",\n    \"osproducttype\": \"Windows 10 Pro\",\n    \"domain\": null,\n    \"version\": \"2.12.6\"\n  },\n  \"type\": \"rtlogs\",\n  \"alert_subtype\": \"process\",\n  \"log_type\": \"alert\",\n  \"detection_origin\": \"agent\",\n  \"tenant\": \"\",\n  \"alert_time\": \"2022-03-15T07:26:01.276+00:00\",\n  \"alert_type\": \"sigma\",\n  \"status\": \"false_positive\",\n  \"rule_id\": \"00000000-0000-0000-0000-000000000000\",\n  \"@event_create_date\": \"2022-03-15T07:26:01.276Z\",\n  \"alert_unique_id\": \"00000000-0000-0000-0000-000000000000\",\n  \"level\": \"low\",\n  \"aggregation_key\": \"123456\",\n  \"@timestamp\": \"2022-03-15T07:26:01.311Z\",\n  \"tags\": [\n    \"attack.discovery\",\n    \"attack.t1057\",\n    \"attack.s0057\"\n  ],\n  \"process\": {\n    \"detection_timestamp\": \"2022/03/15 07:24:54.438105\",\n    \"process_unique_id\": \"00000000-0000-0000-0000-000000000000\",\n    \"parent_integrity_level\": \"Medium\",\n    \"log_platform_flag\": 0,\n    \"fake_parent_image\": null,\n    \"pid\": 11320,\n    \"image_name\": \"C:\\\\Windows\\\\SysWOW64\\\\tasklist.exe\",\n    \"username\": \"XXX\\\\XXX\",\n    \"logonid\": 151210562,\n    \"signature_info\": {\n      \"signed_authenticode\": false,\n      \"signed_catalog\": true,\n      \"root_info\": {\n        \"thumbprint\": \"3b1efd3a66ea28b16697394703a72ca340a05bd5\",\n        \"display_name\": \"Microsoft Root Certificate Authority 2010\",\n        \"serial_number\": \"28cc3a25bfba44ac449a9b586b4339aa\",\n        \"issuer_name\": \"Microsoft Root Certificate Authority 2010\"\n      },\n      \"signer_info\": {\n        \"thumbprint\": \"f7c2f2c96a328c13cda8cdb57b715bdea2cbd1d9\",\n        \"display_name\": \"Microsoft Windows\",\n        \"serial_number\": \"33000002ec6579ad1e670890130000000002ec\",\n        \"issuer_name\": \"Microsoft Windows Production PCA 2011\"\n      }\n    },\n    \"current_directory\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\",\n    \"error_msg\": \"\",\n    \"status_msg\": \"sigma match detected this process but not configured to block it\",\n    \"ppid\": 17808,\n    \"fake_parent_commandline\": null,\n    \"commandline\": \"tasklist\",\n    \"signed\": true,\n    \"grandparent_integrity_level\": \"Medium\",\n    \"log_type\": \"process\",\n    \"pe_imphash\": \"19BBD9C4E73C288A3645E163F4B82682\",\n    \"create_time\": \"2022-03-15T07:24:54.260Z\",\n    \"status\": 0,\n    \"parent_image\": \"C:\\\\Windows\\\\SysWOW64\\\\cmd.exe\",\n    \"integrity_level\": \"Medium\",\n    \"usersid\": \"S-1-5-21-299502267-725345543-82448378-2366\",\n    \"pe_info\": {\n      \"product_version\": \"10.0.19041.1\",\n      \"legal_copyright\": \"\u00a9 Microsoft Corporation. All rights reserved.\",\n      \"original_filename\": \"tasklist.exe\",\n      \"company_name\": \"Microsoft Corporation\",\n      \"file_description\": \"Lists the current running tasks\",\n      \"file_version\": \"10.0.19041.1 (WinBuild.160101.0800)\",\n      \"internal_name\": \"tasklist.exe\",\n      \"product_name\": \"Microsoft\u00ae Windows\u00ae Operating System\"\n    },\n    \"session\": 3,\n    \"pe_timestamp\": \"1994-09-11T16:43:21.000Z\",\n    \"parent_unique_id\": \"2332edf8-70c0-43c2-4590-00f912ab3d18\",\n    \"process_name\": \"tasklist.exe\",\n    \"grandparent_commandline\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\\\\EPOSConnect.exe 1\",\n    \"pe_timestamp_int\": 779301801,\n    \"grandparent_image\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\\\\EPOSConnect.exe\",\n    \"parent_commandline\": \"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /d /s /c tasklist\",\n    \"fake_parent_unique_id\": null,\n    \"size\": 79360,\n    \"fake_ppid\": null,\n    \"hashes\": {\n      \"sha1\": \"7f50d8c3cf3ec79122a876e969bdb65d939becd0\",\n      \"sha256\": \"76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4\",\n      \"md5\": \"0a4448b31ce7f83cb7691a2657f330f1\"\n    }\n  },\n  \"execution\": 0,\n  \"rule_name\": \"Discovery: Process list\",\n  \"maturity\": \"stable\",\n  \"msg\": \"Detects the execution of tasklist.exe, a tool used to gather detailed information about a computer's active processes.\"\n}\n",
        "event": {
            "dataset": "alert",
            "category": [
                "process"
            ],
            "type": [
                "start"
            ],
            "kind": "alert"
        },
        "@timestamp": "2022-03-15T07:26:01.276000Z",
        "agent": {
            "id": "00000000-0000-0000-0000-000000000000",
            "name": "harfanglab"
        },
        "log": {
            "hostname": "pc123"
        },
        "host": {
            "hostname": "pc123",
            "domain": "domain123",
            "os": {
                "version": "10.0.19041",
                "full": "Windows 10 Pro"
            },
            "name": "pc123"
        },
        "harfanglab": {
            "level": "low",
            "alert_time": "2022-03-15T07:26:01.276+00:00",
            "alert_unique_id": "00000000-0000-0000-0000-000000000000",
            "alert_subtype": "process",
            "execution": 0,
            "status": "false_positive",
            "aggregation_key": "123456"
        },
        "rule": {
            "description": "Detects the execution of tasklist.exe, a tool used to gather detailed information about a computer's active processes.",
            "name": "Discovery: Process list",
            "category": "sigma",
            "id": "00000000-0000-0000-0000-000000000000"
        },
        "process": {
            "command_line": "tasklist",
            "pid": 11320,
            "name": "tasklist.exe",
            "pe": {
                "description": "Lists the current running tasks",
                "original_file_name": "tasklist.exe",
                "file_version": "10.0.19041.1 (WinBuild.160101.0800)",
                "company": "Microsoft Corporation",
                "product": "Microsoft\u00ae Windows\u00ae Operating System",
                "imphash": "19BBD9C4E73C288A3645E163F4B82682"
            },
            "executable": "C:\\Windows\\SysWOW64\\tasklist.exe",
            "parent": {
                "executable": "C:\\Windows\\SysWOW64\\cmd.exe",
                "command_line": "C:\\WINDOWS\\system32\\cmd.exe /d /s /c tasklist"
            },
            "working_directory": "C:\\Program Files (x86)\\EPOS\\EPOS Connect"
        },
        "user": {
            "name": "XXX\\XXX"
        },
        "file": {
            "hash": {
                "md5": "0a4448b31ce7f83cb7691a2657f330f1",
                "sha256": "76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4",
                "sha1": "7f50d8c3cf3ec79122a876e969bdb65d939becd0"
            }
        },
        "related": {
            "hash": [
                "0a4448b31ce7f83cb7691a2657f330f1",
                "76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4",
                "7f50d8c3cf3ec79122a876e969bdb65d939becd0"
            ],
            "hosts": [
                "pc123"
            ],
            "user": [
                "XXX\\XXX"
            ]
        }
    }
    	
	```


=== "auditlog-event.json"

    ```json
	
    {
        "message": "{\"request_method\":\"POST\",\"response_content\":\"[]\",\"@timestamp\":\"2023-05-09T09:11:09.296679Z\",\"action_title\":\"Login\",\"event\":{\"original\":\"{\\\"log_type\\\":\\\"auditlog\\\",\\\"log_slug\\\":\\\"mfa-authtoken-login-post\\\",\\\"log_creation_date\\\":\\\"2023-05-09T09:11:09.284452+00:00\\\",\\\"action_title\\\":\\\"Login\\\",\\\"log_description\\\":\\\"User User logged in\\\",\\\"username\\\":\\\"AnonymousUser\\\",\\\"ip_address\\\":\\\"10.42.0.36\\\",\\\"user_agent\\\":\\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\\\",\\\"request_method\\\":\\\"POST\\\",\\\"request_path\\\":\\\"/api/auth/login/\\\",\\\"request_content\\\":\\\"[username:User]\\\",\\\"response_status_code\\\":\\\"200\\\",\\\"response_status_text\\\":\\\"OK\\\",\\\"response_content\\\":\\\"[]\\\"}\"},\"log_slug\":\"mfa-authtoken-login-post\",\"log_type\":\"auditlog\",\"user_agent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\",\"request_path\":\"/api/auth/login/\",\"log_creation_date\":\"2023-05-09T09:11:09.284452+00:00\",\"response_status_code\":\"200\",\"response_status_text\":\"OK\",\"log_description\":\"User User logged in\",\"ip_address\":\"1.2.3.4\",\"tenant\":\"6685e0c99733744d\",\"request_content\":\"[username: user]\",\"username\":\"AnonymousUser\",\"@version\":\"1\"}",
        "event": {
            "dataset": "auditlog",
            "category": [
                "web"
            ],
            "type": [
                "access"
            ],
            "kind": "event",
            "reason": "User User logged in",
            "action": "mfa-authtoken-login-post"
        },
        "agent": {
            "name": "harfanglab"
        },
        "http": {
            "request": {
                "method": "POST"
            },
            "response": {
                "status_code": 200
            }
        },
        "url": {
            "path": "/api/auth/login/"
        },
        "user_agent": {
            "original": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0",
            "device": {
                "name": "Other"
            },
            "name": "Firefox",
            "version": "102.0",
            "os": {
                "name": "Windows",
                "version": "10"
            }
        },
        "user": {
            "name": "AnonymousUser"
        },
        "source": {
            "ip": "1.2.3.4",
            "address": "1.2.3.4"
        },
        "organization": {
            "id": "6685e0c99733744d"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "AnonymousUser"
            ]
        }
    }
    	
	```


=== "authentication.json"

    ```json
	
    {
        "message": "{\n  \"@version\": \"1\",\n  \"log_type\": \"authentication\",\n  \"event_type\": \"login_failure\",\n  \"@timestamp\": \"2023-03-31T06:38:45.597386Z\",\n  \"process_name\": \"C:\\\\Windows\\\\System32\\\\svchost.exe\",\n  \"groups\": [\n    {\n      \"name\": \"custom-group\",\n      \"id\": \"0dd95277-37da-4ffe-9aec-0fc76beb2e5e\"\n    }\n  ],\n  \"object_type\": \"login\",\n  \"target_username\": \"work-laptop\\\\administrateur\",\n  \"success\": false,\n  \"auth_type\": \"Interactive\",\n  \"technique\": \"Brute Force\",\n  \"source_address\": \"127.0.0.1\",\n  \"windows\": {\n    \"workstation_name\": \"work-laptop\",\n    \"source_sid\": \"S-1-5-18\",\n    \"authentication_package_name\": \"Negotiate\",\n    \"event_title\": \"An account failed to log on\",\n    \"event_id\": 4625,\n    \"logon_title\": \"Interactive\",\n    \"target_sid\": \"S-1-0-0\",\n    \"source_logon_id\": 999,\n    \"logon_type\": 2,\n    \"sub_status\": 0,\n    \"process_name\": \"C:\\\\Windows\\\\System32\\\\svchost.exe\",\n    \"logon_process_name\": \"User32\",\n    \"target_logon_id\": 0,\n    \"ip_address\": \"127.0.0.1\",\n    \"status\": 0,\n    \"ip_port\": \"0\"\n  },\n  \"utc_time\": \"2023-03-31T06:38:42.818Z\",\n  \"source_username\": \"test-domain\\\\work-laptop$\",\n  \"agent\": {\n    \"osversion\": \"10.0.19045\",\n    \"domainname\": \"test-domain\",\n    \"hostname\": \"work-laptop\",\n    \"dnsdomainname\": \"test-domain.local\",\n    \"osproducttype\": \"Windows 10 Pro\",\n    \"version\": \"2.24.4-post0\",\n    \"ostype\": \"windows\",\n    \"agentid\": \"2e822bcd-52cc-43e7-94fc-5a5d6f38506d\"\n  },\n  \"auth_status\": \"Status OK\",\n  \"@event_create_date\": \"2023-03-31T06:38:42.818Z\",\n  \"tactic\": \"Credential Access\",\n  \"event\": {\n    \"original\": \"{\\\"log_type\\\":\\\"authentication\\\",\\\"object_type\\\":\\\"login\\\",\\\"success\\\":false,\\\"utc_time\\\":\\\"2023/03/31 06:38:42.818\\\",\\\"windows\\\":{\\\"event_id\\\":4625,\\\"event_title\\\":\\\"An account failed to log on\\\",\\\"target_sid\\\":\\\"S-1-0-0\\\",\\\"target_logon_id\\\":0,\\\"source_sid\\\":\\\"S-1-5-18\\\",\\\"source_logon_id\\\":999,\\\"logon_type\\\":2,\\\"logon_title\\\":\\\"Interactive\\\",\\\"logon_process_name\\\":\\\"User32\\\",\\\"authentication_package_name\\\":\\\"Negotiate\\\",\\\"workstation_name\\\":\\\"work-laptop\\\",\\\"ip_address\\\":\\\"127.0.0.1\\\",\\\"ip_port\\\":\\\"0\\\",\\\"status\\\":0,\\\"sub_status\\\":0,\\\"process_name\\\":\\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\svchost.exe\\\"},\\\"event_type\\\":\\\"login_failure\\\",\\\"msg\\\":\\\"%%2313\\\",\\\"source_address\\\":\\\"127.0.0.1\\\",\\\"process_name\\\":\\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\svchost.exe\\\",\\\"auth_type\\\":\\\"Interactive\\\",\\\"auth_status\\\":\\\"Status OK\\\",\\\"groups\\\":[{\\\"id\\\":\\\"0dd95277-37da-4ffe-9aec-0fc76beb2e5e\\\",\\\"name\\\":\\\"custom-group\\\"}],\\\"source_username\\\":\\\"test-domain\\\\\\\\work-laptop$\\\",\\\"target_username\\\":\\\"work-laptop\\\\\\\\administrateur\\\",\\\"tactic\\\":\\\"Credential Access\\\",\\\"technique\\\":\\\"Brute Force\\\",\\\"agent\\\":{\\\"hostname\\\":\\\"work-laptop\\\",\\\"domainname\\\":\\\"test-domain\\\",\\\"dnsdomainname\\\":\\\"test-domain.local\\\",\\\"ostype\\\":\\\"windows\\\",\\\"osversion\\\":\\\"10.0.19045\\\",\\\"osproducttype\\\":\\\"Windows 10 Pro\\\",\\\"version\\\":\\\"2.24.4-post0\\\",\\\"agentid\\\":\\\"2e822bcd-52cc-43e7-94fc-5a5d6f38506d\\\"}}\"\n  },\n  \"tenant\": \"50e03aed1dbf33d4\",\n  \"msg\": \"%%2313\"\n}",
        "event": {
            "dataset": "authentication",
            "category": [
                "authentication"
            ],
            "type": [
                "end"
            ],
            "kind": "event",
            "reason": "An account failed to log on",
            "code": "4625",
            "action": "login"
        },
        "@timestamp": "2023-03-31T06:38:42.818000Z",
        "agent": {
            "id": "2e822bcd-52cc-43e7-94fc-5a5d6f38506d",
            "name": "harfanglab",
            "version": "2.24.4-post0"
        },
        "log": {
            "hostname": "work-laptop"
        },
        "host": {
            "hostname": "work-laptop",
            "domain": "test-domain",
            "os": {
                "version": "10.0.19045",
                "full": "Windows 10 Pro"
            },
            "name": "work-laptop"
        },
        "harfanglab": {
            "groups": [
                "{\"id\": \"0dd95277-37da-4ffe-9aec-0fc76beb2e5e\", \"name\": \"custom-group\"}"
            ]
        },
        "user": {
            "roles": "custom-group",
            "id": "S-1-5-18",
            "name": "test-domain\\work-laptop$",
            "target": {
                "id": "S-1-0-0",
                "name": "work-laptop\\administrateur"
            }
        },
        "source": {
            "ip": "127.0.0.1",
            "address": "127.0.0.1"
        },
        "process": {
            "name": "C:\\Windows\\System32\\svchost.exe"
        },
        "action": {
            "id": 4625
        },
        "organization": {
            "id": "50e03aed1dbf33d4"
        },
        "related": {
            "hosts": [
                "work-laptop"
            ],
            "ip": [
                "127.0.0.1"
            ],
            "user": [
                "test-domain\\work-laptop$"
            ]
        }
    }
    	
	```


=== "dns.json"

    ```json
	
    {
        "message": "{\n  \"@version\": \"1\",\n  \"query_type\": \"AAAA\",\n  \"log_type\": \"dns_resolution\",\n  \"agent\": {\n    \"osversion\": \"10.0.19045\",\n    \"domainname\": \"test-domain\",\n    \"hostname\": \"work-laptop\",\n    \"dnsdomainname\": \"test-domain.local\",\n    \"osproducttype\": \"Windows 10 Pro\",\n    \"version\": \"2.24.4-post0\",\n    \"ostype\": \"windows\",\n    \"agentid\": \"2e822bcd-52cc-43e7-94fc-5a5d6f38506d\"\n  },\n  \"@timestamp\": \"2023-03-31T06:39:34.483980Z\",\n  \"groups\": [\n    {\n      \"name\": \"custom-group\",\n      \"id\": \"0dd95277-37da-4ffe-9aec-0fc76beb2e5e\"\n    }\n  ],\n  \"ip_addresses\": [\n    \"152.199.21.118\"\n  ],\n  \"process_image_path\": \"C:\\\\Windows\\\\SystemApps\\\\Microsoft.Windows.Search_cw5n1h2txyewy\\\\SearchApp.exe\",\n  \"@event_create_date\": \"2023-03-31T06:39:14.570000+00:00\",\n  \"requested_name\": \"static-ecst.licdn.com\",\n  \"raw_windows_resolver_results\": \"type:  5 cs1404.wpc.epsiloncdn.net;::ffff:152.199.21.118;\",\n  \"event\": {\n    \"original\": \"{\\\"utc_time\\\":\\\"2023-03-31T06:39:14.570000+00:00\\\",\\\"log_type\\\":\\\"dns_resolution\\\",\\\"requested_name\\\":\\\"static-ecst.licdn.com\\\",\\\"query_type\\\":\\\"AAAA\\\",\\\"status\\\":\\\"success\\\",\\\"ip_addresses\\\":[\\\"152.199.21.118\\\"],\\\"raw_windows_resolver_results\\\":\\\"type:  5 cs1404.wpc.epsiloncdn.net;::ffff:152.199.21.118;\\\",\\\"process_unique_id\\\":\\\"887d1052-52cc-43e7-7c30-00778b2ff016\\\",\\\"process_image_path\\\":\\\"C:\\\\\\\\Windows\\\\\\\\SystemApps\\\\\\\\Microsoft.Windows.Search_cw5n1h2txyewy\\\\\\\\SearchApp.exe\\\",\\\"pid\\\":12412,\\\"username\\\":\\\"test-domain\\\\\\\\john.doe\\\",\\\"groups\\\":[{\\\"id\\\":\\\"0dd95277-37da-4ffe-9aec-0fc76beb2e5e\\\",\\\"name\\\":\\\"custom-group\\\"}],\\\"agent\\\":{\\\"hostname\\\":\\\"work-laptop\\\",\\\"domainname\\\":\\\"test-domain\\\",\\\"dnsdomainname\\\":\\\"test-domain.local\\\",\\\"ostype\\\":\\\"windows\\\",\\\"osversion\\\":\\\"10.0.19045\\\",\\\"osproducttype\\\":\\\"Windows 10 Pro\\\",\\\"version\\\":\\\"2.24.4-post0\\\",\\\"agentid\\\":\\\"2e822bcd-52cc-43e7-94fc-5a5d6f38506d\\\"}}\"\n  },\n  \"tenant\": \"50e03aed1dbf33d4\",\n  \"status\": \"success\",\n  \"process_unique_id\": \"887d1052-52cc-43e7-7c30-00778b2ff016\",\n  \"username\": \"test-domain\\\\john.doe\",\n  \"pid\": 12412\n}",
        "event": {
            "dataset": "dns_resolution",
            "category": [
                "network"
            ],
            "type": [
                "info"
            ],
            "kind": "event"
        },
        "@timestamp": "2023-03-31T06:39:14.570000Z",
        "agent": {
            "id": "2e822bcd-52cc-43e7-94fc-5a5d6f38506d",
            "name": "harfanglab"
        },
        "log": {
            "hostname": "work-laptop"
        },
        "host": {
            "hostname": "work-laptop",
            "domain": "test-domain",
            "os": {
                "version": "10.0.19045",
                "full": "Windows 10 Pro"
            },
            "name": "work-laptop"
        },
        "harfanglab": {
            "groups": [
                "{\"id\": \"0dd95277-37da-4ffe-9aec-0fc76beb2e5e\", \"name\": \"custom-group\"}"
            ]
        },
        "user": {
            "roles": "custom-group",
            "name": "test-domain\\john.doe"
        },
        "process": {
            "pid": 12412,
            "executable": "C:\\Windows\\SystemApps\\Microsoft.Windows.Search_cw5n1h2txyewy\\SearchApp.exe"
        },
        "dns": {
            "question": {
                "type": "AAAA",
                "name": "static-ecst.licdn.com",
                "top_level_domain": "com",
                "subdomain": "static-ecst",
                "registered_domain": "licdn.com"
            }
        },
        "organization": {
            "id": "50e03aed1dbf33d4"
        },
        "related": {
            "hosts": [
                "static-ecst.licdn.com",
                "work-laptop"
            ],
            "user": [
                "test-domain\\john.doe"
            ]
        }
    }
    	
	```


=== "investigation.json"

    ```json
	
    {
        "message": "{\"cmdline\":\"C:\\\\Windows\\\\system32\\\\svchost.exe -k wusvcs -p\",\"session\":0,\"pid\":3092,\"job_id\":\"c0cbd87c-c793-4af9-9ecf-53739f3f27a5\",\"process_bits\":64,\"@timestamp\":\"2021-05-01T07:49:08.043Z\",\"username\":\"NT AUTHORITY\\\\SYSTEM\",\"@version\":\"1\",\"log_type\":\"investigation\",\"binaryinfo\":{\"filename\":\"svchost.exe\",\"fullpath\":\"C:\\\\Windows\\\\System32\\\\svchost.exe\",\"binaryinfo\":{\"root_thumbprint\":\"3b1efd3a66ea28b16697394703a72ca340a05bd5\",\"pe_file_version\":\"10.0.17763.1 (WinBuild.160101.0800)\",\"filesize\":51696,\"signer_serial_number\":\"33000001a90f2d80c9a929387c0000000001a9\",\"pe_timestamp_int\":3103846143,\"pe_legal_copyright\":\"\u00a9 Microsoft Corporation. All rights reserved.\",\"signed_catalog\":false,\"signer_display_name\":\"Microsoft Windows Publisher\",\"sha1\":\"a1385ce20ad79f55df235effd9780c31442aa234\",\"signer_issuer_name\":\"Microsoft Windows Production PCA 2011\",\"signed_authenticode\":true,\"pe_company_name\":\"Microsoft Corporation\",\"md5\":\"8a0a29438052faed8a2532da50455756\",\"pe_product_version\":\"10.0.17763.1\",\"pe_internal_name\":\"svchost.exe\",\"pe_timestamp\":\"2068-05-10 03:29:03.000\",\"root_serial_number\":\"28cc3a25bfba44ac449a9b586b4339aa\",\"pe_imphash\":\"247B9220E5D9B720A82B2C8B5069AD69\",\"sha256\":\"7fd065bac18c5278777ae44908101cdfed72d26fa741367f0ad4d02020787ab6\",\"root_display_name\":\"Microsoft Root Certificate Authority 2010\",\"pe_file_description\":\"Host Process for Windows Services\",\"root_issuer_name\":\"Microsoft Root Certificate Authority 2010\",\"pe_original_filename\":\"svchost.exe\",\"pe_product_name\":\"Microsoft\u00ae Windows\u00ae Operating System\",\"signed\":true,\"signer_thumbprint\":\"458d803a5cf470dd3f01a475214938d97a5051e8\"},\"fullpath_cmdline\":null},\"job_instance_id\":\"c580fa86-4d9c-4cf0-bebf-24d31fc2ff56\",\"integrity_level\":\"Unknown\",\"item_status\":0,\"agent\":{\"osversion\":\"10.0.17763\",\"domainname\":\"WORKGROUP\",\"agentid\":\"77af54c8-910f-455d-b887-87cbc87430a4\",\"osproducttype\":\"Windows Server 2019 Datacenter\",\"hostname\":\"REDACTED\",\"domain\":null},\"object_type\":\"process\",\"mem_working_set\":7553024,\"critical\":true,\"signature_requested\":true,\"create_time\":\"2021-05-01T07:45:59.848Z\",\"name\":\"svchost.exe\",\"maybe_hollow\":false,\"mem_private_bytes\":1777664,\"ppid\":752,\"status\":\"running\",\"exe\":\"C:\\\\Windows\\\\System32\\\\svchost.exe\"}",
        "event": {
            "dataset": "investigation",
            "kind": "event",
            "type": [
                "info"
            ]
        },
        "agent": {
            "id": "77af54c8-910f-455d-b887-87cbc87430a4",
            "name": "harfanglab"
        },
        "log": {
            "hostname": "REDACTED"
        },
        "host": {
            "hostname": "REDACTED",
            "domain": "WORKGROUP",
            "os": {
                "version": "10.0.17763",
                "full": "Windows Server 2019 Datacenter"
            },
            "name": "REDACTED"
        },
        "file": {
            "path": "C:\\Windows\\System32\\svchost.exe",
            "name": "svchost.exe",
            "hash": {
                "md5": "8a0a29438052faed8a2532da50455756",
                "sha1": "a1385ce20ad79f55df235effd9780c31442aa234",
                "sha256": "7fd065bac18c5278777ae44908101cdfed72d26fa741367f0ad4d02020787ab6"
            },
            "pe": {
                "description": "Host Process for Windows Services",
                "original_file_name": "svchost.exe",
                "file_version": "10.0.17763.1 (WinBuild.160101.0800)",
                "company": "Microsoft Corporation",
                "product": "Microsoft\u00ae Windows\u00ae Operating System",
                "imphash": "247B9220E5D9B720A82B2C8B5069AD69"
            }
        },
        "related": {
            "hash": [
                "7fd065bac18c5278777ae44908101cdfed72d26fa741367f0ad4d02020787ab6",
                "8a0a29438052faed8a2532da50455756",
                "a1385ce20ad79f55df235effd9780c31442aa234"
            ],
            "hosts": [
                "REDACTED"
            ]
        }
    }
    	
	```


=== "network.json"

    ```json
	
    {
        "message": "{\"event_id\":3,\"dport\":2525,\"tenant\":\"\",\"initiated\":\"true\",\"image_name\":\"E:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\Bin\\\\MSExchangeHMWorker.exe\",\"username\":\"NT AUTHORITY\\\\SYSTEM\",\"saddr\":\"192.168.120.41\",\"agent\":{\"distroid\":null,\"agentid\":\"f43cb847-8227-4104-b77f-7fc849789f8e\",\"domainname\":\"EXAMPLE\",\"ostype\":\"windows\",\"hostname\":\"EXCHANGE\",\"osversion\":\"10.0.17763\",\"domain\":null,\"osproducttype\":\"Windows Server 2019 Standard\"},\"is_ipv6\":\"false\",\"sport\":21955,\"pid\":14228,\"direction\":\"out\",\"conn_type\":0,\"daddr\":\"192.168.120.41\",\"@timestamp\":\"2021-11-21T19:38:44.461Z\",\"@version\":\"1\",\"log_type\":\"network\",\"@event_create_date\":\"2021-11-21T19:38:36.820Z\",\"process_unique_id\":\"2d1de721-5d5a-46b2-3794-0097821d2ab7\"}",
        "event": {
            "dataset": "network",
            "category": [
                "network"
            ],
            "type": [
                "connection"
            ],
            "kind": "event"
        },
        "@timestamp": "2021-11-21T19:38:36.820000Z",
        "agent": {
            "id": "f43cb847-8227-4104-b77f-7fc849789f8e",
            "name": "harfanglab"
        },
        "log": {
            "hostname": "EXCHANGE"
        },
        "host": {
            "hostname": "EXCHANGE",
            "domain": "EXAMPLE",
            "os": {
                "version": "10.0.17763",
                "full": "Windows Server 2019 Standard"
            },
            "name": "EXCHANGE"
        },
        "destination": {
            "ip": "192.168.120.41",
            "port": 2525,
            "address": "192.168.120.41"
        },
        "source": {
            "ip": "192.168.120.41",
            "port": 21955,
            "address": "192.168.120.41"
        },
        "process": {
            "pid": 14228,
            "executable": "E:\\Program Files\\Microsoft\\Exchange Server\\V15\\Bin\\MSExchangeHMWorker.exe"
        },
        "user": {
            "name": "NT AUTHORITY\\SYSTEM"
        },
        "related": {
            "hosts": [
                "EXCHANGE"
            ],
            "ip": [
                "192.168.120.41"
            ],
            "user": [
                "NT AUTHORITY\\SYSTEM"
            ]
        }
    }
    	
	```


=== "network2.json"

    ```json
	
    {
        "message": "{\"daddr\":\"172.31.9.222\",\"event_id\":3,\"dport\":3389,\"agent\":{\"osversion\":\"10.0.17763\",\"domainname\":\"WORKGROUP\",\"agentid\":\"d4e3bf36-929d-4ddf-8526-492e89955808\",\"osproducttype\":\"Windows Server 2019 Datacenter\",\"hostname\":\"REDACTED\",\"domain\":null},\"conn_type\":0,\"pid\":1004,\"sport\":42221,\"is_ipv6\":\"false\",\"username\":\"NT AUTHORITY\\\\NETWORK SERVICE\",\"@timestamp\":\"2021-05-01T09:55:44.688Z\",\"@version\":\"1\",\"image_name\":\"C:\\\\Windows\\\\System32\\\\svchost.exe\",\"saddr\":\"185.202.2.238\",\"direction\":\"in\",\"initiated\":\"false\",\"log_type\":\"network\",\"@event_create_date\":\"2021-05-01T09:55:30.372Z\",\"process_unique_id\":\"9aad140d-929d-4ddf-03ec-008c68ef14a0\"}",
        "event": {
            "dataset": "network",
            "category": [
                "network"
            ],
            "type": [
                "connection"
            ],
            "kind": "event"
        },
        "@timestamp": "2021-05-01T09:55:30.372000Z",
        "agent": {
            "id": "d4e3bf36-929d-4ddf-8526-492e89955808",
            "name": "harfanglab"
        },
        "log": {
            "hostname": "REDACTED"
        },
        "host": {
            "hostname": "REDACTED",
            "domain": "WORKGROUP",
            "os": {
                "version": "10.0.17763",
                "full": "Windows Server 2019 Datacenter"
            },
            "name": "REDACTED"
        },
        "destination": {
            "ip": "172.31.9.222",
            "port": 3389,
            "address": "172.31.9.222"
        },
        "source": {
            "ip": "185.202.2.238",
            "port": 42221,
            "address": "185.202.2.238"
        },
        "process": {
            "pid": 1004,
            "executable": "C:\\Windows\\System32\\svchost.exe"
        },
        "user": {
            "name": "NT AUTHORITY\\NETWORK SERVICE"
        },
        "related": {
            "hosts": [
                "REDACTED"
            ],
            "ip": [
                "172.31.9.222",
                "185.202.2.238"
            ],
            "user": [
                "NT AUTHORITY\\NETWORK SERVICE"
            ]
        }
    }
    	
	```


=== "process-event.json"

    ```json
	
    {
        "message": "{\n  \"commandline\": \"C:\\\\windows\\\\system32\\\\cmd.exe /c wmic /namespace:\\\\\\\\root\\\\Microsoft\\\\Windows\\\\Defender path MSFT_MpComputerStatus get /format:list\",\n  \"ppid\": 10420,\n  \"grandparent_commandline\": \"C:\\\\Program Files (x86)\\\\CentraStage\\\\CagServi.exe\",\n  \"usersid\": \"S-1-5-20\",\n  \"fake_ppid\": 0,\n  \"integrity_level\": \"System\",\n  \"parent_commandline\": \"C:\\\\ProgramData\\\\CentraStage\\\\AEMAgent\\\\AEMAge.exe\",\n  \"signature_info\": {\n    \"root_info\": {\n      \"serial_number\": \"28cc3a25bfba44ac449a9b586b4339zz\",\n      \"thumbprint_sha256\": \"df545bf919a2499c36983b54cdfc903dfa4f37d3996d8d84b4c31eec6f3c163e\",\n      \"thumbprint\": \"3b1efd3a66ea99b16697394703a72ca340a05bd5\",\n      \"issuer_name\": \"Microsoft Root Certificate Authority 2012\",\n      \"display_name\": \"Microsoft Root Certificate Authority 2012\"\n    },\n    \"signer_info\": {\n      \"serial_number\": \"330000038db0bfe1b0ca33b3d987500000038d\",\n      \"thumbprint_sha256\": \"555ad75f46a698e6f8fe2f0f2503fb7a7aa25f505c02d9b52755f467a80183a7\",\n      \"thumbprint\": \"d2b3b8f120152efc5415a10dbd7723b0c4531f0b\",\n      \"issuer_name\": \"Microsoft Windows Production PCA 2011\",\n      \"display_name\": \"Microsoft Windows\"\n    },\n    \"signed_authenticode\": false,\n    \"signed_catalog\": true\n  },\n  \"pe_imphash\": \"272875E2988E1E430500B852C4FB5E18\",\n  \"process_name\": \"cmd.exe\",\n  \"grandparent_integrity_level\": \"System\",\n  \"pe_timestamp_int\": 3788242003,\n  \"groups\": [\n    {\n      \"name\": \"Group 1\",\n      \"id\": \"16314dd0-e911-4350-bd96-8363a69d33c9\"\n    }\n  ],\n  \"@Version\": \"1\",\n  \"session\": 0,\n  \"@event_create_date\": \"2023-02-20T14:48:58.984Z\",\n  \"log_type\": \"process\",\n  \"signed\": true,\n  \"image_name\": \"C:\\\\Windows\\\\System32\\\\cmd.exe\",\n  \"fake_parent_commandline\": \"\",\n  \"@timestamp\": \"2023-02-20T14:50:04.011333Z\",\n  \"parent_unique_id\": \"572c3308-18a0-4435-8fa4-e02e909cd099\",\n  \"event\": {\n    \"original\": \"{\\\"commandline\\\":\\\"C:\\\\\\\\windows\\\\\\\\system32\\\\\\\\cmd.exe /c wmic /namespace:\\\\\\\\\\\\\\\\root\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\Defender path LDKD_MpComputerStatus get /format:list\\\",\\\"create_time\\\":\\\"2023/04/20 14:48:58.984\\\",\\\"current_directory\\\":\\\"C:\\\\\\\\ProgramData\\\\\\\\CentraStage\\\\\\\\AEMAge\\\\\\\\\\\",\\\"hashes\\\":{\\\"md5\\\":\\\"8a2122e8554dbef04694b9c3e0b6cdee\\\",\\\"sha1\\\":\\\"f1efb0fddc665e4c61c5f78a54700e4e7984d55d\\\",\\\"sha256\\\":\\\"b99d61d874728edc0918ca0eb10eab93d381e4456e377406e65963366c874450\\\"},\\\"image_name\\\":\\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\cmd.exe\\\",\\\"log_type\\\":\\\"process\\\",\\\"parent_commandline\\\":\\\"C:\\\\\\\\ProgramData\\\\\\\\CentraStage\\\\\\\\AEMAge\\\\\\\\AEMAge.exe\\\",\\\"parent_image\\\":\\\"C:\\\\\\\\ProgramData\\\\\\\\CentraStage\\\\\\\\AEMAgent\\\\\\\\AEMAge.exe\\\",\\\"parent_unique_id\\\":\\\"572c3308-18a0-4435-8fa4-e02e909cd099\\\",\\\"pid\\\":13824,\\\"ppid\\\":10547,\\\"process_name\\\":\\\"cmd.exe\\\",\\\"process_unique_id\\\":\\\"43c20ef1-03c4-4af5-0036-00d767b57302\\\",\\\"size\\\":289792,\\\"username\\\":\\\"NT AUTHORITY\\\\\\\\SYSTEM\\\",\\\"grandparent_image\\\":\\\"C:\\\\\\\\Program Files (x86)\\\\\\\\Centrage\\\\\\\\CagSer.exe\\\",\\\"grandparent_commandline\\\":\\\"C:\\\\\\\\Program Files (x86)\\\\\\\\Centra\\\\\\\\CagServ.exe\\\",\\\"usersid\\\":\\\"S-1-5-87\\\",\\\"integrity_level\\\":\\\"System\\\",\\\"session\\\":0,\\\"logonid\\\":999,\\\"parent_integrity_level\\\":\\\"System\\\",\\\"grandparent_integrity_level\\\":\\\"System\\\",\\\"fake_ppid\\\":0,\\\"fake_parent_image\\\":\\\"\\\",\\\"fake_parent_commandline\\\":\\\"\\\",\\\"pe_info\\\":{\\\"company_name\\\":\\\"Microsoft Corporation\\\",\\\"file_description\\\":\\\"Windows Command Processor\\\",\\\"file_version\\\":\\\"10.0.19041.746 (WinBuild.160101.0800)\\\",\\\"internal_name\\\":\\\"cmd\\\",\\\"legal_copyright\\\":\\\"\u00a9 Microsoft Corporation. All rights reserved.\\\",\\\"original_filename\\\":\\\"Cmd.Exe\\\",\\\"pe_timestamp\\\":\\\"2090-01-16 09:26:43.000\\\",\\\"product_name\\\":\\\"Microsoft\u00ae Windows\u00ae Operating System\\\",\\\"product_version\\\":\\\"10.0.19041.746\\\"},\\\"signed\\\":true,\\\"signature_info\\\":{\\\"signer_info\\\":{\\\"serial_number\\\":\\\"330000038db0bfe1b0ca33b3d400000058748d\\\",\\\"thumbprint\\\":\\\"d2b3b8f124652efc5415a10dbd7723b0c9542f0b\\\",\\\"thumbprint_sha256\\\":\\\"974ad75f46a698e6f8fe2f0f2503fb7a7aa61f505c02d9b52755f467a80183a7\\\",\\\"issuer_name\\\":\\\"Microsoft Windows Production PCA 2011\\\",\\\"display_name\\\":\\\"Microsoft Windows\\\"},\\\"root_info\\\":{\\\"serial_number\\\":\\\"28cc3a25bfba44ac449a9b586b4024aa\\\",\\\"thumbprint\\\":\\\"3b1efd3a66ea28b16697394703a72ca965a05bd5\\\",\\\"thumbprint_sha256\\\":\\\"df545bf014a2439c36983b54cdfc903dfa4f37d3741d8d84b4c31eec6f3c163e\\\",\\\"issuer_name\\\":\\\"Microsoft Root Certificate Authority 2012\\\",\\\"display_name\\\":\\\"Microsoft Root Certificate Authority 2010\\\"},\\\"signed_authenticode\\\":false,\\\"signed_catalog\\\":true},\\\"pe_timestamp_int\\\":3788242003,\\\"pe_timestamp\\\":\\\"2090-01-16 09:26:43.000\\\",\\\"pe_imphash\\\":\\\"272245E2988E1E430500B852C4FB5E99\\\",\\\"log_platform_flag\\\":0,\\\"groups\\\":[{\\\"id\\\":\\\"572c3308-18a0-4435-8fa4-e02e909cd099\\\",\\\"name\\\":\\\"Group 1\\\"}],\\\"agent\\\":{\\\"agentid\\\":\\\"7bba20c2-03c4-4af5-9b27-9e7aab902c85\\\",\\\"hostname\\\":\\\"SFRTAOA\\\",\\\"domain\\\":null,\\\"domainname\\\":\\\"EXAMPLE\\\",\\\"dnsdomainname\\\":\\\"example.org\\\",\\\"ostype\\\":\\\"windows\\\",\\\"osversion\\\":\\\"9.0.19544\\\",\\\"distroid\\\":null,\\\"osproducttype\\\":\\\"Windows 10 Pro\\\",\\\"version\\\":\\\"2.25.4-posy4\\\",\\\"additional_info\\\":null}}\"\n  },\n  \"parent_integrity_level\": \"System\",\n  \"pid\": 13824,\n  \"grandparent_image\": \"C:\\\\Program Files (x86)\\\\Centra\\\\CagServ.exe\",\n  \"hashes\": {\n    \"md5\": \"8a2122e8162dbef04620b9c3e0b6cdee\",\n    \"sha1\": \"f1efb0fddc156e4c61c5f89a54700e4e7984d55d\",\n    \"sha256\": \"b99d74d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450\"\n  },\n  \"log_platform_flag\": 0,\n  \"tenant\": \"0198bff0ef04d4a8\",\n  \"size\": 289792,\n  \"username\": \"NT AUTHORITY\\\\SYSTEM\",\n  \"agent\": {\n    \"hostname\": \"SFRTAOA\",\n    \"osversion\": \"10.0.19044\",\n    \"version\": \"2.25.4-post0\",\n    \"domainname\": \"EXAMPLE\",\n    \"distroid\": null,\n    \"additional_info\": null,\n    \"agentid\": \"7bba20c2-03c4-4af5-9b27-9e7aab977c85\",\n    \"osproducttype\": \"Windows 10 Pro\",\n    \"dnsdomainname\": \"example.org\",\n    \"ostype\": \"windows\",\n    \"domain\": null\n  },\n  \"parent_image\": \"C:\\\\ProgramData\\\\Centra\\\\AEMAge\\\\AEMAge.exe\",\n  \"pe_timestamp\": \"2090-01-16T09:26:43.000Z\",\n  \"logonid\": 545,\n  \"fake_parent_image\": \"\",\n  \"process_unique_id\": \"653d2616-2068-48fa-9f89-83e4e546d8e5\",\n  \"pe_info\": {\n    \"legal_copyright\": \"\u00a9 Microsoft Corporation. All rights reserved.\",\n    \"company_name\": \"Microsoft Corporation\",\n    \"original_filename\": \"Cmd.Exe\",\n    \"pe_timestamp\": \"2090-01-16T09:26:43.000Z\",\n    \"product_name\": \"Microsoft\u00ae Windows\u00ae Operating System\",\n    \"product_version\": \"10.0.19041.746\",\n    \"internal_name\": \"cmd\",\n    \"file_description\": \"Windows Command Processor\",\n    \"file_version\": \"10.0.19041.746 (WinBuild.160101.0800)\"\n  },\n  \"current_directory\": \"C:\\\\ProgramData\\\\CentraStage\\\\AEMAgent\\\\\"\n}",
        "event": {
            "dataset": "process",
            "category": [
                "process"
            ],
            "type": [
                "start"
            ],
            "kind": "event"
        },
        "@timestamp": "2023-02-20T14:48:58.984000Z",
        "agent": {
            "id": "7bba20c2-03c4-4af5-9b27-9e7aab977c85",
            "name": "harfanglab"
        },
        "log": {
            "hostname": "SFRTAOA"
        },
        "host": {
            "hostname": "SFRTAOA",
            "domain": "EXAMPLE",
            "os": {
                "version": "10.0.19044",
                "full": "Windows 10 Pro"
            },
            "name": "SFRTAOA"
        },
        "harfanglab": {
            "groups": [
                "{\"id\": \"16314dd0-e911-4350-bd96-8363a69d33c9\", \"name\": \"Group 1\"}"
            ]
        },
        "user": {
            "roles": "Group1",
            "name": "NT AUTHORITY\\SYSTEM"
        },
        "process": {
            "command_line": "C:\\windows\\system32\\cmd.exe /c wmic /namespace:\\\\root\\Microsoft\\Windows\\Defender path MSFT_MpComputerStatus get /format:list",
            "pid": 13824,
            "name": "cmd.exe",
            "pe": {
                "description": "Windows Command Processor",
                "original_file_name": "Cmd.Exe",
                "file_version": "10.0.19041.746 (WinBuild.160101.0800)",
                "company": "Microsoft Corporation",
                "product": "Microsoft\u00ae Windows\u00ae Operating System",
                "imphash": "272875E2988E1E430500B852C4FB5E18"
            },
            "executable": "C:\\Windows\\System32\\cmd.exe",
            "parent": {
                "executable": "C:\\ProgramData\\Centra\\AEMAge\\AEMAge.exe",
                "command_line": "C:\\ProgramData\\CentraStage\\AEMAgent\\AEMAge.exe",
                "name": "AEMAge.exe"
            },
            "working_directory": "C:\\ProgramData\\CentraStage\\AEMAgent\\"
        },
        "file": {
            "hash": {
                "md5": "8a2122e8162dbef04620b9c3e0b6cdee",
                "sha256": "b99d74d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450",
                "sha1": "f1efb0fddc156e4c61c5f89a54700e4e7984d55d"
            }
        },
        "related": {
            "hash": [
                "8a2122e8162dbef04620b9c3e0b6cdee",
                "b99d74d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450",
                "f1efb0fddc156e4c61c5f89a54700e4e7984d55d"
            ],
            "hosts": [
                "SFRTAOA"
            ],
            "user": [
                "NT AUTHORITY\\SYSTEM"
            ]
        }
    }
    	
	```


=== "process.json"

    ```json
	
    {
        "message": "{\"tenant\":\"\",\"usersid\":\"S-1-5-18\",\"hashes\":{\"sha256\":\"100af46c952e58105dbc51eb92510f6990377a3ffc57e82074a8bfb64c56c529\",\"md5\":\"4c7a9a333afb2b0896b4e8a948e58b79\",\"sha1\":\"948febd5456420916256fcc94e3ed19aafe5390b\"},\"status_msg\":\"\",\"username\":\"NT AUTHORITY\\\\SYSTEM\",\"agent\":{\"distroid\":null,\"agentid\":\"f43cb847-8227-4104-b77f-7fc849789f8e\",\"domainname\":\"NIVURA\",\"ostype\":\"windows\",\"hostname\":\"EXCHANGE\",\"osversion\":\"10.0.17763\",\"domain\":null,\"osproducttype\":\"Windows Server 2019 Standard\"},\"status\":0,\"fake_ppid\":null,\"integrity_level\":\"System\",\"signed\":true,\"signature_info\":{\"signed_catalog\":true,\"signer_info\":{\"display_name\":\"Microsoft Windows\",\"issuer_name\":\"Microsoft Windows Production PCA 2011\",\"serial_number\":\"33000002ed2c45e4c145cf48440000000002ed\",\"thumbprint\":\"312860d2047eb81f8f58c29ff19ecdb4c634cf6a\"},\"root_info\":{\"display_name\":\"Microsoft Root Certificate Authority 2010\",\"issuer_name\":\"Microsoft Root Certificate Authority 2010\",\"serial_number\":\"28cc3a25bfba44ac449a9b586b4339aa\",\"thumbprint\":\"3b1efd3a66ea28b16697394703a72ca340a05bd5\"},\"signed_authenticode\":false},\"parent_commandline\":\"E:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\Bin\\\\Microsoft.Exchange.Diagnostics.Service.exe\",\"@timestamp\":\"2021-11-21T20:03:15.736Z\",\"parent_image\":\"E:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\Bin\\\\Microsoft.Exchange.Diagnostics.Service.exe\",\"log_type\":\"process\",\"current_directory\":\"C:\\\\Windows\\\\system32\",\"pe_imphash\":\"6043170F48FA2A2802231975BB43BBDA\",\"process_unique_id\":\"2d1de721-5d5a-46b2-5ae8-00feb4cdcf56\",\"size\":53760,\"log_platform_flag\":0,\"commandline\":\"relog.exe E:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\Logging\\\\Diagnostics\\\\PerformanceLogsToBeProcessed\\\\ExchangeDiagnosticsPerformanceLog_11212058.blg -f csv -o E:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\Logging\\\\Diagnostics\\\\PerformanceLogsToBeProcessed\\\\ExchangeDiagnosticsPerformanceLog_11212058.csvtmp -y\",\"session\":0,\"process_name\":\"relog.exe\",\"image_name\":\"C:\\\\Windows\\\\System32\\\\relog.exe\",\"parent_integrity_level\":\"System\",\"fake_parent_commandline\":null,\"pe_timestamp_int\":2652523548,\"error_msg\":\"\",\"parent_unique_id\":\"2d1de721-5d5a-46b2-0c78-009ac6cf01ea\",\"pid\":23272,\"ppid\":3192,\"fake_parent_image\":null,\"@event_create_date\":\"2021-11-21T20:03:08.226Z\",\"@version\":\"1\",\"pe_timestamp\":\"2054-01-20T12:05:48.000Z\",\"fake_parent_unique_id\":null,\"pe_info\":{\"product_version\":\"10.0.17763.1\",\"company_name\":\"Microsoft Corporation\",\"product_name\":\"Microsoft\u00ae Windows\u00ae Operating System\",\"internal_name\":\"Relog.exe\",\"file_description\":\"Performance Relogging Utility\",\"legal_copyright\":\"\u00a9 Microsoft Corporation. All rights reserved.\",\"file_version\":\"10.0.17763.1 (WinBuild.160101.0800)\",\"original_filename\":\"Relog.exe\"},\"logonid\":999}",
        "event": {
            "dataset": "process",
            "category": [
                "process"
            ],
            "type": [
                "start"
            ],
            "kind": "event"
        },
        "@timestamp": "2021-11-21T20:03:08.226000Z",
        "agent": {
            "id": "f43cb847-8227-4104-b77f-7fc849789f8e",
            "name": "harfanglab"
        },
        "log": {
            "hostname": "EXCHANGE"
        },
        "host": {
            "hostname": "EXCHANGE",
            "domain": "NIVURA",
            "os": {
                "version": "10.0.17763",
                "full": "Windows Server 2019 Standard"
            },
            "name": "EXCHANGE"
        },
        "process": {
            "command_line": "relog.exe E:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\Diagnostics\\PerformanceLogsToBeProcessed\\ExchangeDiagnosticsPerformanceLog_11212058.blg -f csv -o E:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\Diagnostics\\PerformanceLogsToBeProcessed\\ExchangeDiagnosticsPerformanceLog_11212058.csvtmp -y",
            "pid": 23272,
            "name": "relog.exe",
            "pe": {
                "description": "Performance Relogging Utility",
                "original_file_name": "Relog.exe",
                "file_version": "10.0.17763.1 (WinBuild.160101.0800)",
                "company": "Microsoft Corporation",
                "product": "Microsoft\u00ae Windows\u00ae Operating System",
                "imphash": "6043170F48FA2A2802231975BB43BBDA"
            },
            "executable": "C:\\Windows\\System32\\relog.exe",
            "parent": {
                "executable": "E:\\Program Files\\Microsoft\\Exchange Server\\V15\\Bin\\Microsoft.Exchange.Diagnostics.Service.exe",
                "command_line": "E:\\Program Files\\Microsoft\\Exchange Server\\V15\\Bin\\Microsoft.Exchange.Diagnostics.Service.exe",
                "name": "Microsoft.Exchange.Diagnostics.Service.exe"
            },
            "working_directory": "C:\\Windows\\system32"
        },
        "user": {
            "name": "NT AUTHORITY\\SYSTEM"
        },
        "file": {
            "hash": {
                "md5": "4c7a9a333afb2b0896b4e8a948e58b79",
                "sha256": "100af46c952e58105dbc51eb92510f6990377a3ffc57e82074a8bfb64c56c529",
                "sha1": "948febd5456420916256fcc94e3ed19aafe5390b"
            }
        },
        "related": {
            "hash": [
                "100af46c952e58105dbc51eb92510f6990377a3ffc57e82074a8bfb64c56c529",
                "4c7a9a333afb2b0896b4e8a948e58b79",
                "948febd5456420916256fcc94e3ed19aafe5390b"
            ],
            "hosts": [
                "EXCHANGE"
            ],
            "user": [
                "NT AUTHORITY\\SYSTEM"
            ]
        }
    }
    	
	```


=== "process2.json"

    ```json
	
    {
        "message": "{\n  \"@version\": \"1\",\n  \"agent\": {\n    \"agentid\": \"00000000-0000-0000-0000-000000000000\",\n    \"distroid\": null,\n    \"domainname\": \"domain123\",\n    \"ostype\": \"windows\",\n    \"hostname\": \"pc123\",\n    \"osversion\": \"10.0.19041\",\n    \"osproducttype\": \"Windows 10 Pro\",\n    \"domain\": null,\n    \"version\": \"2.12.6\"\n  },\n  \"type\": \"rtlogs\",\n  \"alert_subtype\": \"process\",\n  \"log_type\": \"alert\",\n  \"detection_origin\": \"agent\",\n  \"tenant\": \"\",\n  \"alert_time\": \"2022-03-15T07:26:01.276+00:00\",\n  \"alert_type\": \"sigma\",\n  \"status\": \"false_positive\",\n  \"rule_id\": \"00000000-0000-0000-0000-000000000000\",\n  \"@event_create_date\": \"2022-03-15T07:26:01.276Z\",\n  \"alert_unique_id\": \"00000000-0000-0000-0000-000000000000\",\n  \"level\": \"low\",\n  \"aggregation_key\": \"123456\",\n  \"@timestamp\": \"2022-03-15T07:26:01.311Z\",\n  \"tags\": [\n    \"attack.discovery\",\n    \"attack.t1057\",\n    \"attack.s0057\"\n  ],\n  \"process\": {\n    \"detection_timestamp\": \"2022/03/15 07:24:54.438105\",\n    \"process_unique_id\": \"00000000-0000-0000-0000-000000000000\",\n    \"parent_integrity_level\": \"Medium\",\n    \"log_platform_flag\": 0,\n    \"fake_parent_image\": null,\n    \"pid\": 11320,\n    \"image_name\": \"C:\\\\Windows\\\\SysWOW64\\\\tasklist.exe\",\n    \"username\": \"XXX\\\\XXX\",\n    \"logonid\": 151210562,\n    \"signature_info\": {\n      \"signed_authenticode\": false,\n      \"signed_catalog\": true,\n      \"root_info\": {\n        \"thumbprint\": \"3b1efd3a66ea28b16697394703a72ca340a05bd5\",\n        \"display_name\": \"Microsoft Root Certificate Authority 2010\",\n        \"serial_number\": \"28cc3a25bfba44ac449a9b586b4339aa\",\n        \"issuer_name\": \"Microsoft Root Certificate Authority 2010\"\n      },\n      \"signer_info\": {\n        \"thumbprint\": \"f7c2f2c96a328c13cda8cdb57b715bdea2cbd1d9\",\n        \"display_name\": \"Microsoft Windows\",\n        \"serial_number\": \"33000002ec6579ad1e670890130000000002ec\",\n        \"issuer_name\": \"Microsoft Windows Production PCA 2011\"\n      }\n    },\n    \"current_directory\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\",\n    \"error_msg\": \"\",\n    \"status_msg\": \"sigma match detected this process but not configured to block it\",\n    \"ppid\": 17808,\n    \"fake_parent_commandline\": null,\n    \"commandline\": \"tasklist\",\n    \"signed\": true,\n    \"grandparent_integrity_level\": \"Medium\",\n    \"log_type\": \"process\",\n    \"pe_imphash\": \"19BBD9C4E73C288A3645E163F4B82682\",\n    \"create_time\": \"2022-03-15T07:24:54.260Z\",\n    \"status\": 0,\n    \"parent_image\": \"C:\\\\Windows\\\\SysWOW64\\\\cmd.exe\",\n    \"integrity_level\": \"Medium\",\n    \"usersid\": \"S-1-5-21-299502267-725345543-82448378-2366\",\n    \"pe_info\": {\n      \"product_version\": \"10.0.19041.1\",\n      \"legal_copyright\": \"\u00a9 Microsoft Corporation. All rights reserved.\",\n      \"original_filename\": \"tasklist.exe\",\n      \"company_name\": \"Microsoft Corporation\",\n      \"file_description\": \"Lists the current running tasks\",\n      \"file_version\": \"10.0.19041.1 (WinBuild.160101.0800)\",\n      \"internal_name\": \"tasklist.exe\",\n      \"product_name\": \"Microsoft\u00ae Windows\u00ae Operating System\"\n    },\n    \"session\": 3,\n    \"pe_timestamp\": \"1994-09-11T16:43:21.000Z\",\n    \"parent_unique_id\": \"2332edf8-70c0-43c2-4590-00f912ab3d18\",\n    \"process_name\": \"tasklist.exe\",\n    \"grandparent_commandline\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\\\\EPOSConnect.exe 1\",\n    \"pe_timestamp_int\": 779301801,\n    \"grandparent_image\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\\\\EPOSConnect.exe\",\n    \"parent_commandline\": \"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /d /s /c tasklist\",\n    \"fake_parent_unique_id\": null,\n    \"size\": 79360,\n    \"fake_ppid\": null,\n    \"hashes\": {\n      \"sha1\": \"7f50d8c3cf3ec79122a876e969bdb65d939becd0\",\n      \"sha256\": \"76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4\",\n      \"md5\": \"0a4448b31ce7f83cb7691a2657f330f1\"\n    }\n  },\n  \"execution\": 0,\n  \"rule_name\": \"Discovery: Process list\",\n  \"maturity\": \"stable\",\n  \"msg\": \"Detects the execution of tasklist.exe, a tool used to gather detailed information about a computer's active processes.\"\n}\n",
        "event": {
            "dataset": "alert",
            "category": [
                "process"
            ],
            "type": [
                "start"
            ],
            "kind": "alert"
        },
        "@timestamp": "2022-03-15T07:26:01.276000Z",
        "agent": {
            "id": "00000000-0000-0000-0000-000000000000",
            "name": "harfanglab"
        },
        "log": {
            "hostname": "pc123"
        },
        "host": {
            "hostname": "pc123",
            "domain": "domain123",
            "os": {
                "version": "10.0.19041",
                "full": "Windows 10 Pro"
            },
            "name": "pc123"
        },
        "harfanglab": {
            "level": "low",
            "alert_time": "2022-03-15T07:26:01.276+00:00",
            "alert_unique_id": "00000000-0000-0000-0000-000000000000",
            "alert_subtype": "process",
            "execution": 0,
            "status": "false_positive",
            "aggregation_key": "123456"
        },
        "rule": {
            "description": "Detects the execution of tasklist.exe, a tool used to gather detailed information about a computer's active processes.",
            "name": "Discovery: Process list",
            "category": "sigma",
            "id": "00000000-0000-0000-0000-000000000000"
        },
        "process": {
            "command_line": "tasklist",
            "pid": 11320,
            "name": "tasklist.exe",
            "pe": {
                "description": "Lists the current running tasks",
                "original_file_name": "tasklist.exe",
                "file_version": "10.0.19041.1 (WinBuild.160101.0800)",
                "company": "Microsoft Corporation",
                "product": "Microsoft\u00ae Windows\u00ae Operating System",
                "imphash": "19BBD9C4E73C288A3645E163F4B82682"
            },
            "executable": "C:\\Windows\\SysWOW64\\tasklist.exe",
            "parent": {
                "executable": "C:\\Windows\\SysWOW64\\cmd.exe",
                "command_line": "C:\\WINDOWS\\system32\\cmd.exe /d /s /c tasklist"
            },
            "working_directory": "C:\\Program Files (x86)\\EPOS\\EPOS Connect"
        },
        "user": {
            "name": "XXX\\XXX"
        },
        "file": {
            "hash": {
                "md5": "0a4448b31ce7f83cb7691a2657f330f1",
                "sha256": "76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4",
                "sha1": "7f50d8c3cf3ec79122a876e969bdb65d939becd0"
            }
        },
        "related": {
            "hash": [
                "0a4448b31ce7f83cb7691a2657f330f1",
                "76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4",
                "7f50d8c3cf3ec79122a876e969bdb65d939becd0"
            ],
            "hosts": [
                "pc123"
            ],
            "user": [
                "XXX\\XXX"
            ]
        }
    }
    	
	```


=== "process3.json"

    ```json
	
    {
        "message": "{\"signature_info\":{\"root_info\":{\"display_name\":\"Microsoft Root Certificate Authority 2010\",\"thumbprint\":\"3b1efd3a66ea28b16697394703a72ca340a05bd5\",\"serial_number\":\"28cc3a25bfba44ac449a9b586b4339aa\",\"issuer_name\":\"Microsoft Root Certificate Authority 2010\"},\"signed_catalog\":true,\"signer_info\":{\"display_name\":\"Microsoft Windows\",\"thumbprint\":\"ae9c1ae54763822eec42474983d8b635116c8452\",\"serial_number\":\"33000001c422b2f79b793dacb20000000001c4\",\"issuer_name\":\"Microsoft Windows Production PCA 2011\"},\"signed_authenticode\":false},\"commandline\":\"C:\\\\Windows\\\\system32\\\\wbem\\\\wmiprvse.exe -secured -Embedding\",\"fake_parent_commandline\":null,\"session\":0,\"pid\":4028,\"process_name\":\"WmiPrvSE.exe\",\"pe_info\":{\"product_version\":\"10.0.17763.1\",\"file_description\":\"WMI Provider Host\",\"original_filename\":\"Wmiprvse.exe\",\"internal_name\":\"Wmiprvse.exe\",\"file_version\":\"10.0.17763.1 (WinBuild.160101.0800)\",\"company_name\":\"Microsoft Corporation\",\"legal_copyright\":\"\u00a9 Microsoft Corporation. All rights reserved.\",\"product_name\":\"Microsoft\u00ae Windows\u00ae Operating System\"},\"fake_parent_image\":null,\"@timestamp\":\"2021-05-02T19:52:34.492Z\",\"username\":\"NT AUTHORITY\\\\NETWORK SERVICE\",\"pe_timestamp_int\":3717952540,\"@version\":\"1\",\"image_name\":\"C:\\\\Windows\\\\System32\\\\wbem\\\\WmiPrvSE.exe\",\"parent_integrity_level\":\"System\",\"fake_parent_unique_id\":null,\"status_msg\":\"\",\"log_type\":\"process\",\"logonid\":996,\"process_unique_id\":\"9aad140d-929d-4ddf-0fbc-006fa79b94af\",\"usersid\":\"S-1-5-20\",\"error_msg\":\"\",\"parent_image\":\"C:\\\\Windows\\\\System32\\\\svchost.exe\",\"fake_ppid\":null,\"integrity_level\":\"System\",\"agent\":{\"osversion\":\"10.0.17763\",\"domainname\":\"WORKGROUP\",\"agentid\":\"d4e3bf36-929d-4ddf-8526-492e89955808\",\"osproducttype\":\"Windows Server 2019 Datacenter\",\"hostname\":\"REDACTED\",\"domain\":null},\"current_directory\":\"C:\\\\Windows\\\\system32\",\"pe_timestamp\":\"2087-10-25T20:35:40.000Z\",\"parent_unique_id\":\"9aad140d-929d-4ddf-0358-002a32b395aa\",\"pe_imphash\":\"CFECEDC01015A4FD1BAACAC9E592D88B\",\"hashes\":{\"md5\":\"06c66ff5ccdc2d22344a3eb761a4d38a\",\"sha256\":\"b5c78bef3883e3099f7ef844da1446db29107e5c0223b97f29e7fafab5527f15\",\"sha1\":\"67c25c8f28b5fa7f5baa85bf1d2726aed48e9cf0\"},\"size\":489472,\"parent_commandline\":\"C:\\\\Windows\\\\system32\\\\svchost.exe -k DcomLaunch -p\",\"@event_create_date\":\"2021-05-02T19:52:24.083Z\",\"signed\":true,\"ppid\":856,\"status\":0}",
        "event": {
            "dataset": "process",
            "category": [
                "process"
            ],
            "type": [
                "start"
            ],
            "kind": "event"
        },
        "@timestamp": "2021-05-02T19:52:24.083000Z",
        "agent": {
            "id": "d4e3bf36-929d-4ddf-8526-492e89955808",
            "name": "harfanglab"
        },
        "log": {
            "hostname": "REDACTED"
        },
        "host": {
            "hostname": "REDACTED",
            "domain": "WORKGROUP",
            "os": {
                "version": "10.0.17763",
                "full": "Windows Server 2019 Datacenter"
            },
            "name": "REDACTED"
        },
        "process": {
            "command_line": "C:\\Windows\\system32\\wbem\\wmiprvse.exe -secured -Embedding",
            "pid": 4028,
            "name": "WmiPrvSE.exe",
            "pe": {
                "description": "WMI Provider Host",
                "original_file_name": "Wmiprvse.exe",
                "file_version": "10.0.17763.1 (WinBuild.160101.0800)",
                "company": "Microsoft Corporation",
                "product": "Microsoft\u00ae Windows\u00ae Operating System",
                "imphash": "CFECEDC01015A4FD1BAACAC9E592D88B"
            },
            "executable": "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe",
            "parent": {
                "executable": "C:\\Windows\\System32\\svchost.exe",
                "command_line": "C:\\Windows\\system32\\svchost.exe -k DcomLaunch -p",
                "name": "svchost.exe"
            },
            "working_directory": "C:\\Windows\\system32"
        },
        "user": {
            "name": "NT AUTHORITY\\NETWORK SERVICE"
        },
        "file": {
            "hash": {
                "md5": "06c66ff5ccdc2d22344a3eb761a4d38a",
                "sha256": "b5c78bef3883e3099f7ef844da1446db29107e5c0223b97f29e7fafab5527f15",
                "sha1": "67c25c8f28b5fa7f5baa85bf1d2726aed48e9cf0"
            }
        },
        "related": {
            "hash": [
                "06c66ff5ccdc2d22344a3eb761a4d38a",
                "67c25c8f28b5fa7f5baa85bf1d2726aed48e9cf0",
                "b5c78bef3883e3099f7ef844da1446db29107e5c0223b97f29e7fafab5527f15"
            ],
            "hosts": [
                "REDACTED"
            ],
            "user": [
                "NT AUTHORITY\\NETWORK SERVICE"
            ]
        }
    }
    	
	```


=== "test_bug.json"

    ```json
	
    {
        "message": "{\n  \"user_data\": {},\n  \"@timestamp\": \"2023-05-16T08:45:22.407186Z\",\n  \"process_id\": 0,\n  \"@event_create_date\": \"2023-05-16T08:46:54.000Z\",\n  \"type\": \"wineventlog\",\n  \"source_name\": \"Windows Error Reporting\",\n  \"thread_id\": 0,\n  \"event\": {\n    \"original\": \"{\\\"computer_name\\\":\\\"SARTE03.example.org\\\",\\\"event_date\\\":\\\"2023/05/16 08:46:54.000\\\",\\\"event_id\\\":1001,\\\"keywords\\\":[\\\"EventlogClassic\\\"],\\\"level\\\":\\\"INFORMATION\\\",\\\"log_name\\\":\\\"Application\\\",\\\"log_type\\\":\\\"eventlog\\\",\\\"type\\\":\\\"wineventlog\\\",\\\"user\\\":{\\\"domain\\\":\\\"\\\",\\\"identifier\\\":\\\"\\\",\\\"name\\\":\\\"\\\",\\\"type\\\":\\\"unknown\\\"},\\\"event_data\\\":{\\\"param7\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"param10\\\":\\\"0\\\",\\\"param12\\\":\\\"AutomaticUpdates\\\",\\\"param0\\\":\\\"\\\",\\\"param16\\\":\\\"\\\",\\\"param4\\\":\\\"0\\\",\\\"param8\\\":\\\"Scan\\\",\\\"param13\\\":\\\"{581473F3-A4DC-4D00-8245-D203EAA9B5A9}\\\",\\\"param15\\\":\\\"C:\\\\\\\\Windows\\\\\\\\WindowsUpdate.log\\\\r\\\\nC:\\\\\\\\Windows\\\\\\\\SoftwareDistribution\\\\\\\\ReportingEvents.log\\\",\\\"param9\\\":\\\"0\\\",\\\"param11\\\":\\\"8024500b\\\",\\\"param20\\\":\\\"262144\\\",\\\"param6\\\":\\\"80072ee2\\\",\\\"param2\\\":\\\"WindowsUpdateFailure3\\\",\\\"param3\\\":\\\"Non disponible\\\",\\\"param21\\\":\\\"\\\",\\\"param1\\\":\\\"0\\\",\\\"param17\\\":\\\"\\\",\\\"param18\\\":\\\"0\\\",\\\"param14\\\":\\\"0\\\",\\\"param5\\\":\\\"7.9.9600.19915\\\",\\\"param19\\\":\\\"3e7b694e-4cf1-45cc-93ff-f30da6e8f683\\\"},\\\"process_id\\\":0,\\\"record_number\\\":26500965,\\\"source_name\\\":\\\"Windows Error Reporting\\\",\\\"thread_id\\\":0,\\\"user_data\\\":{},\\\"groups\\\":[{\\\"id\\\":\\\"bced64f1-9d22-4001-9425-604e45a14d66\\\",\\\"name\\\":\\\"Group 1\\\"}],\\\"destination\\\":\\\"syslog\\\",\\\"agent\\\":{\\\"agentid\\\":\\\"adbd57f0-3bf7-4b33-9845-eb489b1b0eea\\\",\\\"hostname\\\":\\\"SARTE03\\\",\\\"domain\\\":null,\\\"domainname\\\":\\\"EXA_0342\\\",\\\"dnsdomainname\\\":\\\"ipline.ovh\\\",\\\"ostype\\\":\\\"windows\\\",\\\"osversion\\\":\\\"6.3.9600\\\",\\\"distroid\\\":null,\\\"osproducttype\\\":\\\"Windows Server 2012 R2 Standard\\\",\\\"version\\\":\\\"2.25.13-post0\\\",\\\"additional_info\\\":null}}\"\n  },\n  \"event_data\": {\n    \"param11\": \"8024500b\",\n    \"param8\": \"Scan\",\n    \"param7\": \"00000000-0000-0000-0000-000000000000\",\n    \"param12\": \"AutomaticUpdates\",\n    \"param13\": \"{581473F3-A4DC-4D00-8245-D203EAA9B5A9}\",\n    \"param18\": \"0\",\n    \"param16\": \"\",\n    \"param1\": \"0\",\n    \"param17\": \"\",\n    \"param0\": \"\",\n    \"param4\": \"0\",\n    \"param10\": \"0\",\n    \"param19\": \"3e7b694e-4cf1-45cc-93ff-f30da6e8f683\",\n    \"param15\": \"C:\\\\Windows\\\\WindowsUpdate.log\\r\\nC:\\\\Windows\\\\SoftwareDistribution\\\\ReportingEvents.log\",\n    \"param20\": \"262144\",\n    \"param2\": \"WindowsUpdateFailure3\",\n    \"param21\": \"\",\n    \"param14\": \"0\",\n    \"param5\": \"7.9.9600.19915\",\n    \"param9\": \"0\",\n    \"param6\": \"80072ee2\",\n    \"param3\": \"Non disponible\"\n  },\n  \"@version\": \"1\",\n  \"keywords\": [\n    \"EventlogClassic\"\n  ],\n  \"destination\": \"syslog\",\n  \"log_name\": \"Application\",\n  \"log_type\": \"eventlog\",\n  \"user\": {\n    \"name\": \"\",\n    \"domain\": \"\",\n    \"identifier\": \"\",\n    \"type\": \"unknown\"\n  },\n  \"agent\": {\n    \"agentid\": \"adbd57f0-3bf7-4b33-9845-eb489b1b0eea\",\n    \"hostname\": \"SARTE03\",\n    \"osversion\": \"6.3.9600\",\n    \"additional_info\": null,\n    \"osproducttype\": \"Windows Server 2012 R2 Standard\",\n    \"domain\": null,\n    \"version\": \"2.25.13-post0\",\n    \"dnsdomainname\": \"example.org\",\n    \"ostype\": \"windows\",\n    \"distroid\": null,\n    \"domainname\": \"EXA_0342\"\n  },\n  \"level\": \"INFORMATION\",\n  \"event_id\": 1001,\n  \"groups\": [\n    {\n      \"id\": \"bced64f1-9d22-4001-9425-604e45a14d66\",\n      \"name\": \"Group 1\"\n    }\n  ],\n  \"tenant\": \"8029547657723b01\",\n  \"computer_name\": \"SARTE03.example.org\",\n  \"record_number\": 26500965\n}",
        "event": {
            "dataset": "eventlog",
            "kind": "event",
            "type": [
                "info"
            ],
            "provider": "Windows Error Reporting",
            "code": "1001"
        },
        "@timestamp": "2023-05-16T08:46:54Z",
        "agent": {
            "id": "adbd57f0-3bf7-4b33-9845-eb489b1b0eea",
            "name": "harfanglab"
        },
        "log": {
            "hostname": "SARTE03"
        },
        "host": {
            "hostname": "SARTE03",
            "domain": "EXA_0342",
            "os": {
                "version": "6.3.9600",
                "full": "Windows Server 2012 R2 Standard"
            },
            "name": "SARTE03"
        },
        "harfanglab": {
            "groups": [
                "{\"id\": \"bced64f1-9d22-4001-9425-604e45a14d66\", \"name\": \"Group 1\"}"
            ]
        },
        "user": {
            "roles": "Group1"
        },
        "action": {
            "properties": {
                "param11": "8024500b",
                "param8": "Scan",
                "param7": "00000000-0000-0000-0000-000000000000",
                "param12": "AutomaticUpdates",
                "param13": "{581473F3-A4DC-4D00-8245-D203EAA9B5A9}",
                "param18": "0",
                "param16": "",
                "param1": "0",
                "param17": "",
                "param0": "",
                "param4": "0",
                "param10": "0",
                "param19": "3e7b694e-4cf1-45cc-93ff-f30da6e8f683",
                "param15": "C:\\Windows\\WindowsUpdate.log\r\nC:\\Windows\\SoftwareDistribution\\ReportingEvents.log",
                "param20": "262144",
                "param2": "WindowsUpdateFailure3",
                "param21": "",
                "param14": "0",
                "param5": "7.9.9600.19915",
                "param9": "0",
                "param6": "80072ee2",
                "param3": "Non disponible"
            },
            "id": 1001
        },
        "related": {
            "hosts": [
                "SARTE03"
            ]
        }
    }
    	
	```


=== "wineeventlog-event.json"

    ```json
	
    {
        "message": "{\n  \"level\": \"LOG_ALWAYS\",\n  \"@Version\": \"1\",\n  \"@event_create_date\": \"2023-04-20T14:48:59.809Z\",\n  \"groups\": [\n    {\n      \"name\": \"Group 1\",\n      \"id\": \"954bc41c-bfae-4d24-9606-add4e1ab4280\"\n    },\n    {\n      \"name\": \"Group 2\",\n      \"id\": \"a9458e5a-fbd1-466a-8e0a-d25c2948aa61\"\n    }\n  ],\n  \"source_name\": \"Microsoft-Windows-Security-Auditing\",\n  \"log_type\": \"eventlog\",\n  \"event_data\": {\n    \"IpPort\": \"17780\",\n    \"ProcessName\": \"-\",\n    \"SubjectDomainName\": \"-\",\n    \"TargetUserSid\": \"S-1-5-21-11111111111-111111111111-11111111-111\",\n    \"LogonProcessName\": \"Kerbe\",\n    \"RestrictedAdminMode\": \"-\",\n    \"LogonType\": \"3\",\n    \"ElevatedToken\": \"%%1842\",\n    \"TargetOutboundDomainName\": \"-\",\n    \"SubjectUserName\": \"-\",\n    \"AuthenticationPackageName\": \"Kerberos\",\n    \"VirtualAccount\": \"%%1843\",\n    \"WorkstationName\": \"-\",\n    \"IpAddress\": \"1.2.3.4\",\n    \"LogonGuid\": \"{7B5ACC17-5CED-4A2D-ABCB-BECAE6799395}\",\n    \"TargetLinkedLogonId\": \"0x0\",\n    \"SubjectLogonId\": \"0x0\",\n    \"TransmittedServices\": \"-\",\n    \"TargetLogonId\": \"0x6accabcc3\",\n    \"TargetDomainName\": \"example.org\",\n    \"TargetOutboundUserName\": \"-\",\n    \"LmPackageName\": \"-\",\n    \"TargetUserName\": \"john.doe$\",\n    \"ProcessId\": \"0x0\",\n    \"ImpersonationLevel\": \"%%1833\",\n    \"KeyLength\": \"0\",\n    \"SubjectUserSid\": \"S-1-0-0\"\n  },\n  \"@timestamp\": \"2023-04-20T14:49:02.914471Z\",\n  \"thread_id\": 11111,\n  \"provider_guid\": \"4d8dc5df-a605-4c76-b699-bc72464a8114\",\n  \"event\": {\n    \"original\": \"{\\\"computer_name\\\":\\\"sfreort.gosis.lan\\\",\\\"event_date\\\":\\\"2023/04/20 14:48:59.809\\\",\\\"event_id\\\":4624,\\\"keywords\\\":[\\\"AuditSuccess\\\",\\\"ReservedKeyword63\\\"],\\\"level\\\":\\\"LOG_ALWAYS\\\",\\\"log_name\\\":\\\"Security\\\",\\\"log_type\\\":\\\"eventlog\\\",\\\"type\\\":\\\"wineventlog\\\",\\\"user\\\":{\\\"domain\\\":\\\"\\\",\\\"identifier\\\":\\\"\\\",\\\"name\\\":\\\"\\\",\\\"type\\\":\\\"unknown\\\"},\\\"event_data\\\":{\\\"TargetLinkedLogonId\\\":\\\"0x0\\\",\\\"LogonType\\\":\\\"3\\\",\\\"SubjectUserSid\\\":\\\"S-1-0-0\\\",\\\"ProcessId\\\":\\\"0x0\\\",\\\"TargetLogonId\\\":\\\"0x6accabcc3\\\",\\\"TargetOutboundDomainName\\\":\\\"-\\\",\\\"LogonProcessName\\\":\\\"Kerberos\\\",\\\"SubjectLogonId\\\":\\\"0x0\\\",\\\"LmPackageName\\\":\\\"-\\\",\\\"RestrictedAdminMode\\\":\\\"-\\\",\\\"KeyLength\\\":\\\"0\\\",\\\"ImpersonationLevel\\\":\\\"%%1833\\\",\\\"SubjectDomainName\\\":\\\"-\\\",\\\"AuthenticationPackageName\\\":\\\"Kerbes\\\",\\\"WorkstationName\\\":\\\"-\\\",\\\"VirtualAccount\\\":\\\"%%1843\\\",\\\"IpAddress\\\":\\\"1.2.3.4\\\",\\\"LogonGuid\\\":\\\"{7B5ACC17-5CED-4A2D-ABCB-BECAE6799395}\\\",\\\"TargetOutboundUserName\\\":\\\"-\\\",\\\"TargetUserSid\\\":\\\"S-1-5-21-11111111111-111111111111-11111111-111\\\",\\\"TargetDomainName\\\":\\\"example.org\\\",\\\"SubjectUserName\\\":\\\"-\\\",\\\"TransmittedServices\\\":\\\"-\\\",\\\"ElevatedToken\\\":\\\"%%1842\\\",\\\"IpPort\\\":\\\"17780\\\",\\\"TargetUserName\\\":\\\"john.doe$\\\",\\\"ProcessName\\\":\\\"-\\\"},\\\"process_id\\\":772,\\\"provider_guid\\\":\\\"54849625-5478-4994-a5ba-3e3b0328c30d\\\",\\\"record_number\\\":1069291078,\\\"source_name\\\":\\\"Microsoft-Windows-Security-Auditing\\\",\\\"thread_id\\\":29956,\\\"user_data\\\":{},\\\"groups\\\":[{\\\"id\\\":\\\"2dccd722-6db5-4727-88d2-042b0d8655c3\\\",\\\"name\\\":\\\"Group 1\\\"},{\\\"id\\\":\\\"a9458e5a-fbd1-466a-8e0a-d25c2955aa61\\\",\\\"name\\\":\\\"Group 2\\\"}],\\\"destination\\\":\\\"sys\\\",\\\"agent\\\":{\\\"agentid\\\":\\\"ef3cd644-1867-4917-ac79-148c2ccd55d5\\\",\\\"hostname\\\":\\\"sfreart\\\",\\\"domain\\\":null,\\\"domainname\\\":\\\"EXAMPLE\\\",\\\"dnsdomainname\\\":\\\"example.org\\\",\\\"ostype\\\":\\\"windows\\\",\\\"osversion\\\":\\\"10.0.14393\\\",\\\"distroid\\\":null,\\\"osproducttype\\\":\\\"Windows Server 2016 Standard\\\",\\\"version\\\":\\\"2.25.4-post0\\\",\\\"additional_info\\\":null}}\"\n  },\n  \"type\": \"wineventlog\",\n  \"keywords\": [\n    \"AuditSuccess\",\n    \"ReservedKeyword63\"\n  ],\n  \"tenant\": \"2222222222222222\",\n  \"destination\": \"sys\",\n  \"agent\": {\n    \"hostname\": \"sfreort\",\n    \"osversion\": \"10.0.14393\",\n    \"version\": \"2.25.4-post0\",\n    \"domainname\": \"EXAMPLE\",\n    \"distroid\": null,\n    \"additional_info\": null,\n    \"agentid\": \"3f17a3fe-3490-4b8f-8de4-9dcdf92c68b0\",\n    \"osproducttype\": \"Windows Server 2016 Standard\",\n    \"dnsdomainname\": \"example.org\",\n    \"ostype\": \"windows\",\n    \"domain\": null\n  },\n  \"log_name\": \"Security\",\n  \"event_id\": 4624,\n  \"user\": {\n    \"name\": \"\",\n    \"identifier\": \"\",\n    \"domain\": \"\",\n    \"type\": \"unknown\"\n  },\n  \"user_data\": {},\n  \"computer_name\": \"sfreort.example.org\",\n  \"process_id\": 772,\n  \"record_number\": 1069291078\n}",
        "event": {
            "dataset": "eventlog",
            "kind": "event",
            "type": [
                "info"
            ],
            "provider": "Microsoft-Windows-Security-Auditing",
            "code": "4624"
        },
        "@timestamp": "2023-04-20T14:48:59.809000Z",
        "agent": {
            "id": "3f17a3fe-3490-4b8f-8de4-9dcdf92c68b0",
            "name": "harfanglab"
        },
        "log": {
            "hostname": "sfreort"
        },
        "host": {
            "hostname": "sfreort",
            "domain": "EXAMPLE",
            "os": {
                "version": "10.0.14393",
                "full": "Windows Server 2016 Standard"
            },
            "name": "sfreort"
        },
        "harfanglab": {
            "groups": [
                "{\"id\": \"954bc41c-bfae-4d24-9606-add4e1ab4280\", \"name\": \"Group 1\"}",
                "{\"id\": \"a9458e5a-fbd1-466a-8e0a-d25c2948aa61\", \"name\": \"Group 2\"}"
            ]
        },
        "user": {
            "roles": "Group1,Group2",
            "target": {
                "name": "john.doe$",
                "domain": "example.org"
            }
        },
        "action": {
            "properties": {
                "IpPort": "17780",
                "ProcessName": "-",
                "SubjectDomainName": "-",
                "TargetUserSid": "S-1-5-21-11111111111-111111111111-11111111-111",
                "LogonProcessName": "Kerbe",
                "RestrictedAdminMode": "-",
                "LogonType": "3",
                "ElevatedToken": "%%1842",
                "TargetOutboundDomainName": "-",
                "SubjectUserName": "-",
                "AuthenticationPackageName": "Kerberos",
                "VirtualAccount": "%%1843",
                "WorkstationName": "-",
                "IpAddress": "1.2.3.4",
                "LogonGuid": "{7B5ACC17-5CED-4A2D-ABCB-BECAE6799395}",
                "TargetLinkedLogonId": "0x0",
                "SubjectLogonId": "0x0",
                "TransmittedServices": "-",
                "TargetLogonId": "0x6accabcc3",
                "TargetDomainName": "example.org",
                "TargetOutboundUserName": "-",
                "LmPackageName": "-",
                "TargetUserName": "john.doe$",
                "ProcessId": "0x0",
                "ImpersonationLevel": "%%1833",
                "KeyLength": "0",
                "SubjectUserSid": "S-1-0-0"
            },
            "id": 4624
        },
        "related": {
            "hosts": [
                "sfreort"
            ]
        }
    }
    	
	```


=== "wineventlog.json"

    ```json
	
    {
        "message": "{\"tenant\":\"\",\"type\":\"wineventlog\",\"@event_create_date\":\"2021-11-21T13:11:49.837Z\",\"log_name\":\"Microsoft-Windows-PowerShell/Operational\",\"event_data\":{\"param1\":\"7092\",\"param2\":\"DefaultAppDomain\"},\"agent\":{\"osversion\":\"10.0.19041\",\"hostname\":\"DESKTOP-9U3171J\",\"ostype\":\"windows\",\"agentid\":\"f43cb847-8227-4104-b77f-7fc849789f8e\",\"osproducttype\":\"Windows 10 Pro\",\"domainname\":\"WORKGROUP\",\"distroid\":null,\"domain\":null},\"keywords\":[],\"log_type\":\"eventlog\",\"@version\":\"1\",\"source_name\":\"Microsoft-Windows-PowerShell\",\"@timestamp\":\"2021-11-21T13:12:10.929Z\",\"process_id\":7092,\"task\":null,\"level\":\"Information\",\"provider_guid\":\"{A1A1853B-5C40-4B15-8766-3CF1C58F985A}\",\"user\":{\"name\":\"oliver\",\"type\":\"User\",\"domain\":\"DESKTOP-9U3171J\",\"identifier\":\"S-1-5-21-975228105-2966123187-4141390122-1001\"},\"record_number\":104780,\"computer_name\":\"DESKTOP-9U3171J\",\"thread_id\":6744,\"event_id\":53504,\"opcode\":null,\"user_data\":{}}",
        "event": {
            "dataset": "eventlog",
            "kind": "event",
            "type": [
                "info"
            ],
            "provider": "Microsoft-Windows-PowerShell",
            "code": "53504"
        },
        "@timestamp": "2021-11-21T13:11:49.837000Z",
        "agent": {
            "id": "f43cb847-8227-4104-b77f-7fc849789f8e",
            "name": "harfanglab"
        },
        "log": {
            "hostname": "DESKTOP-9U3171J"
        },
        "host": {
            "hostname": "DESKTOP-9U3171J",
            "domain": "WORKGROUP",
            "os": {
                "version": "10.0.19041",
                "full": "Windows 10 Pro"
            },
            "name": "DESKTOP-9U3171J"
        },
        "action": {
            "properties": {
                "param1": "7092",
                "param2": "DefaultAppDomain"
            },
            "id": 53504
        },
        "related": {
            "hosts": [
                "DESKTOP-9U3171J"
            ]
        }
    }
    	
	```


=== "wineventlog2.json"

    ```json
	
    {
        "message": "{\"log_name\":\"Security\",\"type\":\"wineventlog\",\"source_name\":\"Microsoft-Windows-Security-Auditing\",\"event_id\":4625,\"provider_guid\":\"{54849625-5478-4994-A5BA-3E3B0328C30D}\",\"level\":\"Information\",\"opcode\":null,\"agent\":{\"osversion\":\"10.0.17763\",\"domainname\":\"WORKGROUP\",\"agentid\":\"77af54c8-910f-455d-b887-87cbc87430a4\",\"osproducttype\":\"Windows Server 2019 Datacenter\",\"hostname\":\"REDACTED\",\"domain\":null},\"user\":null,\"event_date\":\"2021-05-08T12:18:58.996Z\",\"process_id\":760,\"@timestamp\":\"2021-05-08T12:19:10.711Z\",\"user_data\":{},\"@version\":\"1\",\"event_data\":{\"IpPort\":\"0\",\"AuthenticationPackageName\":\"NTLM\",\"TransmittedServices\":\"-\",\"TargetUserSid\":\"S-1-0-0\",\"SubjectUserName\":\"-\",\"SubStatus\":\"0xc000006a\",\"IpAddress\":\"166.88.151.58\",\"SubjectLogonId\":\"0x0\",\"FailureReason\":\"%%2313\",\"WorkstationName\":\"-\",\"SubjectUserSid\":\"S-1-0-0\",\"LogonProcessName\":\"NtLmSsp \",\"TargetUserName\":\"ADMINISTRATOR\",\"ProcessName\":\"-\",\"TargetDomainName\":null,\"Status\":\"0xc000006d\",\"LmPackageName\":\"-\",\"KeyLength\":\"0\",\"SubjectDomainName\":\"-\",\"LogonType\":\"3\",\"ProcessId\":\"0x0\"},\"keywords\":[\"Audit Failure\"],\"task\":null,\"record_number\":5089212,\"thread_id\":1768,\"log_type\":\"eventlog\",\"computer_name\":\"REDACTED\"}",
        "event": {
            "dataset": "eventlog",
            "kind": "event",
            "type": [
                "info"
            ],
            "provider": "Microsoft-Windows-Security-Auditing",
            "code": "4625"
        },
        "agent": {
            "id": "77af54c8-910f-455d-b887-87cbc87430a4",
            "name": "harfanglab"
        },
        "log": {
            "hostname": "REDACTED"
        },
        "host": {
            "hostname": "REDACTED",
            "domain": "WORKGROUP",
            "os": {
                "version": "10.0.17763",
                "full": "Windows Server 2019 Datacenter"
            },
            "name": "REDACTED"
        },
        "action": {
            "properties": {
                "IpPort": "0",
                "AuthenticationPackageName": "NTLM",
                "TransmittedServices": "-",
                "TargetUserSid": "S-1-0-0",
                "SubjectUserName": "-",
                "SubStatus": "0xc000006a",
                "IpAddress": "166.88.151.58",
                "SubjectLogonId": "0x0",
                "FailureReason": "%%2313",
                "WorkstationName": "-",
                "SubjectUserSid": "S-1-0-0",
                "LogonProcessName": "NtLmSsp ",
                "TargetUserName": "ADMINISTRATOR",
                "ProcessName": "-",
                "TargetDomainName": null,
                "Status": "0xc000006d",
                "LmPackageName": "-",
                "KeyLength": "0",
                "SubjectDomainName": "-",
                "LogonType": "3",
                "ProcessId": "0x0"
            },
            "id": 4625
        },
        "user": {
            "target": {
                "name": "ADMINISTRATOR"
            }
        },
        "related": {
            "hosts": [
                "REDACTED"
            ]
        }
    }
    	
	```


=== "wineventlog3.json"

    ```json
	
    {
        "message": "{\"computer_name\":\"REDACTED\",\"process_id\":3464,\"provider_guid\":\"{11CD958A-C507-4EF3-B3F2-5FD9DFBD2C78}\",\"type\":\"wineventlog\",\"log_name\":\"Microsoft-Windows-Windows Defender/Operational\",\"task\":null,\"user\":{\"identifier\":\"S-1-5-18\",\"domain\":\"AUTORITE NT\",\"type\":\"User\",\"name\":\"Syst\u00e8me\"},\"log_type\":\"eventlog\",\"@version\":\"1\",\"tenant\":\"\",\"keywords\":[],\"@event_create_date\":\"2022-01-03T05:44:57.331Z\",\"thread_id\":23768,\"record_number\":2300,\"event_id\":1116,\"event_data\":{\"Unused4\":null,\"Threat Name\":\"Exploit:O97M/CVE-2017-11882.SMK\",\"Post Clean Status\":\"0\",\"Product Version\":\"4.18.2111.5\",\"Detection Time\":\"2022-01-03T05:44:57.284Z\",\"Detection User\":\"AUTORITE NT\\\\Syst\u00e8me\",\"Status Code\":\"1\",\"Origin ID\":\"1\",\"Category ID\":\"30\",\"FWLink\":\"https://go.microsoft.com/fwlink/?linkid=37020&name=Exploit:O97M/CVE-2017-11882.SMK!MTB&threatid=2147772194&enterprise=0\",\"Path\":\"file:_C:\\\\Program Files\\\\Avast\\\\Amex\\\\temp\\\\TMMSG_45AD4A29-D7BD-AE8F-FFBC-4115652291C2\",\"Process Name\":\"C:\\\\Program Files\\\\Avast\\\\Amex\\\\AMEX_secondary.exe\",\"Origin Name\":\"Ordinateur local\",\"Execution ID\":\"1\",\"Remediation User\":null,\"Status Description\":null,\"Category Name\":\"Attaque\",\"Type Name\":\"Concret\",\"State\":\"1\",\"Pre Execution Status\":\"0\",\"Type ID\":\"0\",\"Action Name\":\"Non applicable\",\"Unused6\":null,\"Additional Actions String\":\"No additional actions required\",\"Threat ID\":\"2147772194\",\"Execution Name\":\"Suspendu\",\"Severity ID\":\"5\",\"Error Description\":\"L\u2019op\u00e9ration a r\u00e9ussi. \",\"Engine Version\":\"AM: 1.1.18800.4, NIS: 1.1.18800.4\",\"Unused3\":null,\"Detection ID\":\"{2E51DC7F-A01D-4E9E-94C8-782C63D85C6E}\",\"Security intelligence Version\":\"AV: 1.355.1292.0, AS: 1.355.1292.0, NIS: 1.355.1292.0\",\"Product Name\":\"Antivirus Microsoft Defender\",\"Unused\":null,\"Action ID\":\"9\",\"Source ID\":\"3\",\"Additional Actions ID\":\"0\",\"Source Name\":\"Protection en temps r\u00e9el\",\"Unused5\":null,\"Severity Name\":\"Grave\",\"Error Code\":\"0x00000000\",\"Unused2\":null},\"level\":\"Warning\",\"source_name\":\"Microsoft-Windows-Windows Defender\",\"opcode\":null,\"@timestamp\":\"2022-01-03T05:45:12.816Z\",\"user_data\":{},\"agent\":{\"agentid\":\"06d70013-58c7-46e3-9231-452a383af90b\",\"domain\":null,\"osproducttype\":\"Windows Server 2019 Datacenter\",\"ostype\":\"windows\",\"osversion\":\"10.0.17763\",\"version\":\"2.12.2\",\"domainname\":\"REDACTED\",\"distroid\":null,\"hostname\":\"REDACTED\"}}",
        "event": {
            "dataset": "eventlog",
            "kind": "event",
            "type": [
                "info"
            ],
            "provider": "Microsoft-Windows-Windows Defender",
            "code": "1116"
        },
        "@timestamp": "2022-01-03T05:44:57.331000Z",
        "agent": {
            "id": "06d70013-58c7-46e3-9231-452a383af90b",
            "name": "harfanglab"
        },
        "log": {
            "hostname": "REDACTED"
        },
        "host": {
            "hostname": "REDACTED",
            "domain": "REDACTED",
            "os": {
                "version": "10.0.17763",
                "full": "Windows Server 2019 Datacenter"
            },
            "name": "REDACTED"
        },
        "action": {
            "properties": {
                "Unused4": null,
                "Threat Name": "Exploit:O97M/CVE-2017-11882.SMK",
                "Post Clean Status": "0",
                "Product Version": "4.18.2111.5",
                "Detection Time": "2022-01-03T05:44:57.284Z",
                "Detection User": "AUTORITE NT\\Syst\u00e8me",
                "Status Code": "1",
                "Origin ID": "1",
                "Category ID": "30",
                "FWLink": "https://go.microsoft.com/fwlink/?linkid=37020&name=Exploit:O97M/CVE-2017-11882.SMK!MTB&threatid=2147772194&enterprise=0",
                "Path": "file:_C:\\Program Files\\Avast\\Amex\\temp\\TMMSG_45AD4A29-D7BD-AE8F-FFBC-4115652291C2",
                "Process Name": "C:\\Program Files\\Avast\\Amex\\AMEX_secondary.exe",
                "Origin Name": "Ordinateur local",
                "Execution ID": "1",
                "Remediation User": null,
                "Status Description": null,
                "Category Name": "Attaque",
                "Type Name": "Concret",
                "State": "1",
                "Pre Execution Status": "0",
                "Type ID": "0",
                "Action Name": "Non applicable",
                "Unused6": null,
                "Additional Actions String": "No additional actions required",
                "Threat ID": "2147772194",
                "Execution Name": "Suspendu",
                "Severity ID": "5",
                "Error Description": "L\u2019op\u00e9ration a r\u00e9ussi. ",
                "Engine Version": "AM: 1.1.18800.4, NIS: 1.1.18800.4",
                "Unused3": null,
                "Detection ID": "{2E51DC7F-A01D-4E9E-94C8-782C63D85C6E}",
                "Security intelligence Version": "AV: 1.355.1292.0, AS: 1.355.1292.0, NIS: 1.355.1292.0",
                "Product Name": "Antivirus Microsoft Defender",
                "Unused": null,
                "Action ID": "9",
                "Source ID": "3",
                "Additional Actions ID": "0",
                "Source Name": "Protection en temps r\u00e9el",
                "Unused5": null,
                "Severity Name": "Grave",
                "Error Code": "0x00000000",
                "Unused2": null
            },
            "id": 1116
        },
        "related": {
            "hosts": [
                "REDACTED"
            ]
        }
    }
    	
	```


=== "wineventlog4.json"

    ```json
	
    {
        "message": "{\"provider_guid\":\"{54849625-5478-4994-A5BA-3E3B0328C30D}\",\"task\":null,\"opcode\":null,\"agent\":{\"distroid\":null,\"hostname\":\"REDACTED\",\"ostype\":\"windows\",\"domain\":null,\"osproducttype\":\"Windows Server 2012 Standard\",\"agentid\":\"aa7cf2c6-5c46-45c4-b918-ba5cd7082e53\",\"osversion\":\"6.2.9200\",\"domainname\":\"REDACTED\",\"version\":\"2.19.5\"},\"@event_create_date\":\"2022-11-14T08:41:03.066Z\",\"level\":\"Information\",\"destination\":\"syslog\",\"record_number\":1475418032,\"keywords\":[\"Audit Success\"],\"event_id\":5145,\"computer_name\":\"REDACTED.LOCAL\",\"tenant\":\"\",\"type\":\"wineventlog\",\"log_name\":\"Security\",\"process_id\":720,\"@version\":\"1\",\"thread_id\":728,\"event_data\":{\"SubjectDomainName\":\"AUTORITE NT\",\"IpAddress\":\"10.84.128.186\",\"ShareLocalPath\":null,\"SubjectUserSid\":\"S-1-5-7\",\"AccessList\":\"%%1538\\n\\t\\t\\t\\t%%1541\\n\\t\\t\\t\\t%%4416\\n\\t\\t\\t\\t%%4417\\n\\t\\t\\t\\t%%4418\\n\\t\\t\\t\\t%%4419\\n\\t\\t\\t\\t%%4420\\n\\t\\t\\t\\t%%4423\\n\\t\\t\\t\\t%%4424\\n\\t\\t\\t\\t\",\"ShareName\":\"\\\\\\\\*\\\\IPC$\",\"AccessReason\":\"-\",\"SubjectUserName\":\"ANONYMOUS LOGON\",\"ObjectType\":\"File\",\"IpPort\":\"50846\",\"SubjectLogonId\":\"0x3ad88f7f3\",\"AccessMask\":\"0x12019f\",\"RelativeTargetName\":\"NETLOGON\"},\"log_type\":\"eventlog\",\"@timestamp\":\"2022-11-14T08:41:05.337Z\",\"user_data\":{},\"user\":null,\"source_name\":\"Microsoft-Windows-Security-Auditing\"}",
        "event": {
            "dataset": "eventlog",
            "kind": "event",
            "type": [
                "info"
            ],
            "provider": "Microsoft-Windows-Security-Auditing",
            "code": "5145"
        },
        "@timestamp": "2022-11-14T08:41:03.066000Z",
        "agent": {
            "id": "aa7cf2c6-5c46-45c4-b918-ba5cd7082e53",
            "name": "harfanglab"
        },
        "log": {
            "hostname": "REDACTED"
        },
        "host": {
            "hostname": "REDACTED",
            "domain": "REDACTED",
            "os": {
                "version": "6.2.9200",
                "full": "Windows Server 2012 Standard"
            },
            "name": "REDACTED"
        },
        "action": {
            "properties": {
                "SubjectDomainName": "AUTORITE NT",
                "IpAddress": "10.84.128.186",
                "ShareLocalPath": null,
                "SubjectUserSid": "S-1-5-7",
                "AccessList": "%%1538\n\t\t\t\t%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4417\n\t\t\t\t%%4418\n\t\t\t\t%%4419\n\t\t\t\t%%4420\n\t\t\t\t%%4423\n\t\t\t\t%%4424\n\t\t\t\t",
                "ShareName": "\\\\*\\IPC$",
                "AccessReason": "-",
                "SubjectUserName": "ANONYMOUS LOGON",
                "ObjectType": "File",
                "IpPort": "50846",
                "SubjectLogonId": "0x3ad88f7f3",
                "AccessMask": "0x12019f",
                "RelativeTargetName": "NETLOGON"
            },
            "id": 5145
        },
        "user": {
            "name": "ANONYMOUS LOGON",
            "domain": "AUTORITE NT"
        },
        "related": {
            "hosts": [
                "REDACTED"
            ],
            "user": [
                "ANONYMOUS LOGON"
            ]
        }
    }
    	
	```





## Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`action.properties` | `object` | A detailed set of attributes associated with a specific action, typically involving user authentication or a network event. It contains the following keys: |
|`agent.id` | `keyword` | Unique identifier of this agent. |
|`agent.name` | `keyword` | Custom name of the agent. |
|`agent.version` | `keyword` | Version of the agent. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.port` | `long` | Port of the destination. |
|`dns.question.name` | `keyword` | The name being queried. |
|`dns.question.type` | `keyword` | The type of record being queried. |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.code` | `keyword` | Identification code for this event. |
|`event.dataset` | `keyword` | Name of the dataset. |
|`event.kind` | `keyword` | The kind of the event. The highest categorization field in the hierarchy. |
|`event.provider` | `keyword` | Source of the event. |
|`event.reason` | `keyword` | Reason why this event happened, according to the source |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`file.hash.md5` | `keyword` | MD5 hash. |
|`file.hash.sha1` | `keyword` | SHA1 hash. |
|`file.hash.sha256` | `keyword` | SHA256 hash. |
|`file.name` | `keyword` | Name of the file including the extension, without the directory. |
|`file.path` | `keyword` | Full path to the file, including the file name. |
|`file.pe.company` | `keyword` | Internal company name of the file, provided at compile-time. |
|`file.pe.description` | `keyword` | Internal description of the file, provided at compile-time. |
|`file.pe.file_version` | `keyword` | Process name. |
|`file.pe.imphash` | `keyword` | A hash of the imports in a PE file. |
|`file.pe.original_file_name` | `keyword` | Internal name of the file, provided at compile-time. |
|`file.pe.product` | `keyword` | Internal product name of the file, provided at compile-time. |
|`harfanglab.aggregation_key` | `keyword` | The key to the events aggregation |
|`harfanglab.alert_subtype` | `keyword` | The subtype of the alert |
|`harfanglab.alert_time` | `keyword` | The timestamp of the alert |
|`harfanglab.alert_unique_id` | `keyword` | The identifier of the alert |
|`harfanglab.execution` | `long` | Execution time  |
|`harfanglab.groups` | `keyword` | harfanglab groups |
|`harfanglab.level` | `keyword` | The risk level associated to the alert |
|`harfanglab.process.powershell.command` | `keyword` | The powershell command executed |
|`harfanglab.status` | `keyword` | The status of the alert |
|`host.domain` | `keyword` | Name of the directory the group is a member of. |
|`host.hostname` | `keyword` | Hostname of the host. |
|`host.os.full` | `keyword` | Operating system name, including the version or code name. |
|`host.os.version` | `keyword` | Operating system version as a raw string. |
|`http.request.method` | `keyword` | HTTP request method. |
|`http.response.status_code` | `long` | HTTP response status code. |
|`organization.id` | `keyword` | Unique identifier for the organization. |
|`process.command_line` | `wildcard` | Full command line that started the process. |
|`process.executable` | `keyword` | Absolute path to the process executable. |
|`process.name` | `keyword` | Process name. |
|`process.parent.command_line` | `wildcard` | Full command line that started the process. |
|`process.parent.executable` | `keyword` | Absolute path to the process executable. |
|`process.parent.name` | `keyword` | Process name. |
|`process.pe.company` | `keyword` | Internal company name of the file, provided at compile-time. |
|`process.pe.description` | `keyword` | Internal description of the file, provided at compile-time. |
|`process.pe.file_version` | `keyword` | Process name. |
|`process.pe.imphash` | `keyword` | A hash of the imports in a PE file. |
|`process.pe.original_file_name` | `keyword` | Internal name of the file, provided at compile-time. |
|`process.pe.product` | `keyword` | Internal product name of the file, provided at compile-time. |
|`process.pid` | `long` | Process id. |
|`process.working_directory` | `keyword` | The working directory of the process. |
|`registry.hive` | `keyword` | Abbreviated name for the hive. |
|`registry.key` | `keyword` | Hive-relative path of keys. |
|`registry.path` | `keyword` | Full path, including hive, key and value |
|`registry.value` | `keyword` | Name of the value written. |
|`rule.category` | `keyword` | Rule category |
|`rule.description` | `keyword` | Rule description |
|`rule.id` | `keyword` | Rule ID |
|`rule.name` | `keyword` | Rule name |
|`source.ip` | `ip` | IP address of the source. |
|`source.port` | `long` | Port of the source. |
|`url.path` | `wildcard` | Path of the request, such as "/search". |
|`user.domain` | `keyword` | Name of the directory the user is a member of. |
|`user.id` | `keyword` | Unique identifier of the user. |
|`user.name` | `keyword` | Short name or login of the user. |
|`user.roles` | `keyword` | Array of user roles at the time of the event. |
|`user.target.domain` | `keyword` | Name of the directory the user is a member of. |
|`user.target.id` | `keyword` | Unique identifier of the user. |
|`user.target.name` | `keyword` | Short name or login of the user. |
|`user_agent.original` | `keyword` | Unparsed user_agent string. |

