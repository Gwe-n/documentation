
## Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Access tokens` | security identifiers are extracted from several events |
| `Authentication logs` | audit logon events are examined in detail |
| `DLL monitoring` | information about dlls are extracted from several events |
| `File monitoring` | information about files are extracted from several events |
| `Host network interface` | Windows Filtering Platform collects information on processes having network activities |
| `Loaded DLLs` | Sysmon events provide information on DLL loading |
| `PowerShell logs` | Windows PowerShell logs are analyzed, and need to be specifically set up |
| `Process command-line parameters` | Windows Security Auditing logs provide information about process creation |
| `Process monitoring` | Windows Security Auditing logs are process tracking events |
| `Process use of network` | Windows Filtering Platform collects information on processes having network activities |
| `Windows event logs` | events related to Windows Event logs shutdown or restart are analyzed |
| `Windows Registry` | registry auditing events are examined in detail |
| `WMI Objects` | Windows WMI Activity events are analyzed, and events related to WMI process too |








## Event Samples

Find below few samples of events and how they are normalized by Sekoia.io.


=== "auth.json"

    ```json
	
    {
        "message": "{\"@timestamp\":\"2023-01-31T18:02:52.597Z\",\"@version\":\"1\",\"agent\":{\"ephemeral_id\":\"379a53ae-f8df-4fb9-9968-382db61f6dda\",\"hostname\":\"vm204d\",\"id\":\"9ecce8bd-f6ab-41ac-9936-14f8c2c81242\",\"type\":\"winlogbeat\",\"version\":\"7.0.0\"},\"ecs\":{\"version\":\"1.0.0\"},\"event\":{\"action\":\"Filtering Platform Connection\",\"code\":5156,\"created\":\"2023-01-31T18:02:53.233Z\",\"kind\":\"event\"},\"host\":{\"architecture\":\"x86_64\",\"hostname\":\"vm204d\",\"id\":\"68884df7-2cc9-4c09-a619-e1ccce85ac4e\",\"name\":\"vm204d\",\"os\":{\"build\":\"20348.1487\",\"family\":\"windows\",\"kernel\":\"10.0.20348.1487 (WinBuild.160101.0800)\",\"name\":\"Windows Server 2022 Datacenter\",\"platform\":\"windows\",\"version\":\"10.0\"}},\"log\":{\"level\":\"information\"},\"message\":\"The Windows Filtering Platform has permitted a connection.\\n\\nApplication Information:\\n\\tProcess ID:\\t\\t4\\n\\tApplication Name:\\tSystem\\n\\nNetwork Information:\\n\\tDirection:\\t\\tInbound\\n\\tSource Address:\\t\\t1.1.1.1\\n\\tSource Port:\\t\\t58499\\n\\tDestination Address:\\t192.168.240.196\\n\\tDestination Port:\\t\\t445\\n\\tProtocol:\\t\\t6\\n\\tInterface Index:\\t\\t9\\n\\nFilter Information:\\n\\tFilter Origin:\\t\\tUnknown\\n\\tFilter Run-Time ID:\\t71694\\n\\tLayer Name:\\t\\tReceive/Accept\\n\\tLayer Run-Time ID:\\t44\\n\\tRemote User ID:\\t\\tS-1-0-0\\n\\tRemote Machine ID:\\tS-1-0-0\",\"tags\":[\"beats_input_codec_plain_applied\"],\"type\":\"winlogbeat\",\"winlog\":{\"api\":\"wineventlog\",\"channel\":\"Security\",\"computer_name\":\"vm204d.example.org\",\"event_data\":{\"Application\":\"System\",\"DestAddress\":\"5.6.7.8\",\"DestPort\":\"445\",\"Direction\":\"%%14592\",\"FilterOrigin\":\"Unknown\",\"FilterRTID\":\"71694\",\"InterfaceIndex\":\"9\",\"LayerName\":\"%%14610\",\"LayerRTID\":\"44\",\"ProcessID\":\"4\",\"Protocol\":\"6\",\"RemoteMachineID\":\"S-1-0-0\",\"RemoteUserID\":\"S-1-0-0\",\"SourceAddress\":\"1.2.3.4\",\"SourcePort\":\"58499\"},\"event_id\":5156,\"keywords\":[\"Audit Success\"],\"opcode\":\"Info\",\"process\":{\"pid\":4,\"thread\":{\"id\":1940}},\"provider_guid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\",\"provider_name\":\"Microsoft-Windows-Security-Auditing\",\"record_id\":614833249,\"task\":\"Filtering Platform Connection\",\"version\":1}}\n",
        "event": {
            "action": "Filtering Platform Connection",
            "code": "5156",
            "kind": "event",
            "original": "The Windows Filtering Platform has permitted a connection.\n\nApplication Information:\n\tProcess ID:\t\t4\n\tApplication Name:\tSystem\n\nNetwork Information:\n\tDirection:\t\tInbound\n\tSource Address:\t\t1.1.1.1\n\tSource Port:\t\t58499\n\tDestination Address:\t192.168.240.196\n\tDestination Port:\t\t445\n\tProtocol:\t\t6\n\tInterface Index:\t\t9\n\nFilter Information:\n\tFilter Origin:\t\tUnknown\n\tFilter Run-Time ID:\t71694\n\tLayer Name:\t\tReceive/Accept\n\tLayer Run-Time ID:\t44\n\tRemote User ID:\t\tS-1-0-0\n\tRemote Machine ID:\tS-1-0-0",
            "hash": "0ea8852922910c8bceeaff4bd0d18c79c045b2d5"
        },
        "@timestamp": "2023-01-31T18:02:52.597000Z",
        "action": {
            "properties": {
                "Application": "System",
                "DestAddress": "5.6.7.8",
                "DestPort": "445",
                "Direction": "%%14592",
                "FilterOrigin": "Unknown",
                "FilterRTID": "71694",
                "InterfaceIndex": "9",
                "LayerName": "%%14610",
                "LayerRTID": "44",
                "ProcessID": "4",
                "Protocol": "6",
                "RemoteMachineID": "S-1-0-0",
                "RemoteUserID": "S-1-0-0",
                "SourceAddress": "1.2.3.4",
                "SourcePort": "58499"
            },
            "id": 5156
        },
        "agent": {
            "ephemeral_id": "379a53ae-f8df-4fb9-9968-382db61f6dda",
            "id": "9ecce8bd-f6ab-41ac-9936-14f8c2c81242",
            "type": "winlogbeat",
            "version": "7.0.0"
        },
        "host": {
            "architecture": "x86_64",
            "hostname": "vm204d",
            "id": "68884df7-2cc9-4c09-a619-e1ccce85ac4e",
            "name": "vm204d",
            "os": {
                "build": "20348.1487",
                "family": "windows",
                "kernel": "10.0.20348.1487 (WinBuild.160101.0800)",
                "name": "Windows Server 2022 Datacenter",
                "platform": "windows",
                "version": "10.0"
            }
        },
        "log": {
            "level": "information"
        },
        "winlog": {
            "api": "wineventlog",
            "channel": "Security",
            "computer_name": "vm204d.example.org",
            "event_id": "5156",
            "keywords": [
                "Audit Success"
            ],
            "opcode": "Info",
            "process": {
                "pid": 4,
                "thread": {
                    "id": 1940
                }
            },
            "provider_guid": "{54849625-5478-4994-a5ba-3e3b0328c30d}",
            "provider_name": "Microsoft-Windows-Security-Auditing",
            "record_id": "614833249",
            "task": "Filtering Platform Connection",
            "version": 1
        },
        "related": {
            "hash": [
                "0ea8852922910c8bceeaff4bd0d18c79c045b2d5"
            ],
            "hosts": [
                "vm204d"
            ]
        }
    }
    	
	```


=== "auth2.json"

    ```json
	
    {
        "message": "{\"@timestamp\":\"2023-06-23T08:15:46.358Z\",\"ecs\":{\"version\":\"1.0.0\"},\"type\":\"winlogbeat\",\"tags\":[\"beats_input_codec_plain_applied\"],\"agent\":{\"id\":\"c1e16f64-cfc4-4141-bdc0-71f2a0e45791\",\"ephemeral_id\":\"21a6bd0d-afb5-4e55-827e-5329797579a4\",\"hostname\":\"VM-FOO\",\"version\":\"7.0.0\",\"type\":\"winlogbeat\"},\"host\":{\"os\":{\"build\":\"14393.5921\",\"kernel\":\"10.0.14393.5921 (rs1_release.230504-1649)\",\"version\":\"10.0\",\"name\":\"Windows Server 2016 Datacenter\",\"family\":\"windows\",\"platform\":\"windows\"},\"id\":\"8ea16272-0ba2-4838-b321-1646a493a128\",\"hostname\":\"VM-FOO\",\"architecture\":\"x86_64\",\"name\":\"VM-FOO\"},\"winlog\":{\"process\":{\"pid\":756,\"thread\":{\"id\":13000}},\"event_data\":{\"TargetLogonId\":\"0x2374a6a43\",\"SubjectLogonId\":\"0x0\",\"TargetUserName\":\"FOO-FARM-ADMIN\",\"TargetUserSid\":\"S-1-5-21-776561741-920026266-725345543-12737\",\"TargetLinkedLogonId\":\"0x0\",\"ProcessId\":\"0x0\",\"AuthenticationPackageName\":\"Kerberos\",\"ImpersonationLevel\":\"%%1833\",\"LogonGuid\":\"{FBEAEF6D-F1DA-F8AD-A2B2-A3A9AAC706AD}\",\"LmPackageName\":\"-\",\"RestrictedAdminMode\":\"-\",\"VirtualAccount\":\"%%1843\",\"TransmittedServices\":\"-\",\"WorkstationName\":\"-\",\"TargetOutboundDomainName\":\"-\",\"IpAddress\":\"-\",\"ProcessName\":\"-\",\"TargetDomainName\":\"FOOBAR.NET\",\"KeyLength\":\"0\",\"ElevatedToken\":\"%%1842\",\"SubjectUserSid\":\"S-1-0-0\",\"TargetOutboundUserName\":\"-\",\"LogonType\":\"3\",\"SubjectUserName\":\"-\",\"LogonProcessName\":\"Kerberos\",\"SubjectDomainName\":\"-\",\"IpPort\":\"-\"},\"activity_id\":\"{DBC05D38-994B-0003-395D-C0DB4B99D901}\",\"record_id\":131091844,\"provider_guid\":\"{54849625-5478-4994-A5BA-3E3B0328C30D}\",\"opcode\":\"Info\",\"keywords\":[\"Audit Success\"],\"provider_name\":\"Microsoft-Windows-Security-Auditing\",\"task\":\"Logon\",\"channel\":\"Security\",\"computer_name\":\"VM-FOO.FOOBAR.NET\",\"version\":2,\"event_id\":4624,\"api\":\"wineventlog\"},\"log\":{\"level\":\"information\"},\"event\":{\"code\":4624,\"kind\":\"event\",\"action\":\"Logon\",\"created\":\"2023-06-23T08:15:47.185Z\"},\"@version\":\"1\",\"message\":\"An account was successfully logged on.\\n\\nSubject:\\n\\tSecurity ID:\\t\\tS-1-0-0\\n\\tAccount Name:\\t\\t-\\n\\tAccount Domain:\\t\\t-\\n\\tLogon ID:\\t\\t0x0\\n\\nLogon Information:\\n\\tLogon Type:\\t\\t3\\n\\tRestricted Admin Mode:\\t-\\n\\tVirtual Account:\\t\\tNo\\n\\tElevated Token:\\t\\tYes\\n\\nImpersonation Level:\\t\\tImpersonation\\n\\nNew Logon:\\n\\tSecurity ID:\\t\\tS-1-5-21-776561741-920026266-725345543-12737\\n\\tAccount Name:\\t\\tFOO-FARM-ADMIN\\n\\tAccount Domain:\\t\\tFOOBAR.NET\\n\\tLogon ID:\\t\\t0x2374A6A43\\n\\tLinked Logon ID:\\t\\t0x0\\n\\tNetwork Account Name:\\t-\\n\\tNetwork Account Domain:\\t-\\n\\tLogon GUID:\\t\\t{FBEAEF6D-F1DA-F8AD-A2B2-A3A9AAC706AD}\\n\\nProcess Information:\\n\\tProcess ID:\\t\\t0x0\\n\\tProcess Name:\\t\\t-\\n\\nNetwork Information:\\n\\tWorkstation Name:\\t-\\n\\tSource Network Address:\\t-\\n\\tSource Port:\\t\\t-\\n\\nDetailed Authentication Information:\\n\\tLogon Process:\\t\\tKerberos\\n\\tAuthentication Package:\\tKerberos\\n\\tTransited Services:\\t-\\n\\tPackage Name (NTLM only):\\t-\\n\\tKey Length:\\t\\t0\\n\\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\\n\\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\\n\\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\\n\\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\\n\\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\\n\\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\\n\\nThe authentication information fields provide detailed information about this specific logon request.\\n\\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\\n\\t- Transited services indicate which intermediate services have participated in this logon request.\\n\\t- Package name indicates which sub-protocol was used among the NTLM protocols.\\n\\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\"}",
        "event": {
            "action": "authentication_network",
            "code": "4624",
            "kind": "event",
            "original": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-776561741-920026266-725345543-12737\n\tAccount Name:\t\tFOO-FARM-ADMIN\n\tAccount Domain:\t\tFOOBAR.NET\n\tLogon ID:\t\t0x2374A6A43\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{FBEAEF6D-F1DA-F8AD-A2B2-A3A9AAC706AD}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t-\n\tSource Port:\t\t-\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.",
            "hash": "009b8a99fa360981d2f0407a8513d7742fc6a311",
            "category": [
                "authentication"
            ],
            "type": [
                "start"
            ]
        },
        "sekoiaio": {
            "client": {
                "os": {
                    "type": "windows"
                },
                "name": "VM-FOO"
            },
            "server": {
                "name": "VM-FOO",
                "os": {
                    "type": "windows"
                }
            }
        },
        "@timestamp": "2023-06-23T08:15:46.358000Z",
        "action": {
            "properties": {
                "TargetLogonId": "0x2374a6a43",
                "SubjectLogonId": "0x0",
                "TargetUserName": "FOO-FARM-ADMIN",
                "TargetUserSid": "S-1-5-21-776561741-920026266-725345543-12737",
                "TargetLinkedLogonId": "0x0",
                "ProcessId": "0x0",
                "AuthenticationPackageName": "Kerberos",
                "ImpersonationLevel": "%%1833",
                "LogonGuid": "{FBEAEF6D-F1DA-F8AD-A2B2-A3A9AAC706AD}",
                "LmPackageName": "-",
                "RestrictedAdminMode": "-",
                "VirtualAccount": "%%1843",
                "TransmittedServices": "-",
                "WorkstationName": "-",
                "TargetOutboundDomainName": "-",
                "IpAddress": "-",
                "ProcessName": "-",
                "TargetDomainName": "FOOBAR.NET",
                "KeyLength": "0",
                "ElevatedToken": "%%1842",
                "SubjectUserSid": "S-1-0-0",
                "TargetOutboundUserName": "-",
                "LogonType": "3",
                "SubjectUserName": "-",
                "LogonProcessName": "Kerberos",
                "SubjectDomainName": "-",
                "IpPort": "-"
            },
            "id": 4624,
            "outcome": "success"
        },
        "user": {
            "target": {
                "name": "FOO-FARM-ADMIN",
                "domain": "FOOBAR.NET",
                "id": "S-1-5-21-776561741-920026266-725345543-12737"
            },
            "id": "S-1-0-0"
        },
        "agent": {
            "id": "c1e16f64-cfc4-4141-bdc0-71f2a0e45791",
            "ephemeral_id": "21a6bd0d-afb5-4e55-827e-5329797579a4",
            "version": "7.0.0",
            "type": "winlogbeat"
        },
        "host": {
            "os": {
                "build": "14393.5921",
                "kernel": "10.0.14393.5921 (rs1_release.230504-1649)",
                "version": "10.0",
                "name": "Windows Server 2016 Datacenter",
                "family": "windows",
                "platform": "windows"
            },
            "id": "8ea16272-0ba2-4838-b321-1646a493a128",
            "hostname": "VM-FOO",
            "architecture": "x86_64",
            "name": "VM-FOO"
        },
        "log": {
            "level": "information"
        },
        "winlog": {
            "process": {
                "pid": 756,
                "thread": {
                    "id": 13000
                }
            },
            "activity_id": "{dbc05d38-994b-0003-395d-c0db4b99d901}",
            "record_id": "131091844",
            "provider_guid": "{54849625-5478-4994-a5ba-3e3b0328c30d}",
            "opcode": "Info",
            "keywords": [
                "Audit Success"
            ],
            "provider_name": "Microsoft-Windows-Security-Auditing",
            "task": "Logon",
            "channel": "Security",
            "computer_name": "VM-FOO.FOOBAR.NET",
            "version": 2,
            "event_id": "4624",
            "api": "wineventlog"
        },
        "related": {
            "hash": [
                "009b8a99fa360981d2f0407a8513d7742fc6a311"
            ],
            "hosts": [
                "VM-FOO"
            ]
        },
        "process": {
            "name": "Kerberos"
        }
    }
    	
	```


=== "event_file_created.json"

    ```json
	
    {
        "message": "{\n  \"fields.gdp-redis\": \"3\",\n  \"message\": \"File created:\\nRuleName: technique_id=T1047,technique_name=File System Permissions Weakness\\nUtcTime: 2023-10-19 11:22:01.885\\nProcessGuid: {abcdef01-2345-6789-abcd-000000000000}\\nProcessId: 4504\\nImage: C:\\\\WINDOWS\\\\system32\\\\svchost.exe\\nTargetFilename: C:\\\\Windows\\\\System32\\\\WinBioDatabase\\\\ABCD1234-E5F6-1234-ABCD-0123456789EF.ABC~DE123abcde.TMP\\nCreationUtcTime: 2023-10-19 11:22:01.885\\nUser: USER\\\\Syst\u00e8me\",\n  \"fields\": {\n    \"gdp-version-winlogbeat\": 3.4,\n    \"gdp-sousparc\": \"prod\",\n    \"gdp-version\": \"2.8\",\n    \"gdp-parc\": \"defaut\",\n    \"gdp-config\": \"desktop\",\n    \"gdp-version-sysmon\": 15,\n    \"gdp-indice\": [\n      \"l-desk\",\n      \"l-desk\"\n    ]\n  },\n  \"@version\": \"1\",\n  \"log\": {\n    \"level\": \"information\"\n  },\n  \"type\": \"R3\",\n  \"agent\": {\n    \"id\": \"001234567-abcd-ef01-2345-6789abcdef01\",\n    \"ephemeral_id\": \"a0b1c2d3-0123-4567-abcd-e4f5a6b7c8d9\",\n    \"name\": \"WB-DK-PC01234567\",\n    \"type\": \"winlogbeat\",\n    \"version\": \"8.8.2\"\n  },\n  \"event\": {\n    \"provider\": \"Microsoft-Windows-Sysmon\",\n    \"action\": \"File created (rule: FileCreate)\",\n    \"created\": \"2023-10-19T11:22:03.054Z\",\n    \"kind\": \"event\",\n    \"code\": \"11\"\n  },\n  \"event_ingest_logstash\": \"2023-10-19T11:22:03.810843Z\",\n  \"fields.gdp-logstash\": \"6\",\n  \"winlog\": {\n    \"process\": {\n      \"thread\": {\n        \"id\": 7408\n      },\n      \"pid\": 4524\n    },\n    \"user\": {\n      \"name\": \"Syst\u00e8me\",\n      \"type\": \"Well Known Group\",\n      \"identifier\": \"S-1-2-3\",\n      \"domain\": \"USER\"\n    },\n    \"event_id\": \"11\",\n    \"api\": \"wineventlog\",\n    \"record_id\": 5103594,\n    \"provider_name\": \"Microsoft-Windows-Sysmon\",\n    \"version\": 2,\n    \"provider_guid\": \"{a0b1c2d3-1234-abcd-e4f5-0123456789ab}\",\n    \"task\": \"File created (rule: FileCreate)\",\n    \"channel\": \"Microsoft-Windows-Sysmon/Operational\",\n    \"event_data\": {\n      \"TargetFilename\": \"C:\\\\Windows\\\\System32\\\\WinBioDatabase\\\\ABCD1234-E5F6-1234-ABCD-0123456789EF.ABC~DE123abcde.TMP\",\n      \"UtcTime\": \"2023-10-19 11:22:01.885\",\n      \"User\": \"USER\\\\Syst\u00e8me\",\n      \"ProcessId\": \"4504\",\n      \"ProcessGuid\": \"{abcdef01-2345-6789-abcd-000000000000}\",\n      \"Image\": \"C:\\\\WINDOWS\\\\system32\\\\svchost.exe\",\n      \"CreationUtcTime\": \"2023-10-19 11:22:01.885\",\n      \"RuleName\": \"technique_id=T1047,technique_name=File System Permissions Weakness\"\n    },\n    \"computer_name\": \"PC01234567.company.com\",\n    \"opcode\": \"Informations\"\n  },\n  \"ecs\": {\n    \"version\": \"8.0.0\"\n  },\n  \"host\": {\n    \"id\": \"a0b1c2d3-0123-abcd-0a1b-abcd0123ef45\",\n    \"name\": \"PC01234567\",\n    \"mac\": [\n      \"00:11:22:33:44:55\",\n      \"AA:BB:CC:DD:EE:FF\",\n      \"A0:B1:C2:D3:E4:F5\",\n      \"66:77:88:99:00:11\",\n      \"01:23:45:67:89:AB\",\n      \"AB:CD:EF:01:23:45\"\n    ],\n    \"hostname\": \"PC01234567\",\n    \"os\": {\n      \"name\": \"Windows 10 Enterprise\",\n      \"platform\": \"windows\",\n      \"version\": \"10.0\",\n      \"kernel\": \"10.0.19041.3448 (WinBuild.160101.0800)\",\n      \"build\": \"19045.3448\",\n      \"type\": \"windows\",\n      \"family\": \"windows\"\n    },\n    \"ip\": [\n      \"a123::b234:c345:d456:e567\",\n      \"8.8.8.8\",\n      \"abcd::ef01:2345:6789:abcd\",\n      \"1.2.3.4\",\n      \"a0b1::c2d3:e4f5:0123:abcd\",\n      \"10.20.30.40\",\n      \"aabb::ccdd:eeff:0011:2233\",\n      \"0.0.0.0\",\n      \"1122::3344:5566:7788:9900\",\n      \"5.6.7.8\",\n      \"0011::2233:4455:6677:8899\",\n      \"40.30.20.10\"\n    ],\n    \"architecture\": \"x86_64\"\n  },\n  \"@timestamp\": \"2023-10-19T11:22:01.893Z\"\n}",
        "event": {
            "action": "File created (rule: FileCreate)",
            "code": "11",
            "kind": "event",
            "provider": "Microsoft-Windows-Sysmon",
            "original": "File created:\nRuleName: technique_id=T1047,technique_name=File System Permissions Weakness\nUtcTime: 2023-10-19 11:22:01.885\nProcessGuid: {abcdef01-2345-6789-abcd-000000000000}\nProcessId: 4504\nImage: C:\\WINDOWS\\system32\\svchost.exe\nTargetFilename: C:\\Windows\\System32\\WinBioDatabase\\ABCD1234-E5F6-1234-ABCD-0123456789EF.ABC~DE123abcde.TMP\nCreationUtcTime: 2023-10-19 11:22:01.885\nUser: USER\\Syst\u00e8me",
            "hash": "f36f2afa3064bbc299bada6970625b559ca8956f"
        },
        "@timestamp": "2023-10-19T11:22:01.893000Z",
        "action": {
            "properties": {
                "TargetFilename": "C:\\Windows\\System32\\WinBioDatabase\\ABCD1234-E5F6-1234-ABCD-0123456789EF.ABC~DE123abcde.TMP",
                "UtcTime": "2023-10-19 11:22:01.885",
                "User": "USER\\Syst\u00e8me",
                "ProcessId": "4504",
                "ProcessGuid": "{abcdef01-2345-6789-abcd-000000000000}",
                "Image": "C:\\WINDOWS\\system32\\svchost.exe",
                "CreationUtcTime": "2023-10-19 11:22:01.885",
                "RuleName": "technique_id=T1047,technique_name=File System Permissions Weakness"
            },
            "id": 11
        },
        "agent": {
            "id": "001234567-abcd-ef01-2345-6789abcdef01",
            "ephemeral_id": "a0b1c2d3-0123-4567-abcd-e4f5a6b7c8d9",
            "name": "WB-DK-PC01234567",
            "type": "winlogbeat",
            "version": "8.8.2"
        },
        "file": {
            "directory": "C:\\Windows\\System32\\WinBioDatabase",
            "name": "ABCD1234-E5F6-1234-ABCD-0123456789EF.ABC~DE123abcde.TMP",
            "path": "C:\\Windows\\System32\\WinBioDatabase\\ABCD1234-E5F6-1234-ABCD-0123456789EF.ABC~DE123abcde.TMP",
            "extension": "TMP",
            "drive_letter": "C"
        },
        "host": {
            "id": "a0b1c2d3-0123-abcd-0a1b-abcd0123ef45",
            "name": "PC01234567",
            "mac": [
                "00:11:22:33:44:55",
                "AA:BB:CC:DD:EE:FF",
                "A0:B1:C2:D3:E4:F5",
                "66:77:88:99:00:11",
                "01:23:45:67:89:AB",
                "AB:CD:EF:01:23:45"
            ],
            "hostname": "PC01234567",
            "os": {
                "name": "Windows 10 Enterprise",
                "platform": "windows",
                "version": "10.0",
                "kernel": "10.0.19041.3448 (WinBuild.160101.0800)",
                "build": "19045.3448",
                "type": "windows",
                "family": "windows"
            },
            "ip": [
                "a123::b234:c345:d456:e567",
                "8.8.8.8",
                "abcd::ef01:2345:6789:abcd",
                "1.2.3.4",
                "a0b1::c2d3:e4f5:123:abcd",
                "10.20.30.40",
                "aabb::ccdd:eeff:11:2233",
                "0.0.0.0",
                "1122::3344:5566:7788:9900",
                "5.6.7.8",
                "11::2233:4455:6677:8899",
                "40.30.20.10"
            ],
            "architecture": "x86_64"
        },
        "log": {
            "level": "information"
        },
        "process": {
            "executable": "C:\\WINDOWS\\system32\\svchost.exe",
            "name": "svchost.exe"
        },
        "winlog": {
            "process": {
                "thread": {
                    "id": 7408
                },
                "pid": 4524
            },
            "user": {
                "name": "Syst\u00e8me",
                "type": "Well Known Group",
                "identifier": "S-1-2-3",
                "domain": "USER"
            },
            "event_id": "11",
            "api": "wineventlog",
            "record_id": "5103594",
            "provider_name": "Microsoft-Windows-Sysmon",
            "version": 2,
            "provider_guid": "{a0b1c2d3-1234-abcd-e4f5-0123456789ab}",
            "task": "File created (rule: FileCreate)",
            "channel": "Microsoft-Windows-Sysmon/Operational",
            "computer_name": "PC01234567.company.com",
            "opcode": "Informations"
        },
        "related": {
            "hash": [
                "f36f2afa3064bbc299bada6970625b559ca8956f"
            ],
            "ip": [
                "0.0.0.0",
                "1.2.3.4",
                "10.20.30.40",
                "1122::3344:5566:7788:9900",
                "11::2233:4455:6677:8899",
                "40.30.20.10",
                "5.6.7.8",
                "8.8.8.8",
                "a0b1::c2d3:e4f5:123:abcd",
                "a123::b234:c345:d456:e567",
                "aabb::ccdd:eeff:11:2233",
                "abcd::ef01:2345:6789:abcd"
            ],
            "hosts": [
                "PC01234567"
            ]
        }
    }
    	
	```


=== "event_process_create_1.json"

    ```json
	
    {
        "message": "{\n  \"winlog\": {\n    \"event_data\": {\n      \"Product\": \"Microsoft Teams\",\n      \"RuleName\": \"technique_id=T1036,technique_name=Masquerading\",\n      \"CommandLine\": \"\\\"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\\\" --type=renderer --enable-wer --user-data-dir=\\\"C:\\\\Users\\\\asmithee\\\\AppData\\\\Roaming\\\\Microsoft\\\\Teams\\\" --ms-teams-less-cors=522133263 --app-user-model-id=com.squirrel.Teams.Teams --app-path=\\\"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\resources\\\\app.test\\\" --autoplay-policy=no-user-gesture-required --disable-background-timer-throttling --lang=fr --device-scale-factor=1 --num-raster-threads=3 --enable-main-frame-before-activation --renderer-client-id=89 --launch-time-ticks=212569133487 --mojo-platform-channel-handle=6672 --field-trial-handle=1780,i,5843992499021049077,4525004813667802135,131072 --enable-features=ContextBridgeMutability,SharedArrayBuffer,WinUseBrowserSpellChecker,WinUseHybridSpellChecker --disable-features=CalculateNativeWinOcclusion,ExtraCookieValidityChecks,ForcedColors,SpareRendererForSitePerProcess,WinRetrieveSuggestionsOnlyOnDemand /prefetch:1\",\n      \"FileVersion\": \"1.6.00.27573\",\n      \"ParentCommandLine\": \"\\\"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\\\" \",\n      \"LogonGuid\": \"{abcdef01-b1c2-d3c4-1234-123400000000}\",\n      \"ParentProcessGuid\": \"{10fecdba-1234-abcd-0a1b-000000000000}\",\n      \"Hashes\": \"SHA1=68D25B5F5A57CF5DC0D63644338C04EA906D472B,MD5=89B717809A5A49D19E7E06746982BF0B,SHA256=2024533463DF3C945A74C774858285915FFB4E083031B51B8135BBBF5E8FC5EE,IMPHASH=00590C8FDC1F372F8DB1D3F49D342D34\",\n      \"User\": \"COMPANY\\\\asmithee\",\n      \"ProcessId\": \"4980\",\n      \"LogonId\": \"0x1234abc\",\n      \"ProcessGuid\": \"{10fecdba-1234-abcd-0a1b-000000000000}\",\n      \"Description\": \"Microsoft Teams\",\n      \"OriginalFileName\": \"Teams.exe\",\n      \"Image\": \"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\",\n      \"CurrentDirectory\": \"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\\",\n      \"ParentImage\": \"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\",\n      \"IntegrityLevel\": \"Low\",\n      \"ParentProcessId\": \"1124\",\n      \"Company\": \"Microsoft Corporation\",\n      \"TerminalSessionId\": \"1\",\n      \"UtcTime\": \"2023-10-17 12:03:14.183\",\n      \"ParentUser\": \"COMPANY\\\\asmithee\"\n    },\n    \"task\": \"Process Create (rule: ProcessCreate)\",\n    \"channel\": \"Microsoft-Windows-Sysmon/Operational\",\n    \"user\": {\n      \"name\": \"Syst\u00e8me\",\n      \"identifier\": \"S-1-2-3\",\n      \"type\": \"Well Known Group\",\n      \"domain\": \"Domain\"\n    },\n    \"event_id\": \"1\",\n    \"provider_guid\": \"{a0b1c2d3-1234-abcd-e4f5-0123456789ab}\",\n    \"process\": {\n      \"thread\": {\n        \"id\": 5760\n      },\n      \"pid\": 3852\n    },\n    \"api\": \"wineventlog\",\n    \"version\": 5,\n    \"computer_name\": \"PC01234567.company.com\",\n    \"record_id\": 9359683,\n    \"provider_name\": \"Microsoft-Windows-Sysmon\",\n    \"opcode\": \"Informations\"\n  },\n  \"message\": \"Process Create:\\nRuleName: technique_id=T1036,technique_name=Masquerading\\nUtcTime: 2023-10-17 12:03:14.183\\nProcessGuid: {10fecdba-1234-abcd-0a1b-000000000000}\\nProcessId: 4980\\nImage: C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\\nFileVersion: 1.6.00.27573\\nDescription: Microsoft Teams\\nProduct: Microsoft Teams\\nCompany: Microsoft Corporation\\nOriginalFileName: Teams.exe\\nCommandLine: \\\"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\\\" --type=renderer --enable-wer --user-data-dir=\\\"C:\\\\Users\\\\asmithee\\\\AppData\\\\Roaming\\\\Microsoft\\\\Teams\\\" --ms-teams-less-cors=522133263 --app-user-model-id=com.squirrel.Teams.Teams --app-path=\\\"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\resources\\\\app.test\\\" --autoplay-policy=no-user-gesture-required --disable-background-timer-throttling --lang=fr --device-scale-factor=1 --num-raster-threads=3 --enable-main-frame-before-activation --renderer-client-id=89 --launch-time-ticks=212569133487 --mojo-platform-channel-handle=6672 --field-trial-handle=1780,i,5843992499021049077,4525004813667802135,131072 --enable-features=ContextBridgeMutability,SharedArrayBuffer,WinUseBrowserSpellChecker,WinUseHybridSpellChecker --disable-features=CalculateNativeWinOcclusion,ExtraCookieValidityChecks,ForcedColors,SpareRendererForSitePerProcess,WinRetrieveSuggestionsOnlyOnDemand /prefetch:1\\nCurrentDirectory: C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\\\nUser: COMPANY\\\\asmithee\\nLogonGuid: {abcdef01-b1c2-d3c4-1234-123400000000}\\nLogonId: 0x1234abc\\nTerminalSessionId: 1\\nIntegrityLevel: Low\\nHashes: SHA1=68D25B5F5A57CF5DC0D63644338C04EA906D472B,MD5=89B717809A5A49D19E7E06746982BF0B,SHA256=2024533463DF3C945A74C774858285915FFB4E083031B51B8135BBBF5E8FC5EE,IMPHASH=00590C8FDC1F372F8DB1D3F49D342D34\\nParentProcessGuid: {10fecdba-1234-abcd-0a1b-000000000000}\\nParentProcessId: 1124\\nParentImage: C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\\nParentCommandLine: \\\"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\\\" \\nParentUser: COMPANY\\\\asmithee\",\n  \"event_ingest_logstash\": \"2023-10-17T12:03:18.802068Z\",\n  \"fields.gdp-logstash\": \"6\",\n  \"event\": {\n    \"kind\": \"event\",\n    \"provider\": \"Microsoft-Windows-Sysmon\",\n    \"created\": \"2023-10-17T12:03:17.092Z\",\n    \"code\": \"1\",\n    \"action\": \"Process Create (rule: ProcessCreate)\"\n  },\n  \"@version\": \"1\",\n  \"log\": {\n    \"level\": \"information\"\n  },\n  \"ecs\": {\n    \"version\": \"8.0.0\"\n  },\n  \"@timestamp\": \"2023-10-17T12:03:15.436Z\",\n  \"fields.gdp-redis\": \"2\",\n  \"fields\": {\n    \"gdp-parc\": \"defaut\",\n    \"gdp-version-winlogbeat\": 3.4,\n    \"gdp-indice\": [\n      \"l-desk\",\n      \"l-desk\"\n    ],\n    \"gdp-sousparc\": \"prod\",\n    \"gdp-version\": \"2.8\",\n    \"gdp-config\": \"desktop\",\n    \"gdp-version-sysmon\": 15\n  },\n  \"host\": {\n    \"os\": {\n      \"platform\": \"windows\",\n      \"name\": \"Windows 10 Enterprise\",\n      \"version\": \"10.0\",\n      \"kernel\": \"10.0.19041.3448 (WinBuild.160101.0800)\",\n      \"build\": \"19045.3448\",\n      \"family\": \"windows\",\n      \"type\": \"windows\"\n    },\n    \"mac\": [\n      \"A1-B2-C3-D4-E5-F6\"\n    ],\n    \"name\": \"PC01234567\",\n    \"id\": \"a0b1c2d3-0123-abcd-0a1b-abcd0123ef45\",\n    \"hostname\": \"PC01234567\",\n    \"architecture\": \"x86_64\",\n    \"ip\": [\n      \"a123::b234:c345:d456:e567\",\n      \"8.8.8.8\"\n    ]\n  },\n  \"type\": \"R2\",\n  \"agent\": {\n    \"id\": \"01234567-abcd-ef01-2345-6789abcdef01\",\n    \"name\": \"WB-DK-PC01234567\",\n    \"version\": \"8.8.2\",\n    \"ephemeral_id\": \"a0b1c2d3-0123-4567-abcd-e4f5a6b7c8d9\",\n    \"type\": \"winlogbeat\"\n  }\n}",
        "event": {
            "action": "Process Create (rule: ProcessCreate)",
            "code": "1",
            "kind": "event",
            "provider": "Microsoft-Windows-Sysmon",
            "original": "Process Create:\nRuleName: technique_id=T1036,technique_name=Masquerading\nUtcTime: 2023-10-17 12:03:14.183\nProcessGuid: {10fecdba-1234-abcd-0a1b-000000000000}\nProcessId: 4980\nImage: C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe\nFileVersion: 1.6.00.27573\nDescription: Microsoft Teams\nProduct: Microsoft Teams\nCompany: Microsoft Corporation\nOriginalFileName: Teams.exe\nCommandLine: \"C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe\" --type=renderer --enable-wer --user-data-dir=\"C:\\Users\\asmithee\\AppData\\Roaming\\Microsoft\\Teams\" --ms-teams-less-cors=522133263 --app-user-model-id=com.squirrel.Teams.Teams --app-path=\"C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\resources\\app.test\" --autoplay-policy=no-user-gesture-required --disable-background-timer-throttling --lang=fr --device-scale-factor=1 --num-raster-threads=3 --enable-main-frame-before-activation --renderer-client-id=89 --launch-time-ticks=212569133487 --mojo-platform-channel-handle=6672 --field-trial-handle=1780,i,5843992499021049077,4525004813667802135,131072 --enable-features=ContextBridgeMutability,SharedArrayBuffer,WinUseBrowserSpellChecker,WinUseHybridSpellChecker --disable-features=CalculateNativeWinOcclusion,ExtraCookieValidityChecks,ForcedColors,SpareRendererForSitePerProcess,WinRetrieveSuggestionsOnlyOnDemand /prefetch:1\nCurrentDirectory: C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\\nUser: COMPANY\\asmithee\nLogonGuid: {abcdef01-b1c2-d3c4-1234-123400000000}\nLogonId: 0x1234abc\nTerminalSessionId: 1\nIntegrityLevel: Low\nHashes: SHA1=68D25B5F5A57CF5DC0D63644338C04EA906D472B,MD5=89B717809A5A49D19E7E06746982BF0B,SHA256=2024533463DF3C945A74C774858285915FFB4E083031B51B8135BBBF5E8FC5EE,IMPHASH=00590C8FDC1F372F8DB1D3F49D342D34\nParentProcessGuid: {10fecdba-1234-abcd-0a1b-000000000000}\nParentProcessId: 1124\nParentImage: C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe\nParentCommandLine: \"C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe\" \nParentUser: COMPANY\\asmithee",
            "hash": "bddeaca04a56e79e76ded95babeaa07f36b3935e"
        },
        "@timestamp": "2023-10-17T12:03:15.436000Z",
        "action": {
            "properties": {
                "Product": "Microsoft Teams",
                "RuleName": "technique_id=T1036,technique_name=Masquerading",
                "CommandLine": "\"C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe\" --type=renderer --enable-wer --user-data-dir=\"C:\\Users\\asmithee\\AppData\\Roaming\\Microsoft\\Teams\" --ms-teams-less-cors=522133263 --app-user-model-id=com.squirrel.Teams.Teams --app-path=\"C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\resources\\app.test\" --autoplay-policy=no-user-gesture-required --disable-background-timer-throttling --lang=fr --device-scale-factor=1 --num-raster-threads=3 --enable-main-frame-before-activation --renderer-client-id=89 --launch-time-ticks=212569133487 --mojo-platform-channel-handle=6672 --field-trial-handle=1780,i,5843992499021049077,4525004813667802135,131072 --enable-features=ContextBridgeMutability,SharedArrayBuffer,WinUseBrowserSpellChecker,WinUseHybridSpellChecker --disable-features=CalculateNativeWinOcclusion,ExtraCookieValidityChecks,ForcedColors,SpareRendererForSitePerProcess,WinRetrieveSuggestionsOnlyOnDemand /prefetch:1",
                "FileVersion": "1.6.00.27573",
                "ParentCommandLine": "\"C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe\" ",
                "LogonGuid": "{abcdef01-b1c2-d3c4-1234-123400000000}",
                "ParentProcessGuid": "{10fecdba-1234-abcd-0a1b-000000000000}",
                "Hashes": "SHA1=68D25B5F5A57CF5DC0D63644338C04EA906D472B,MD5=89B717809A5A49D19E7E06746982BF0B,SHA256=2024533463DF3C945A74C774858285915FFB4E083031B51B8135BBBF5E8FC5EE,IMPHASH=00590C8FDC1F372F8DB1D3F49D342D34",
                "User": "COMPANY\\asmithee",
                "ProcessId": "4980",
                "LogonId": "0x1234abc",
                "ProcessGuid": "{10fecdba-1234-abcd-0a1b-000000000000}",
                "Description": "Microsoft Teams",
                "OriginalFileName": "Teams.exe",
                "Image": "C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe",
                "CurrentDirectory": "C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\",
                "ParentImage": "C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe",
                "IntegrityLevel": "Low",
                "ParentProcessId": "1124",
                "Company": "Microsoft Corporation",
                "TerminalSessionId": "1",
                "UtcTime": "2023-10-17 12:03:14.183",
                "ParentUser": "COMPANY\\asmithee"
            },
            "id": 1
        },
        "agent": {
            "id": "01234567-abcd-ef01-2345-6789abcdef01",
            "name": "WB-DK-PC01234567",
            "version": "8.8.2",
            "ephemeral_id": "a0b1c2d3-0123-4567-abcd-e4f5a6b7c8d9",
            "type": "winlogbeat"
        },
        "host": {
            "os": {
                "platform": "windows",
                "name": "Windows 10 Enterprise",
                "version": "10.0",
                "kernel": "10.0.19041.3448 (WinBuild.160101.0800)",
                "build": "19045.3448",
                "family": "windows",
                "type": "windows"
            },
            "mac": [
                "A1-B2-C3-D4-E5-F6"
            ],
            "name": "PC01234567",
            "id": "a0b1c2d3-0123-abcd-0a1b-abcd0123ef45",
            "hostname": "PC01234567",
            "architecture": "x86_64",
            "ip": [
                "a123::b234:c345:d456:e567",
                "8.8.8.8"
            ]
        },
        "log": {
            "level": "information"
        },
        "process": {
            "command_line": "\"C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe\" --type=renderer --enable-wer --user-data-dir=\"C:\\Users\\asmithee\\AppData\\Roaming\\Microsoft\\Teams\" --ms-teams-less-cors=522133263 --app-user-model-id=com.squirrel.Teams.Teams --app-path=\"C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\resources\\app.test\" --autoplay-policy=no-user-gesture-required --disable-background-timer-throttling --lang=fr --device-scale-factor=1 --num-raster-threads=3 --enable-main-frame-before-activation --renderer-client-id=89 --launch-time-ticks=212569133487 --mojo-platform-channel-handle=6672 --field-trial-handle=1780,i,5843992499021049077,4525004813667802135,131072 --enable-features=ContextBridgeMutability,SharedArrayBuffer,WinUseBrowserSpellChecker,WinUseHybridSpellChecker --disable-features=CalculateNativeWinOcclusion,ExtraCookieValidityChecks,ForcedColors,SpareRendererForSitePerProcess,WinRetrieveSuggestionsOnlyOnDemand /prefetch:1",
            "executable": "C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe",
            "name": "Teams.exe",
            "parent": {
                "executable": "C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe",
                "name": "Teams.exe"
            },
            "working_directory": "C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\",
            "pe": {
                "original_file_name": "Teams.exe"
            },
            "hash": {
                "md5": "89B717809A5A49D19E7E06746982BF0B",
                "sha1": "68D25B5F5A57CF5DC0D63644338C04EA906D472B",
                "sha256": "2024533463DF3C945A74C774858285915FFB4E083031B51B8135BBBF5E8FC5EE"
            }
        },
        "winlog": {
            "task": "Process Create (rule: ProcessCreate)",
            "channel": "Microsoft-Windows-Sysmon/Operational",
            "user": {
                "name": "Syst\u00e8me",
                "identifier": "S-1-2-3",
                "type": "Well Known Group",
                "domain": "Domain"
            },
            "event_id": "1",
            "provider_guid": "{a0b1c2d3-1234-abcd-e4f5-0123456789ab}",
            "process": {
                "thread": {
                    "id": 5760
                },
                "pid": 3852
            },
            "api": "wineventlog",
            "version": 5,
            "computer_name": "PC01234567.company.com",
            "record_id": "9359683",
            "provider_name": "Microsoft-Windows-Sysmon",
            "opcode": "Informations"
        },
        "related": {
            "hash": [
                "2024533463DF3C945A74C774858285915FFB4E083031B51B8135BBBF5E8FC5EE",
                "68D25B5F5A57CF5DC0D63644338C04EA906D472B",
                "89B717809A5A49D19E7E06746982BF0B",
                "bddeaca04a56e79e76ded95babeaa07f36b3935e"
            ],
            "ip": [
                "8.8.8.8",
                "a123::b234:c345:d456:e567"
            ],
            "hosts": [
                "PC01234567"
            ]
        }
    }
    	
	```


=== "event_process_create_2.json"

    ```json
	
    {
        "message": "{\n  \"winlog\": {\n    \"event_data\": {\n      \"IntegrityLevel\": \"Low\",\n      \"Product\": \"Microsoft Teams\",\n      \"Description\": \"Microsoft Teams\",\n      \"LogonId\": \"0x1234abc\",\n      \"TerminalSessionId\": \"1\",\n      \"FileVersion\": \"1.6.00.27573\",\n      \"LogonGuid\": \"{abcdef01-b1c2-d3c4-1234-123400000000}\",\n      \"Company\": \"Microsoft Corporation\",\n      \"ParentUser\": \"COMPANY\\\\asmithee\"\n    },\n    \"task\": \"Process Create (rule: ProcessCreate)\",\n    \"channel\": \"Microsoft-Windows-Sysmon/Operational\",\n    \"user\": {\n      \"name\": \"Syst\u00e8me\",\n      \"identifier\": \"S-1-2-3\",\n      \"type\": \"User\",\n      \"domain\": \"DOMAIN\"\n    },\n    \"api\": \"wineventlog\",\n    \"provider_guid\": \"{a0b1c2d3-1234-abcd-e4f5-0123456789ab}\",\n    \"process\": {\n      \"thread\": {\n        \"id\": 7248\n      },\n      \"pid\": 5624\n    },\n    \"event_id\": \"1\",\n    \"version\": 5,\n    \"computer_name\": \"PC01234567.company.com\",\n    \"record_id\": 67177799,\n    \"opcode\": \"Informations\",\n    \"provider_name\": \"Microsoft-Windows-Sysmon\"\n  },\n  \"message\": \"Process Create:\\nRuleName: technique_id=T1036,technique_name=Masquerading\\nUtcTime: 2023-10-17 12:05:25.091\\nProcessGuid: {1c03cf6e-7885-652e-190c-00000000fa00}\\nProcessId: 27804\\nImage: C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\\nFileVersion: 1.6.00.27573\\nDescription: Microsoft Teams\\nProduct: Microsoft Teams\\nCompany: Microsoft Corporation\\nOriginalFileName: Teams.exe\\nCommandLine: \\\"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\\\" --type=renderer --enable-wer --user-data-dir=\\\"C:\\\\Users\\\\asmithee\\\\AppData\\\\Roaming\\\\Microsoft\\\\Teams\\\" --ms-teams-less-cors=522133263 --app-user-model-id=com.squirrel.Teams.Teams --app-path=\\\"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\resources\\\\app.test\\\" --autoplay-policy=no-user-gesture-required --disable-background-timer-throttling --lang=fr --device-scale-factor=1.25 --num-raster-threads=4 --enable-main-frame-before-activation --renderer-client-id=196 --launch-time-ticks=17880973283 --mojo-platform-channel-handle=2520 --field-trial-handle=1808,i,7578868639254466484,17758186584081941877,131072 --enable-features=ContextBridgeMutability,SharedArrayBuffer,WinUseBrowserSpellChecker,WinUseHybridSpellChecker --disable-features=CalculateNativeWinOcclusion,ExtraCookieValidityChecks,ForcedColors,SpareRendererForSitePerProcess,WinRetrieveSuggestionsOnlyOnDemand /prefetch:1\\nCurrentDirectory: C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\\\nUser: COMPANY\\\\asmithee\\nLogonGuid: {abcdef01-b1c2-d3c4-1234-123400000000}\\nLogonId: 0x1234ABC\\nTerminalSessionId: 1\\nIntegrityLevel: Low\\nHashes: SHA1=68D25B5F5A57CF5DC0D63644338C04EA906D472B,MD5=89B717809A5A49D19E7E06746982BF0B,SHA256=2024533463DF3C945A74C774858285915FFB4E083031B51B8135BBBF5E8FC5EE,IMPHASH=00590C8FDC1F372F8DB1D3F49D342D34\\nParentProcessGuid: {1c03cf6e-331c-652e-b001-00000000fa00}\\nParentProcessId: 17772\\nParentImage: C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\\nParentCommandLine: \\\"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\\\" --system-initiated\\nParentUser: COMPANY\\\\asmithee\",\n  \"hash\": {\n    \"sha256\": \"2024533463df3c945a74c774858285915ffb4e083031b51b8135bbbf5e8fc5ee\",\n    \"sha1\": \"68d25b5f5a57cf5dc0d63644338c04ea906d472b\",\n    \"md5\": \"89b717809a5a49d19e7e06746982bf0b\",\n    \"imphash\": \"00590c8fdc1f372f8db1d3f49d342d34\"\n  },\n  \"event_ingest_logstash\": \"2023-10-17T12:05:27.363678Z\",\n  \"fields.gdp-logstash\": \"6\",\n  \"user\": {\n    \"name\": \"asmithee\",\n    \"id\": \"S-1-2-3\",\n    \"domain\": \"COMPANY\"\n  },\n  \"event\": {\n    \"created\": \"2023-10-17T12:05:26.268Z\",\n    \"kind\": \"event\",\n    \"provider\": \"Microsoft-Windows-Sysmon\",\n    \"category\": [\n      \"process\"\n    ],\n    \"code\": \"1\",\n    \"module\": \"sysmon\",\n    \"action\": \"Process Create (rule: ProcessCreate)\",\n    \"type\": [\n      \"start\",\n      \"process_start\"\n    ]\n  },\n  \"process\": {\n    \"name\": \"Teams.exe\",\n    \"args\": [\n      \"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\",\n      \"--type=renderer\",\n      \"--enable-wer\",\n      \"--user-data-dir=C:\\\\Users\\\\asmithee\\\\AppData\\\\Roaming\\\\Microsoft\\\\Teams\",\n      \"--ms-teams-less-cors=522133263\",\n      \"--app-user-model-id=com.squirrel.Teams.Teams\",\n      \"--app-path=C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\resources\\\\app.test\",\n      \"--autoplay-policy=no-user-gesture-required\",\n      \"--disable-background-timer-throttling\",\n      \"--lang=fr\",\n      \"--device-scale-factor=1.25\",\n      \"--num-raster-threads=4\",\n      \"--enable-main-frame-before-activation\",\n      \"--renderer-client-id=196\",\n      \"--launch-time-ticks=17880973283\",\n      \"--mojo-platform-channel-handle=2520\",\n      \"--field-trial-handle=1808,i,7578868639254466484,17758186584081941877,131072\",\n      \"--enable-features=ContextBridgeMutability,SharedArrayBuffer,WinUseBrowserSpellChecker,WinUseHybridSpellChecker\",\n      \"--disable-features=CalculateNativeWinOcclusion,ExtraCookieValidityChecks,ForcedColors,SpareRendererForSitePerProcess,WinRetrieveSuggestionsOnlyOnDemand\",\n      \"/prefetch:1\"\n    ],\n    \"hash\": {\n      \"sha256\": \"2024533463df3c945a74c774858285915ffb4e083031b51b8135bbbf5e8fc5ee\",\n      \"sha1\": \"68d25b5f5a57cf5dc0d63644338c04ea906d472b\",\n      \"md5\": \"89b717809a5a49d19e7e06746982bf0b\"\n    },\n    \"entity_id\": \"{abcdef01-2345-6789-abcd-000000000000}\",\n    \"command_line\": \"\\\"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\\\" --type=renderer --enable-wer --user-data-dir=\\\"C:\\\\Users\\\\asmithee\\\\AppData\\\\Roaming\\\\Microsoft\\\\Teams\\\" --ms-teams-less-cors=522133263 --app-user-model-id=com.squirrel.Teams.Teams --app-path=\\\"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\resources\\\\app.test\\\" --autoplay-policy=no-user-gesture-required --disable-background-timer-throttling --lang=fr --device-scale-factor=1.25 --num-raster-threads=4 --enable-main-frame-before-activation --renderer-client-id=196 --launch-time-ticks=17880973283 --mojo-platform-channel-handle=2520 --field-trial-handle=1808,i,7578868639254466484,17758186584081941877,131072 --enable-features=ContextBridgeMutability,SharedArrayBuffer,WinUseBrowserSpellChecker,WinUseHybridSpellChecker --disable-features=CalculateNativeWinOcclusion,ExtraCookieValidityChecks,ForcedColors,SpareRendererForSitePerProcess,WinRetrieveSuggestionsOnlyOnDemand /prefetch:1\",\n    \"pe\": {\n      \"description\": \"Microsoft Teams\",\n      \"company\": \"Microsoft Corporation\",\n      \"file_version\": \"1.6.00.27573\",\n      \"imphash\": \"00590c8fdc1f372f8db1d3f49d342d34\",\n      \"original_file_name\": \"Teams.exe\",\n      \"product\": \"Microsoft Teams\"\n    },\n    \"parent\": {\n      \"name\": \"Teams.exe\",\n      \"args\": [\n        \"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\",\n        \"--system-initiated\"\n      ],\n      \"entity_id\": \"{abcdef01-2345-6789-abcd-000000000000}\",\n      \"command_line\": \"\\\"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\\\" --system-initiated\",\n      \"pid\": 17772,\n      \"executable\": \"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\"\n    },\n    \"pid\": 27804,\n    \"working_directory\": \"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\\",\n    \"executable\": \"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\"\n  },\n  \"@version\": \"1\",\n  \"log\": {\n    \"level\": \"information\"\n  },\n  \"rule\": {\n    \"name\": \"technique_id=T1036,technique_name=Masquerading\"\n  },\n  \"related\": {\n    \"hash\": [\n      \"68d25b5f5a57cf5dc0d63644338c04ea906d472b\",\n      \"89b717809a5a49d19e7e06746982bf0b\",\n      \"2024533463df3c945a74c774858285915ffb4e083031b51b8135bbbf5e8fc5ee\",\n      \"00590c8fdc1f372f8db1d3f49d342d34\"\n    ],\n    \"user\": \"asmithee\"\n  },\n  \"ecs\": {\n    \"version\": \"1.12.0\"\n  },\n  \"@timestamp\": \"2023-10-17T12:05:25.091Z\",\n  \"fields\": {\n    \"gdp-version-sysmon\": 13.33,\n    \"gdp-version-winlogbeat\": 2.8,\n    \"gdp-indice\": \"l-desk\",\n    \"gdp-sousparc\": \"prod\",\n    \"gdp-config\": \"desktop\",\n    \"gdp-version\": \"1.16\",\n    \"gdp-parc\": \"defaut\"\n  },\n  \"host\": {\n    \"id\": \"a0b1c2d3-0123-abcd-0a1b-abcd0123ef45\",\n    \"name\": \"PC01234567.company.com\",\n    \"mac\": [\n      \"00:11:22:33:44:55\",\n      \"aa:bb:cc:dd:ee:ff\",\n      \"a0:b1:c2:d3:e4:f5\",\n      \"66:77:88:99:00:11\",\n      \"01:23:45:67:89:ab\",\n      \"ab:cd:ef:01:23:45\"\n    ],\n    \"os\": {\n      \"platform\": \"windows\",\n      \"name\": \"Windows 10 Enterprise\",\n      \"version\": \"10.0\",\n      \"kernel\": \"10.0.19041.3570 (WinBuild.160101.0800)\",\n      \"build\": \"19044.3570\",\n      \"type\": \"windows\",\n      \"family\": \"windows\"\n    },\n    \"hostname\": \"PC01234567\",\n    \"architecture\": \"x86_64\",\n    \"ip\": [\n      \"a123::b234:c345:d456:e567\",\n      \"8.8.8.8\",\n      \"abcd::ef01:2345:6789:abcd\",\n      \"1.2.3.4\",\n      \"a0b1::c2d3:e4f5:0123:abcd\",\n      \"10.20.30.40\",\n      \"aabb::ccdd:eeff:0011:2233\",\n      \"0.0.0.0\",\n      \"1122::3344:5566:7788:9900\",\n      \"5.6.7.8\",\n      \"0011::2233:4455:6677:8899\",\n      \"40.30.20.10\"\n    ]\n  },\n  \"tags\": [\n    \"beats_input_codec_plain_applied\"\n  ],\n  \"agent\": {\n    \"id\": \"001234567-abcd-ef01-2345-6789abcdef01\",\n    \"name\": \"WB-DK-PC01234567\",\n    \"version\": \"7.17.1\",\n    \"ephemeral_id\": \"a0b1c2d3-0123-4567-abcd-e4f5a6b7c8d9\",\n    \"hostname\": \"PC01234567\",\n    \"type\": \"winlogbeat\"\n  }\n}",
        "event": {
            "action": "Process Create (rule: ProcessCreate)",
            "category": [
                "process"
            ],
            "code": "1",
            "kind": "event",
            "module": "sysmon",
            "provider": "Microsoft-Windows-Sysmon",
            "type": [
                "start",
                "process_start"
            ],
            "original": "Process Create:\nRuleName: technique_id=T1036,technique_name=Masquerading\nUtcTime: 2023-10-17 12:05:25.091\nProcessGuid: {1c03cf6e-7885-652e-190c-00000000fa00}\nProcessId: 27804\nImage: C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe\nFileVersion: 1.6.00.27573\nDescription: Microsoft Teams\nProduct: Microsoft Teams\nCompany: Microsoft Corporation\nOriginalFileName: Teams.exe\nCommandLine: \"C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe\" --type=renderer --enable-wer --user-data-dir=\"C:\\Users\\asmithee\\AppData\\Roaming\\Microsoft\\Teams\" --ms-teams-less-cors=522133263 --app-user-model-id=com.squirrel.Teams.Teams --app-path=\"C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\resources\\app.test\" --autoplay-policy=no-user-gesture-required --disable-background-timer-throttling --lang=fr --device-scale-factor=1.25 --num-raster-threads=4 --enable-main-frame-before-activation --renderer-client-id=196 --launch-time-ticks=17880973283 --mojo-platform-channel-handle=2520 --field-trial-handle=1808,i,7578868639254466484,17758186584081941877,131072 --enable-features=ContextBridgeMutability,SharedArrayBuffer,WinUseBrowserSpellChecker,WinUseHybridSpellChecker --disable-features=CalculateNativeWinOcclusion,ExtraCookieValidityChecks,ForcedColors,SpareRendererForSitePerProcess,WinRetrieveSuggestionsOnlyOnDemand /prefetch:1\nCurrentDirectory: C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\\nUser: COMPANY\\asmithee\nLogonGuid: {abcdef01-b1c2-d3c4-1234-123400000000}\nLogonId: 0x1234ABC\nTerminalSessionId: 1\nIntegrityLevel: Low\nHashes: SHA1=68D25B5F5A57CF5DC0D63644338C04EA906D472B,MD5=89B717809A5A49D19E7E06746982BF0B,SHA256=2024533463DF3C945A74C774858285915FFB4E083031B51B8135BBBF5E8FC5EE,IMPHASH=00590C8FDC1F372F8DB1D3F49D342D34\nParentProcessGuid: {1c03cf6e-331c-652e-b001-00000000fa00}\nParentProcessId: 17772\nParentImage: C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe\nParentCommandLine: \"C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe\" --system-initiated\nParentUser: COMPANY\\asmithee",
            "hash": "3a94cc250153d9666fad8106848c0359d8b887d6"
        },
        "@timestamp": "2023-10-17T12:05:25.091000Z",
        "action": {
            "properties": {
                "IntegrityLevel": "Low",
                "Product": "Microsoft Teams",
                "Description": "Microsoft Teams",
                "LogonId": "0x1234abc",
                "TerminalSessionId": "1",
                "FileVersion": "1.6.00.27573",
                "LogonGuid": "{abcdef01-b1c2-d3c4-1234-123400000000}",
                "Company": "Microsoft Corporation",
                "ParentUser": "COMPANY\\asmithee"
            },
            "id": 1
        },
        "agent": {
            "id": "001234567-abcd-ef01-2345-6789abcdef01",
            "name": "WB-DK-PC01234567",
            "version": "7.17.1",
            "ephemeral_id": "a0b1c2d3-0123-4567-abcd-e4f5a6b7c8d9",
            "type": "winlogbeat"
        },
        "host": {
            "id": "a0b1c2d3-0123-abcd-0a1b-abcd0123ef45",
            "name": "PC01234567.company.com",
            "mac": [
                "00:11:22:33:44:55",
                "aa:bb:cc:dd:ee:ff",
                "a0:b1:c2:d3:e4:f5",
                "66:77:88:99:00:11",
                "01:23:45:67:89:ab",
                "ab:cd:ef:01:23:45"
            ],
            "os": {
                "platform": "windows",
                "name": "Windows 10 Enterprise",
                "version": "10.0",
                "kernel": "10.0.19041.3570 (WinBuild.160101.0800)",
                "build": "19044.3570",
                "type": "windows",
                "family": "windows"
            },
            "hostname": "PC01234567",
            "architecture": "x86_64",
            "ip": [
                "a123::b234:c345:d456:e567",
                "8.8.8.8",
                "abcd::ef01:2345:6789:abcd",
                "1.2.3.4",
                "a0b1::c2d3:e4f5:123:abcd",
                "10.20.30.40",
                "aabb::ccdd:eeff:11:2233",
                "0.0.0.0",
                "1122::3344:5566:7788:9900",
                "5.6.7.8",
                "11::2233:4455:6677:8899",
                "40.30.20.10"
            ]
        },
        "log": {
            "level": "information"
        },
        "process": {
            "name": "Teams.exe",
            "args": [
                "C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe",
                "--type=renderer",
                "--enable-wer",
                "--user-data-dir=C:\\Users\\asmithee\\AppData\\Roaming\\Microsoft\\Teams",
                "--ms-teams-less-cors=522133263",
                "--app-user-model-id=com.squirrel.Teams.Teams",
                "--app-path=C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\resources\\app.test",
                "--autoplay-policy=no-user-gesture-required",
                "--disable-background-timer-throttling",
                "--lang=fr",
                "--device-scale-factor=1.25",
                "--num-raster-threads=4",
                "--enable-main-frame-before-activation",
                "--renderer-client-id=196",
                "--launch-time-ticks=17880973283",
                "--mojo-platform-channel-handle=2520",
                "--field-trial-handle=1808,i,7578868639254466484,17758186584081941877,131072",
                "--enable-features=ContextBridgeMutability,SharedArrayBuffer,WinUseBrowserSpellChecker,WinUseHybridSpellChecker",
                "--disable-features=CalculateNativeWinOcclusion,ExtraCookieValidityChecks,ForcedColors,SpareRendererForSitePerProcess,WinRetrieveSuggestionsOnlyOnDemand",
                "/prefetch:1"
            ],
            "hash": {
                "sha256": "2024533463df3c945a74c774858285915ffb4e083031b51b8135bbbf5e8fc5ee",
                "sha1": "68d25b5f5a57cf5dc0d63644338c04ea906d472b",
                "md5": "89b717809a5a49d19e7e06746982bf0b"
            },
            "entity_id": "{abcdef01-2345-6789-abcd-000000000000}",
            "command_line": "\"C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe\" --type=renderer --enable-wer --user-data-dir=\"C:\\Users\\asmithee\\AppData\\Roaming\\Microsoft\\Teams\" --ms-teams-less-cors=522133263 --app-user-model-id=com.squirrel.Teams.Teams --app-path=\"C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\resources\\app.test\" --autoplay-policy=no-user-gesture-required --disable-background-timer-throttling --lang=fr --device-scale-factor=1.25 --num-raster-threads=4 --enable-main-frame-before-activation --renderer-client-id=196 --launch-time-ticks=17880973283 --mojo-platform-channel-handle=2520 --field-trial-handle=1808,i,7578868639254466484,17758186584081941877,131072 --enable-features=ContextBridgeMutability,SharedArrayBuffer,WinUseBrowserSpellChecker,WinUseHybridSpellChecker --disable-features=CalculateNativeWinOcclusion,ExtraCookieValidityChecks,ForcedColors,SpareRendererForSitePerProcess,WinRetrieveSuggestionsOnlyOnDemand /prefetch:1",
            "pe": {
                "description": "Microsoft Teams",
                "company": "Microsoft Corporation",
                "file_version": "1.6.00.27573",
                "imphash": "00590c8fdc1f372f8db1d3f49d342d34",
                "original_file_name": "Teams.exe",
                "product": "Microsoft Teams"
            },
            "parent": {
                "name": "Teams.exe",
                "args": [
                    "C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe",
                    "--system-initiated"
                ],
                "entity_id": "{abcdef01-2345-6789-abcd-000000000000}",
                "command_line": "\"C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe\" --system-initiated",
                "pid": 17772,
                "executable": "C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe"
            },
            "pid": 27804,
            "working_directory": "C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\",
            "executable": "C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe"
        },
        "user": {
            "name": "asmithee",
            "id": "S-1-2-3",
            "domain": "COMPANY"
        },
        "winlog": {
            "task": "Process Create (rule: ProcessCreate)",
            "channel": "Microsoft-Windows-Sysmon/Operational",
            "user": {
                "name": "Syst\u00e8me",
                "identifier": "S-1-2-3",
                "type": "User",
                "domain": "DOMAIN"
            },
            "api": "wineventlog",
            "provider_guid": "{a0b1c2d3-1234-abcd-e4f5-0123456789ab}",
            "process": {
                "thread": {
                    "id": 7248
                },
                "pid": 5624
            },
            "event_id": "1",
            "version": 5,
            "computer_name": "PC01234567.company.com",
            "record_id": "67177799",
            "opcode": "Informations",
            "provider_name": "Microsoft-Windows-Sysmon"
        },
        "related": {
            "hash": [
                "2024533463df3c945a74c774858285915ffb4e083031b51b8135bbbf5e8fc5ee",
                "3a94cc250153d9666fad8106848c0359d8b887d6",
                "68d25b5f5a57cf5dc0d63644338c04ea906d472b",
                "89b717809a5a49d19e7e06746982bf0b"
            ],
            "ip": [
                "0.0.0.0",
                "1.2.3.4",
                "10.20.30.40",
                "1122::3344:5566:7788:9900",
                "11::2233:4455:6677:8899",
                "40.30.20.10",
                "5.6.7.8",
                "8.8.8.8",
                "a0b1::c2d3:e4f5:123:abcd",
                "a123::b234:c345:d456:e567",
                "aabb::ccdd:eeff:11:2233",
                "abcd::ef01:2345:6789:abcd"
            ],
            "hosts": [
                "PC01234567"
            ],
            "user": [
                "asmithee"
            ]
        }
    }
    	
	```


=== "event_registry_1.json"

    ```json
	
    {
        "message": "{\n  \"winlog\": {\n    \"event_data\": {\n      \"TargetObject\": \"target\\\\System\\\\CurrentControlSet\\\\Services\\\\bam\\\\State\\\\UserSettings\\\\S-1-2-3-4-012345678-123456789-876543210-12345\\\\\\\\Device\\\\HarddiskVolume3\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\",\n      \"Details\": \"Binary Data\",\n      \"User\": \"COMPANY\\\\asmithee\",\n      \"EventType\": \"SetValue\"\n    },\n    \"task\": \"Registry value set (rule: RegistryEvent)\",\n    \"channel\": \"Microsoft-Windows-Sysmon/Operational\",\n    \"api\": \"wineventlog\",\n    \"user\": {\n      \"name\": \"Syst\u00e8me\",\n      \"identifier\": \"S-1-2-3\",\n      \"type\": \"User\",\n      \"domain\": \"DOMAIN\"\n    },\n    \"event_id\": \"13\",\n    \"process\": {\n      \"thread\": {\n        \"id\": 7248\n      },\n      \"pid\": 5624\n    },\n    \"provider_guid\": \"{a0b1c2d3-1234-abcd-e4f5-0123456789ab}\",\n    \"version\": 2,\n    \"computer_name\": \"PC01234567.company.com\",\n    \"record_id\": 67193809,\n    \"provider_name\": \"Microsoft-Windows-Sysmon\",\n    \"opcode\": \"Informations\"\n  },\n  \"message\": \"Registry value set:\\nRuleName: technique_id=T1543,technique_name=Service Creation\\nEventType: SetValue\\nUtcTime: 2023-10-17 14:01:17.244\\nProcessGuid: {abcdef01-2345-6789-abcd-000000000000}\\nProcessId: 17772\\nImage: C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\\nTargetObject: target\\\\System\\\\CurrentControlSet\\\\Services\\\\bam\\\\State\\\\UserSettings\\\\S-1-2-3-4-012345678-123456789-876543210-12345\\\\\\\\Device\\\\HarddiskVolume3\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\\nDetails: Binary Data\\nUser: COMPANY\\\\asmithee\",\n  \"event_ingest_logstash\": \"2023-10-17T14:01:18.423152Z\",\n  \"fields.gdp-logstash\": \"6\",\n  \"event\": {\n    \"created\": \"2023-10-17T14:01:17.717Z\",\n    \"kind\": \"event\",\n    \"category\": [\n      \"configuration\",\n      \"registry\"\n    ],\n    \"provider\": \"Microsoft-Windows-Sysmon\",\n    \"action\": \"Registry value set (rule: RegistryEvent)\",\n    \"module\": \"sysmon\",\n    \"code\": \"13\",\n    \"type\": [\n      \"change\"\n    ]\n  },\n  \"process\": {\n    \"name\": \"Teams.exe\",\n    \"pid\": 17772,\n    \"entity_id\": \"{abcdef01-2345-6789-abcd-000000000000}\",\n    \"executable\": \"C:\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\"\n  },\n  \"@version\": \"1\",\n  \"log\": {\n    \"level\": \"information\"\n  },\n  \"rule\": {\n    \"name\": \"technique_id=T1543,technique_name=Service Creation\"\n  },\n  \"ecs\": {\n    \"version\": \"1.12.0\"\n  },\n  \"@timestamp\": \"2023-10-17T14:01:17.244Z\",\n  \"fields\": {\n    \"gdp-version-sysmon\": 13.33,\n    \"gdp-version-winlogbeat\": 2.8,\n    \"gdp-indice\": \"l-desk\",\n    \"gdp-sousparc\": \"prod\",\n    \"gdp-version\": \"1.16\",\n    \"gdp-config\": \"desktop\",\n    \"gdp-parc\": \"defaut\"\n  },\n  \"host\": {\n    \"name\": \"PC01234567.company.com\",\n    \"mac\": [\n      \"00:11:22:33:44:55\",\n      \"aa:bb:cc:dd:ee:ff\",\n      \"a0:b1:c2:d3:e4:f5\",\n      \"66:77:88:99:00:11\",\n      \"01:23:45:67:89:ab\",\n      \"ab:cd:ef:01:23:45\"\n    ],\n    \"os\": {\n      \"name\": \"Windows 10 Enterprise\",\n      \"platform\": \"windows\",\n      \"version\": \"10.0\",\n      \"kernel\": \"10.0.19041.3570 (WinBuild.160101.0800)\",\n      \"build\": \"19044.3570\",\n      \"type\": \"windows\",\n      \"family\": \"windows\"\n    },\n    \"id\": \"a0b1c2d3-0123-abcd-0a1b-abcd0123ef45\",\n    \"hostname\": \"PC01234567\",\n    \"architecture\": \"x86_64\",\n    \"ip\": [\n      \"a123::b234:c345:d456:e567\",\n      \"8.8.8.8\",\n      \"abcd::ef01:2345:6789:abcd\",\n      \"1.2.3.4\",\n      \"a0b1::c2d3:e4f5:0123:abcd\",\n      \"10.20.30.40\",\n      \"aabb::ccdd:eeff:0011:2233\",\n      \"0.0.0.0\",\n      \"1122::3344:5566:7788:9900\",\n      \"5.6.7.8\",\n      \"0011::2233:4455:6677:8899\",\n      \"40.30.20.10\"\n    ]\n  },\n  \"registry\": {\n    \"key\": \"System\\\\CurrentControlSet\\\\Services\\\\bam\\\\State\\\\UserSettings\\\\S-1-2-3-4-012345678-123456789-876543210-12345\\\\\\\\Device\\\\HarddiskVolume3\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\",\n    \"path\": \"target\\\\System\\\\CurrentControlSet\\\\Services\\\\bam\\\\State\\\\UserSettings\\\\S-1-2-3-4-012345678-123456789-876543210-12345\\\\\\\\Device\\\\HarddiskVolume3\\\\Users\\\\asmithee\\\\AppData\\\\Local\\\\Microsoft\\\\Teams\\\\current\\\\Teams.exe\",\n    \"hive\": \"target\",\n    \"value\": \"Teams.exe\"\n  },\n  \"tags\": [\n    \"beats_input_codec_plain_applied\"\n  ],\n  \"agent\": {\n    \"id\": \"001234567-abcd-ef01-2345-6789abcdef01\",\n    \"name\": \"WB-DK-PC01234567\",\n    \"version\": \"7.17.1\",\n    \"ephemeral_id\": \"a0b1c2d3-0123-4567-abcd-e4f5a6b7c8d9\",\n    \"hostname\": \"PC01234567\",\n    \"type\": \"winlogbeat\"\n  }\n}",
        "event": {
            "action": "Registry value set (rule: RegistryEvent)",
            "category": [
                "configuration",
                "registry"
            ],
            "code": "13",
            "kind": "event",
            "module": "sysmon",
            "provider": "Microsoft-Windows-Sysmon",
            "type": [
                "change"
            ],
            "original": "Registry value set:\nRuleName: technique_id=T1543,technique_name=Service Creation\nEventType: SetValue\nUtcTime: 2023-10-17 14:01:17.244\nProcessGuid: {abcdef01-2345-6789-abcd-000000000000}\nProcessId: 17772\nImage: C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe\nTargetObject: target\\System\\CurrentControlSet\\Services\\bam\\State\\UserSettings\\S-1-2-3-4-012345678-123456789-876543210-12345\\\\Device\\HarddiskVolume3\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe\nDetails: Binary Data\nUser: COMPANY\\asmithee",
            "hash": "dbfbea81bd233292dc651cb11a98ffab227443e4"
        },
        "@timestamp": "2023-10-17T14:01:17.244000Z",
        "action": {
            "properties": {
                "TargetObject": "target\\System\\CurrentControlSet\\Services\\bam\\State\\UserSettings\\S-1-2-3-4-012345678-123456789-876543210-12345\\\\Device\\HarddiskVolume3\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe",
                "Details": "Binary Data",
                "User": "COMPANY\\asmithee",
                "EventType": "SetValue"
            },
            "id": 13
        },
        "agent": {
            "id": "001234567-abcd-ef01-2345-6789abcdef01",
            "name": "WB-DK-PC01234567",
            "version": "7.17.1",
            "ephemeral_id": "a0b1c2d3-0123-4567-abcd-e4f5a6b7c8d9",
            "type": "winlogbeat"
        },
        "host": {
            "name": "PC01234567.company.com",
            "mac": [
                "00:11:22:33:44:55",
                "aa:bb:cc:dd:ee:ff",
                "a0:b1:c2:d3:e4:f5",
                "66:77:88:99:00:11",
                "01:23:45:67:89:ab",
                "ab:cd:ef:01:23:45"
            ],
            "os": {
                "name": "Windows 10 Enterprise",
                "platform": "windows",
                "version": "10.0",
                "kernel": "10.0.19041.3570 (WinBuild.160101.0800)",
                "build": "19044.3570",
                "type": "windows",
                "family": "windows"
            },
            "id": "a0b1c2d3-0123-abcd-0a1b-abcd0123ef45",
            "hostname": "PC01234567",
            "architecture": "x86_64",
            "ip": [
                "a123::b234:c345:d456:e567",
                "8.8.8.8",
                "abcd::ef01:2345:6789:abcd",
                "1.2.3.4",
                "a0b1::c2d3:e4f5:123:abcd",
                "10.20.30.40",
                "aabb::ccdd:eeff:11:2233",
                "0.0.0.0",
                "1122::3344:5566:7788:9900",
                "5.6.7.8",
                "11::2233:4455:6677:8899",
                "40.30.20.10"
            ]
        },
        "log": {
            "level": "information"
        },
        "process": {
            "name": "Teams.exe",
            "pid": 17772,
            "entity_id": "{abcdef01-2345-6789-abcd-000000000000}",
            "executable": "C:\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe"
        },
        "registry": {
            "key": "target\\System\\CurrentControlSet\\Services\\bam\\State\\UserSettings\\S-1-2-3-4-012345678-123456789-876543210-12345\\\\Device\\HarddiskVolume3\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current",
            "path": "target\\System\\CurrentControlSet\\Services\\bam\\State\\UserSettings\\S-1-2-3-4-012345678-123456789-876543210-12345\\\\Device\\HarddiskVolume3\\Users\\asmithee\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe",
            "hive": "target",
            "value": "Teams.exe",
            "data": {
                "strings": "Binary Data"
            }
        },
        "winlog": {
            "task": "Registry value set (rule: RegistryEvent)",
            "channel": "Microsoft-Windows-Sysmon/Operational",
            "api": "wineventlog",
            "user": {
                "name": "Syst\u00e8me",
                "identifier": "S-1-2-3",
                "type": "User",
                "domain": "DOMAIN"
            },
            "event_id": "13",
            "process": {
                "thread": {
                    "id": 7248
                },
                "pid": 5624
            },
            "provider_guid": "{a0b1c2d3-1234-abcd-e4f5-0123456789ab}",
            "version": 2,
            "computer_name": "PC01234567.company.com",
            "record_id": "67193809",
            "provider_name": "Microsoft-Windows-Sysmon",
            "opcode": "Informations"
        },
        "related": {
            "hash": [
                "dbfbea81bd233292dc651cb11a98ffab227443e4"
            ],
            "ip": [
                "0.0.0.0",
                "1.2.3.4",
                "10.20.30.40",
                "1122::3344:5566:7788:9900",
                "11::2233:4455:6677:8899",
                "40.30.20.10",
                "5.6.7.8",
                "8.8.8.8",
                "a0b1::c2d3:e4f5:123:abcd",
                "a123::b234:c345:d456:e567",
                "aabb::ccdd:eeff:11:2233",
                "abcd::ef01:2345:6789:abcd"
            ],
            "hosts": [
                "PC01234567"
            ]
        }
    }
    	
	```


=== "event_registry_2.json"

    ```json
	
    {
        "message": "{\n  \"winlog\": {\n    \"event_data\": {\n      \"Details\": \"WORD (0x00000000-0x12345678)\",\n      \"TargetObject\": \"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows Advanced Threat Protection\\\\TelLib\\\\LastSuccessfulUploadTime\",\n      \"User\": \"DOMAIN\\\\Syst\u00e8me\",\n      \"EventType\": \"SetValue\"\n    },\n    \"task\": \"Registry value set (rule: RegistryEvent)\",\n    \"channel\": \"Microsoft-Windows-Sysmon/Operational\",\n    \"api\": \"wineventlog\",\n    \"user\": {\n      \"name\": \"Syst\u00e8me\",\n      \"identifier\": \"S-1-2-3\",\n      \"type\": \"User\",\n      \"domain\": \"DOMAIN\"\n    },\n    \"provider_guid\": \"{a0b1c2d3-1234-abcd-e4f5-0123456789ab}\",\n    \"process\": {\n      \"thread\": {\n        \"id\": 7248\n      },\n      \"pid\": 5624\n    },\n    \"event_id\": \"13\",\n    \"version\": 2,\n    \"computer_name\": \"PC01234567.company.com\",\n    \"record_id\": 67193778,\n    \"opcode\": \"Informations\",\n    \"provider_name\": \"Microsoft-Windows-Sysmon\"\n  },\n  \"message\": \"Registry value set:\\nRuleName: technique_id=T1089,technique_name=Disabling Security Tools\\nEventType: SetValue\\nUtcTime: 2023-10-17 14:00:56.524\\nProcessGuid: {abcdef01-2345-6789-abcd-000000000000}\\nProcessId: 5500\\nImage: C:\\\\Program Files\\\\Windows Defender Advanced Threat Protection\\\\MsSense.exe\\nTargetObject: HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows Advanced Threat Protection\\\\TelLib\\\\LastSuccessfulUploadTime\\nDetails: WORD (0x00000000-0x12345678)\\nUser: DOMAIN\\\\Syst\u00e8me\",\n  \"event_ingest_logstash\": \"2023-10-17T14:00:59.207219Z\",\n  \"fields.gdp-logstash\": \"6\",\n  \"event\": {\n    \"provider\": \"Microsoft-Windows-Sysmon\",\n    \"created\": \"2023-10-17T14:00:58.520Z\",\n    \"category\": [\n      \"configuration\",\n      \"registry\"\n    ],\n    \"kind\": \"event\",\n    \"action\": \"Registry value set (rule: RegistryEvent)\",\n    \"module\": \"sysmon\",\n    \"code\": \"13\",\n    \"type\": [\n      \"change\"\n    ]\n  },\n  \"process\": {\n    \"name\": \"MsSense.exe\",\n    \"pid\": 5500,\n    \"entity_id\": \"{abcdef01-2345-6789-abcd-000000000000}\",\n    \"executable\": \"C:\\\\Program Files\\\\Windows Defender Advanced Threat Protection\\\\MsSense.exe\"\n  },\n  \"@version\": \"1\",\n  \"log\": {\n    \"level\": \"information\"\n  },\n  \"rule\": {\n    \"name\": \"technique_id=T1089,technique_name=Disabling Security Tools\"\n  },\n  \"ecs\": {\n    \"version\": \"1.12.0\"\n  },\n  \"@timestamp\": \"2023-10-17T14:00:56.524Z\",\n  \"fields\": {\n    \"gdp-parc\": \"defaut\",\n    \"gdp-version-winlogbeat\": 2.8,\n    \"gdp-indice\": \"l-desk\",\n    \"gdp-sousparc\": \"prod\",\n    \"gdp-config\": \"desktop\",\n    \"gdp-version\": \"1.16\",\n    \"gdp-version-sysmon\": 13.33\n  },\n  \"host\": {\n    \"os\": {\n      \"platform\": \"windows\",\n      \"name\": \"Windows 10 Enterprise\",\n      \"version\": \"10.0\",\n      \"kernel\": \"10.0.19041.3570 (WinBuild.160101.0800)\",\n      \"build\": \"19044.3570\",\n      \"type\": \"windows\",\n      \"family\": \"windows\"\n    },\n    \"name\": \"PC01234567.company.com\",\n    \"id\": \"a0b1c2d3-0123-abcd-0a1b-abcd0123ef45\",\n    \"mac\": [\n      \"00:11:22:33:44:55\",\n      \"aa:bb:cc:dd:ee:ff\",\n      \"a0:b1:c2:d3:e4:f5\",\n      \"66:77:88:99:00:11\",\n      \"01:23:45:67:89:ab\",\n      \"ab:cd:ef:01:23:45\"\n    ],\n    \"hostname\": \"PC01234567\",\n    \"architecture\": \"x86_64\",\n    \"ip\": [\n      \"a123::b234:c345:d456:e567\",\n      \"8.8.8.8\",\n      \"abcd::ef01:2345:6789:abcd\",\n      \"1.2.3.4\",\n      \"a0b1::c2d3:e4f5:0123:abcd\",\n      \"10.20.30.40\",\n      \"aabb::ccdd:eeff:0011:2233\",\n      \"0.0.0.0\",\n      \"1122::3344:5566:7788:9900\",\n      \"5.6.7.8\",\n      \"0011::2233:4455:6677:8899\",\n      \"40.30.20.10\"\n    ]\n  },\n  \"registry\": {\n    \"key\": \"SOFTWARE\\\\Microsoft\\\\Windows Advanced Threat Protection\\\\TelLib\\\\LastSuccessfulUploadTime\",\n    \"path\": \"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows Advanced Threat Protection\\\\TelLib\\\\LastSuccessfulUploadTime\",\n    \"hive\": \"HKLM\",\n    \"value\": \"LastSuccessfulUploadTime\"\n  },\n  \"tags\": [\n    \"beats_input_codec_plain_applied\"\n  ],\n  \"agent\": {\n    \"id\": \"001234567-abcd-ef01-2345-6789abcdef01\",\n    \"name\": \"WB-DK-PC01234567\",\n    \"version\": \"7.17.1\",\n    \"ephemeral_id\": \"a0b1c2d3-0123-4567-abcd-e4f5a6b7c8d9\",\n    \"hostname\": \"PC01234567\",\n    \"type\": \"winlogbeat\"\n  }\n}",
        "event": {
            "action": "Registry value set (rule: RegistryEvent)",
            "category": [
                "configuration",
                "registry"
            ],
            "code": "13",
            "kind": "event",
            "module": "sysmon",
            "provider": "Microsoft-Windows-Sysmon",
            "type": [
                "change"
            ],
            "original": "Registry value set:\nRuleName: technique_id=T1089,technique_name=Disabling Security Tools\nEventType: SetValue\nUtcTime: 2023-10-17 14:00:56.524\nProcessGuid: {abcdef01-2345-6789-abcd-000000000000}\nProcessId: 5500\nImage: C:\\Program Files\\Windows Defender Advanced Threat Protection\\MsSense.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Windows Advanced Threat Protection\\TelLib\\LastSuccessfulUploadTime\nDetails: WORD (0x00000000-0x12345678)\nUser: DOMAIN\\Syst\u00e8me",
            "hash": "25c902e0f7f27e2a1a6d74c675b97c7fde0a4dda"
        },
        "@timestamp": "2023-10-17T14:00:56.524000Z",
        "action": {
            "properties": {
                "Details": "WORD (0x00000000-0x12345678)",
                "TargetObject": "HKLM\\SOFTWARE\\Microsoft\\Windows Advanced Threat Protection\\TelLib\\LastSuccessfulUploadTime",
                "User": "DOMAIN\\Syst\u00e8me",
                "EventType": "SetValue"
            },
            "id": 13
        },
        "agent": {
            "id": "001234567-abcd-ef01-2345-6789abcdef01",
            "name": "WB-DK-PC01234567",
            "version": "7.17.1",
            "ephemeral_id": "a0b1c2d3-0123-4567-abcd-e4f5a6b7c8d9",
            "type": "winlogbeat"
        },
        "host": {
            "os": {
                "platform": "windows",
                "name": "Windows 10 Enterprise",
                "version": "10.0",
                "kernel": "10.0.19041.3570 (WinBuild.160101.0800)",
                "build": "19044.3570",
                "type": "windows",
                "family": "windows"
            },
            "name": "PC01234567.company.com",
            "id": "a0b1c2d3-0123-abcd-0a1b-abcd0123ef45",
            "mac": [
                "00:11:22:33:44:55",
                "aa:bb:cc:dd:ee:ff",
                "a0:b1:c2:d3:e4:f5",
                "66:77:88:99:00:11",
                "01:23:45:67:89:ab",
                "ab:cd:ef:01:23:45"
            ],
            "hostname": "PC01234567",
            "architecture": "x86_64",
            "ip": [
                "a123::b234:c345:d456:e567",
                "8.8.8.8",
                "abcd::ef01:2345:6789:abcd",
                "1.2.3.4",
                "a0b1::c2d3:e4f5:123:abcd",
                "10.20.30.40",
                "aabb::ccdd:eeff:11:2233",
                "0.0.0.0",
                "1122::3344:5566:7788:9900",
                "5.6.7.8",
                "11::2233:4455:6677:8899",
                "40.30.20.10"
            ]
        },
        "log": {
            "level": "information"
        },
        "process": {
            "name": "MsSense.exe",
            "pid": 5500,
            "entity_id": "{abcdef01-2345-6789-abcd-000000000000}",
            "executable": "C:\\Program Files\\Windows Defender Advanced Threat Protection\\MsSense.exe"
        },
        "registry": {
            "key": "HKLM\\SOFTWARE\\Microsoft\\Windows Advanced Threat Protection\\TelLib",
            "path": "HKLM\\SOFTWARE\\Microsoft\\Windows Advanced Threat Protection\\TelLib\\LastSuccessfulUploadTime",
            "hive": "HKLM",
            "value": "LastSuccessfulUploadTime",
            "data": {
                "strings": "WORD (0x00000000-0x12345678)"
            }
        },
        "winlog": {
            "task": "Registry value set (rule: RegistryEvent)",
            "channel": "Microsoft-Windows-Sysmon/Operational",
            "api": "wineventlog",
            "user": {
                "name": "Syst\u00e8me",
                "identifier": "S-1-2-3",
                "type": "User",
                "domain": "DOMAIN"
            },
            "provider_guid": "{a0b1c2d3-1234-abcd-e4f5-0123456789ab}",
            "process": {
                "thread": {
                    "id": 7248
                },
                "pid": 5624
            },
            "event_id": "13",
            "version": 2,
            "computer_name": "PC01234567.company.com",
            "record_id": "67193778",
            "opcode": "Informations",
            "provider_name": "Microsoft-Windows-Sysmon"
        },
        "related": {
            "hash": [
                "25c902e0f7f27e2a1a6d74c675b97c7fde0a4dda"
            ],
            "ip": [
                "0.0.0.0",
                "1.2.3.4",
                "10.20.30.40",
                "1122::3344:5566:7788:9900",
                "11::2233:4455:6677:8899",
                "40.30.20.10",
                "5.6.7.8",
                "8.8.8.8",
                "a0b1::c2d3:e4f5:123:abcd",
                "a123::b234:c345:d456:e567",
                "aabb::ccdd:eeff:11:2233",
                "abcd::ef01:2345:6789:abcd"
            ],
            "hosts": [
                "PC01234567"
            ]
        }
    }
    	
	```


=== "test_filtering.json"

    ```json
	
    {
        "message": "{\"@timestamp\":\"2023-01-31T18:02:52.597Z\",\"@version\":\"1\",\"agent\":{\"ephemeral_id\":\"379a53ae-f8df-4fb9-9968-382db61f6dda\",\"hostname\":\"vm204d\",\"id\":\"9ecce8bd-f6ab-41ac-9936-14f8c2c81242\",\"type\":\"winlogbeat\",\"version\":\"7.0.0\"},\"ecs\":{\"version\":\"1.0.0\"},\"event\":{\"action\":\"Filtering Platform Connection\",\"code\":5156,\"created\":\"2023-01-31T18:02:53.233Z\",\"kind\":\"event\"},\"host\":{\"architecture\":\"x86_64\",\"hostname\":\"vm204d\",\"id\":\"68884df7-2cc9-4c09-a619-e1ccce85ac4e\",\"name\":\"vm204d\",\"os\":{\"build\":\"20348.1487\",\"family\":\"windows\",\"kernel\":\"10.0.20348.1487 (WinBuild.160101.0800)\",\"name\":\"Windows Server 2022 Datacenter\",\"platform\":\"windows\",\"version\":\"10.0\"}},\"log\":{\"level\":\"information\"},\"message\":\"The Windows Filtering Platform has permitted a connection.\\n\\nApplication Information:\\n\\tProcess ID:\\t\\t4\\n\\tApplication Name:\\tSystem\\n\\nNetwork Information:\\n\\tDirection:\\t\\tInbound\\n\\tSource Address:\\t\\t192.168.83.100\\n\\tSource Port:\\t\\t58499\\n\\tDestination Address:\\t192.168.240.196\\n\\tDestination Port:\\t\\t445\\n\\tProtocol:\\t\\t6\\n\\tInterface Index:\\t\\t9\\n\\nFilter Information:\\n\\tFilter Origin:\\t\\tUnknown\\n\\tFilter Run-Time ID:\\t71694\\n\\tLayer Name:\\t\\tReceive/Accept\\n\\tLayer Run-Time ID:\\t44\\n\\tRemote User ID:\\t\\tS-1-0-0\\n\\tRemote Machine ID:\\tS-1-0-0\",\"tags\":[\"beats_input_codec_plain_applied\"],\"type\":\"winlogbeat\",\"winlog\":{\"api\":\"wineventlog\",\"channel\":\"Security\",\"computer_name\":\"vm204d.example.org\",\"event_data\":{\"Application\":\"System\",\"DestAddress\":\"5.6.7.8\",\"DestPort\":\"445\",\"Direction\":\"%%14592\",\"FilterOrigin\":\"Unknown\",\"FilterRTID\":\"71694\",\"InterfaceIndex\":\"9\",\"LayerName\":\"%%14610\",\"LayerRTID\":\"44\",\"ProcessID\":\"4\",\"Protocol\":\"6\",\"RemoteMachineID\":\"S-1-0-0\",\"RemoteUserID\":\"S-1-0-0\",\"SourceAddress\":\"1.2.3.4\",\"SourcePort\":\"58499\"},\"event_id\":5156,\"keywords\":[\"Audit Success\"],\"opcode\":\"Info\",\"process\":{\"pid\":4,\"thread\":{\"id\":1940}},\"provider_guid\":\"{54849625-5478-4994-a5ba-3e3b0328c30d}\",\"provider_name\":\"Microsoft-Windows-Security-Auditing\",\"record_id\":614833249,\"task\":\"Filtering Platform Connection\",\"version\":1}}\n",
        "event": {
            "action": "Filtering Platform Connection",
            "code": "5156",
            "kind": "event",
            "original": "The Windows Filtering Platform has permitted a connection.\n\nApplication Information:\n\tProcess ID:\t\t4\n\tApplication Name:\tSystem\n\nNetwork Information:\n\tDirection:\t\tInbound\n\tSource Address:\t\t192.168.83.100\n\tSource Port:\t\t58499\n\tDestination Address:\t192.168.240.196\n\tDestination Port:\t\t445\n\tProtocol:\t\t6\n\tInterface Index:\t\t9\n\nFilter Information:\n\tFilter Origin:\t\tUnknown\n\tFilter Run-Time ID:\t71694\n\tLayer Name:\t\tReceive/Accept\n\tLayer Run-Time ID:\t44\n\tRemote User ID:\t\tS-1-0-0\n\tRemote Machine ID:\tS-1-0-0",
            "hash": "ab796c9b97ae44dbe45db2b945d2c773175b2e08"
        },
        "@timestamp": "2023-01-31T18:02:52.597000Z",
        "action": {
            "properties": {
                "Application": "System",
                "DestAddress": "5.6.7.8",
                "DestPort": "445",
                "Direction": "%%14592",
                "FilterOrigin": "Unknown",
                "FilterRTID": "71694",
                "InterfaceIndex": "9",
                "LayerName": "%%14610",
                "LayerRTID": "44",
                "ProcessID": "4",
                "Protocol": "6",
                "RemoteMachineID": "S-1-0-0",
                "RemoteUserID": "S-1-0-0",
                "SourceAddress": "1.2.3.4",
                "SourcePort": "58499"
            },
            "id": 5156
        },
        "agent": {
            "ephemeral_id": "379a53ae-f8df-4fb9-9968-382db61f6dda",
            "id": "9ecce8bd-f6ab-41ac-9936-14f8c2c81242",
            "type": "winlogbeat",
            "version": "7.0.0"
        },
        "host": {
            "architecture": "x86_64",
            "hostname": "vm204d",
            "id": "68884df7-2cc9-4c09-a619-e1ccce85ac4e",
            "name": "vm204d",
            "os": {
                "build": "20348.1487",
                "family": "windows",
                "kernel": "10.0.20348.1487 (WinBuild.160101.0800)",
                "name": "Windows Server 2022 Datacenter",
                "platform": "windows",
                "version": "10.0"
            }
        },
        "log": {
            "level": "information"
        },
        "winlog": {
            "api": "wineventlog",
            "channel": "Security",
            "computer_name": "vm204d.example.org",
            "event_id": "5156",
            "keywords": [
                "Audit Success"
            ],
            "opcode": "Info",
            "process": {
                "pid": 4,
                "thread": {
                    "id": 1940
                }
            },
            "provider_guid": "{54849625-5478-4994-a5ba-3e3b0328c30d}",
            "provider_name": "Microsoft-Windows-Security-Auditing",
            "record_id": "614833249",
            "task": "Filtering Platform Connection",
            "version": 1
        },
        "related": {
            "hash": [
                "ab796c9b97ae44dbe45db2b945d2c773175b2e08"
            ],
            "hosts": [
                "vm204d"
            ]
        }
    }
    	
	```


=== "test_logon.json"

    ```json
	
    {
        "message": "{\"@timestamp\":\"2023-01-31T18:02:50.013Z\",\"@version\":\"1\",\"agent\":{\"ephemeral_id\":\"f1b3df69-328e-4e41-be73-bec093727c32\",\"hostname\":\"vm-exc-msg-3\",\"id\":\"d47011da-0be2-4021-8336-e418c1eb2c3b\",\"type\":\"winlogbeat\",\"version\":\"7.0.0\"},\"ecs\":{\"version\":\"1.0.0\"},\"event\":{\"action\":\"Special Logon\",\"code\":4672,\"created\":\"2023-01-31T18:02:50.783Z\",\"kind\":\"event\"},\"host\":{\"architecture\":\"x86_64\",\"hostname\":\"vm-exc-msg-3\",\"id\":\"010a5b7c-d244-42f9-a547-bd544c30d518\",\"name\":\"vm-exc-msg-3\",\"os\":{\"build\":\"14393.5648\",\"family\":\"windows\",\"kernel\":\"10.0.14393.5648 (rs1_release.230105-1654)\",\"name\":\"Windows Server 2016 Datacenter\",\"platform\":\"windows\",\"version\":\"10.0\"}},\"log\":{\"level\":\"information\"},\"message\":\"Special privileges assigned to new logon.\\n\\nSubject:\\n\\tSecurity ID:\\t\\tS-1-5-21-776561741-920026266-725345543-17198\\n\\tAccount Name:\\t\\tVM-EXC-MSG-4$\\n\\tAccount Domain:\\t\\tEXAMPLE\\n\\tLogon ID:\\t\\t0xC5D72273\\n\\nPrivileges:\\t\\tSeSecurityPrivilege\\n\\t\\t\\tSeBackupPrivilege\\n\\t\\t\\tSeRestorePrivilege\\n\\t\\t\\tSeTakeOwnershipPrivilege\\n\\t\\t\\tSeDebugPrivilege\\n\\t\\t\\tSeSystemEnvironmentPrivilege\\n\\t\\t\\tSeLoadDriverPrivilege\\n\\t\\t\\tSeImpersonatePrivilege\\n\\t\\t\\tSeDelegateSessionUserImpersonatePrivilege\",\"tags\":[\"beats_input_codec_plain_applied\"],\"type\":\"winlogbeat\",\"winlog\":{\"activity_id\":\"{9F4E14C8-2C13-0004-4326-4E9F132CD901}\",\"api\":\"wineventlog\",\"channel\":\"Security\",\"computer_name\":\"vm-exc-msg-3.example.org\",\"event_data\":{\"PrivilegeList\":\"SeSecurityPrivilege\\n\\t\\t\\tSeBackupPrivilege\\n\\t\\t\\tSeRestorePrivilege\\n\\t\\t\\tSeTakeOwnershipPrivilege\\n\\t\\t\\tSeDebugPrivilege\\n\\t\\t\\tSeSystemEnvironmentPrivilege\\n\\t\\t\\tSeLoadDriverPrivilege\\n\\t\\t\\tSeImpersonatePrivilege\\n\\t\\t\\tSeDelegateSessionUserImpersonatePrivilege\",\"SubjectDomainName\":\"EXAMPLE\",\"SubjectLogonId\":\"0xc5d72273\",\"SubjectUserName\":\"VM-EXC-MSG-4$\",\"SubjectUserSid\":\"S-1-5-21-776561741-920026266-725345543-17198\"},\"event_id\":4672,\"keywords\":[\"Audit Success\"],\"opcode\":\"Info\",\"process\":{\"pid\":856,\"thread\":{\"id\":1784}},\"provider_guid\":\"{54849625-5478-4994-A5BA-3E3B0328C30D}\",\"provider_name\":\"Microsoft-Windows-Security-Auditing\",\"record_id\":1842784185,\"task\":\"Special Logon\"}}\n",
        "event": {
            "action": "Special Logon",
            "code": "4672",
            "kind": "event",
            "original": "Special privileges assigned to new logon.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-776561741-920026266-725345543-17198\n\tAccount Name:\t\tVM-EXC-MSG-4$\n\tAccount Domain:\t\tEXAMPLE\n\tLogon ID:\t\t0xC5D72273\n\nPrivileges:\t\tSeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege\n\t\t\tSeDelegateSessionUserImpersonatePrivilege",
            "hash": "b6bb91718122b7f68c88dccd13cbb6a0eec95599"
        },
        "@timestamp": "2023-01-31T18:02:50.013000Z",
        "action": {
            "properties": {
                "PrivilegeList": "SeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege\n\t\t\tSeDelegateSessionUserImpersonatePrivilege",
                "SubjectDomainName": "EXAMPLE",
                "SubjectLogonId": "0xc5d72273",
                "SubjectUserName": "VM-EXC-MSG-4$",
                "SubjectUserSid": "S-1-5-21-776561741-920026266-725345543-17198"
            },
            "id": 4672
        },
        "agent": {
            "ephemeral_id": "f1b3df69-328e-4e41-be73-bec093727c32",
            "id": "d47011da-0be2-4021-8336-e418c1eb2c3b",
            "type": "winlogbeat",
            "version": "7.0.0"
        },
        "host": {
            "architecture": "x86_64",
            "hostname": "vm-exc-msg-3",
            "id": "010a5b7c-d244-42f9-a547-bd544c30d518",
            "name": "vm-exc-msg-3",
            "os": {
                "build": "14393.5648",
                "family": "windows",
                "kernel": "10.0.14393.5648 (rs1_release.230105-1654)",
                "name": "Windows Server 2016 Datacenter",
                "platform": "windows",
                "version": "10.0"
            }
        },
        "log": {
            "level": "information"
        },
        "winlog": {
            "activity_id": "{9f4e14c8-2c13-0004-4326-4e9f132cd901}",
            "api": "wineventlog",
            "channel": "Security",
            "computer_name": "vm-exc-msg-3.example.org",
            "event_id": "4672",
            "keywords": [
                "Audit Success"
            ],
            "opcode": "Info",
            "process": {
                "pid": 856,
                "thread": {
                    "id": 1784
                }
            },
            "provider_guid": "{54849625-5478-4994-a5ba-3e3b0328c30d}",
            "provider_name": "Microsoft-Windows-Security-Auditing",
            "record_id": "1842784185",
            "task": "Special Logon"
        },
        "related": {
            "hash": [
                "b6bb91718122b7f68c88dccd13cbb6a0eec95599"
            ],
            "hosts": [
                "vm-exc-msg-3"
            ]
        }
    }
    	
	```





## Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`action.properties` | `object` | The event-specific data. This field is mutually exclusive with `user_data`. If you are capturing event data on versions prior to Windows Vista, the parameters in `event_data` are named `param1`, `param2`, and so on, because event log parameters are unnamed in earlier versions of Windows. |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.code` | `keyword` | Identification code for this event. |
|`event.kind` | `keyword` | The kind of the event. The highest categorization field in the hierarchy. |
|`event.module` | `keyword` | Name of the module this data is coming from. |
|`event.original` | `keyword` | Raw text message of entire event. |
|`event.provider` | `keyword` | Source of the event. |
|`event.reason` | `keyword` | Reason why this event happened, according to the source |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`file.directory` | `keyword` | Directory where the file is located. |
|`file.drive_letter` | `keyword` | Drive letter where the file is located. |
|`file.extension` | `keyword` | File extension, excluding the leading dot. |
|`file.name` | `keyword` | Name of the file including the extension, without the directory. |
|`file.path` | `keyword` | Full path to the file, including the file name. |
|`process.command_line` | `wildcard` | Full command line that started the process. |
|`process.executable` | `keyword` | Absolute path to the process executable. |
|`process.hash.md5` | `keyword` | MD5 hash. |
|`process.hash.sha1` | `keyword` | SHA1 hash. |
|`process.hash.sha256` | `keyword` | SHA256 hash. |
|`process.hash.sha384` | `keyword` | SHA384 hash. |
|`process.hash.sha512` | `keyword` | SHA512 hash. |
|`process.hash.ssdeep` | `keyword` | SSDEEP hash. |
|`process.hash.tlsh` | `keyword` | TLSH hash. |
|`process.name` | `keyword` | Process name. |
|`process.parent.executable` | `keyword` | Absolute path to the process executable. |
|`process.parent.name` | `keyword` | Process name. |
|`process.pe.original_file_name` | `keyword` | Internal name of the file, provided at compile-time. |
|`process.working_directory` | `keyword` | The working directory of the process. |
|`registry.data.strings` | `wildcard` | List of strings representing what was written to the registry. |
|`registry.hive` | `keyword` | Abbreviated name for the hive. |
|`registry.key` | `keyword` | Hive-relative path of keys. |
|`registry.path` | `keyword` | Full path, including hive, key and value |
|`registry.value` | `keyword` | Name of the value written. |
|`user.target.domain` | `keyword` | Name of the directory the user is a member of. |
|`user.target.name` | `keyword` | Short name or login of the user. |
|`winlog.activity_id` | `keyword` | A globally unique identifier that identifies the current activity. The events that are published with this identifier are part of the same activity. |
|`winlog.provider_guid` | `keyword` | A globally unique identifier that identifies the provider that logged the event. |

