uuid: caa13404-9243-493b-943e-9848cadb1f99
name: Office 365
type: intake

## Overview

Office 365 is a line of subscription services offered by Microsoft as part of the Microsoft Office product line.

{!_shared_content/operations_center/integrations/generated/o365_do_not_edit_manually.md!}


## Office365 logs

Microsoft Office 365 API logs four categories of logs:

- Audit.AzureActiveDirectory
- Audit.Exchange
- Audit.SharePoint
- Audit.General


## Configure

### Prerequisites

You will need the following prerequisites to create an intake:

- access to the SEKOIA.IO XDR Operations Center 
- be a Microsoft Office 365 Administrator to consent to the interconnection

and to generate logs:

- For some advanced logs, an Azure Premium P1 or Azure Premium P2 license may be required.
- Configure the Microsoft Office 365 logging in [SEKOIA.IO XDR](https://app.sekoia.io/operations/intakes/new)
![SEKOIA.IO Operations Center O365 intake](/assets/operation_center/integration_catalog/cloud_and_saas/o365/tenant_o365.png){: style="max-width:60%"}

### Collect events

Sekoia has developed an automatical setup for collecting Microsoft Office 365 logs from its dedicated API.
This setup is based on [OAuth2.0](https://oauth.net/2/) as described in this [Microsoft documentation](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow#first-case-access-token-request-with-a-shared-secret).

During the setup, SEKOIA.IO will ask the following permissions against Microsoft to access your tenant:

- `User.Read` and `offline_access`, from the Microsoft Graph API, to read your tenant uuid
- `ActivityFeed.Read`, from the Office365 Management API, to activate feed subscription in order to collect events.

In order to exploit the automatic interconnection method, please follow these steps:

- Log to the Operations Center
- Go to Configure > Intakes, and click on `+ INTAKE`
- Choose Office 365 intake by clicking on `CREATE`
- Enter the Intake name and the related Enity, then click on `Automatically`
![SEKOIA.IO Operations Center O365 intake](/assets/operation_center/integration_catalog/cloud_and_saas/o365/intake_creation_o365.png){: style="max-width:60%"}
- Click on `LOG IN TO OFFICE 365`, then `ADD PERMISSION INTO OFFICE 365`
![SEKOIA.IO Operations Center O365 intake](/assets/operation_center/integration_catalog/cloud_and_saas/o365/intake_creation_o365_access.png){: style="max-width:60%"}
- Choose your Office account

### Enjoy your events

You can go to the [events page](https://app.sekoia.io/operations/events) to watch your incoming events.

### Alternative mode

For any reason, you are unable or you don't want to collect Office 365 through the management API,
you can forward events to SEKOIA.IO, through Azure EventHub, with [this guide](o365_appendix.md)

## Further Readings
- [Office365 Management API](https://docs.microsoft.com/en-us/office/office-365-management-api/)
